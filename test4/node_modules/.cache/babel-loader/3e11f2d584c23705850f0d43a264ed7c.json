{"ast":null,"code":"import _slicedToArray from\"/Users/arlosb/Documents/GitHub/new react app/test3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import CallObjectContext from'../../CallObjectContext';import'./InputSelector.css';export default React.forwardRef(function(props,ref){var callObject=useContext(CallObjectContext);var audioInputSelect=React.createRef();var videoSelect=React.createRef();var type=props.type;var page=props.page;var handleClick=function handleClick(e){if(!e.target.value){return;}var selectionID=e.target.value;type=='audio'&&page=='main'&&e.target.key.includes('audioinput')&&callObject.setInputDevicesAsync({audioSource:selectionID});// type == 'audio' && page=='main' && e.target.key.includes('audiooutput') && callObject.setOutputDevice({selectionID});\ntype=='video'&&page=='main'&&callObject.setInputDevicesAsync({videoSource:selectionID});if(type=='audio'&&page=='intro'){var _props$inputs=_slicedToArray(props.inputs,2),initialInputs=_props$inputs[0],setInitialInputs=_props$inputs[1];var constraints={deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({audio:constraints}).then(function(mediaStream){var newAudioSource=mediaStream.getAudioTracks()[0];setInitialInputs(function(prev){return[newAudioSource,prev[1]];});});}if(type=='video'&&page=='intro'){var _props$inputs2=_slicedToArray(props.inputs,2),_initialInputs=_props$inputs2[0],_setInitialInputs=_props$inputs2[1];var _constraints={width:1280,height:720,deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({video:_constraints}).then(function(mediaStream){var newVideoSource=mediaStream.getVideoTracks()[0];_setInitialInputs(function(prev){return[prev[0],newVideoSource];});});}e.target.key.includes('input')&&console.log('New input: '+e.target.text);// e.target.key.includes('output') && console.log('New output: ' + e.target.text);\n};useEffect(function(){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){navigator.mediaDevices.enumerateDevices().then(function(deviceInfos){if(type=='audio'&&audioInputSelect.current){if(audioInputSelect.current.hasChildNodes()){return;}var audioInputs=[];var audioOutputs=[];for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='audioinput'){option.key='audioinput'+audioInputSelect.length+1;option.text=deviceInfo.label||'Microphone '+(audioInputSelect.length+1);audioInputs.push(option);}// else if (deviceInfo.kind === 'audiooutput') {\n//     option.key = 'audiooutput' + audioInputSelect.length + 1;\n//     option.text = deviceInfo.label || 'Speaker ' +(audioInputSelect.length + 1);\n//     audioOutputs.push(option);\n//     }   \n}window.audioOutputs=audioOutputs;var micHeading=document.createElement('option');micHeading.label='-Select Microphone-';micHeading.className='item-heading';var speakerHeading=document.createElement('option');// speakerHeading.label = '-Select Speaker-';\n// speakerHeading.className='item-heading';\naudioInputSelect.current.appendChild(micHeading);for(var i=0;i!==audioInputs.length;++i){audioInputSelect.current.appendChild(audioInputs[i]);}// audioInputSelect.current.appendChild(speakerHeading);\n// for (var i=0; i!==audioOutputs.length; ++i) {\n//     console.log(audioOutputs[i]);\n//     audioInputSelect.current.appendChild(audioOutputs[i]);\n// }\n}else if(type=='video'&&videoSelect.current){if(videoSelect.current.hasChildNodes()){return;}var camHeading=document.createElement('option');camHeading.label='-Select Camera-';camHeading.className='item-heading';videoSelect.current.appendChild(camHeading);for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='videoinput'){option.key='videooutput'+videoSelect.length+1;option.text=deviceInfo.label||'Camera '+(videoSelect.length+1);videoSelect.current&&videoSelect.current.appendChild(option);}}}}).catch(function(err){console.log(err.name+\": \"+err.message);});}});return/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-selector\",ref:ref},type=='audio'&&/*#__PURE__*/React.createElement(\"ul\",{ref:audioInputSelect,onClick:handleClick}),type=='video'&&/*#__PURE__*/React.createElement(\"ul\",{ref:videoSelect,onClick:handleClick}));});","map":{"version":3,"sources":["/Users/arlosb/Documents/GitHub/new react app/test3/src/components/InputSelector/InputSelector.js"],"names":["React","useContext","useEffect","useState","CallObjectContext","forwardRef","props","ref","callObject","audioInputSelect","createRef","videoSelect","type","page","handleClick","e","target","value","selectionID","key","includes","setInputDevicesAsync","audioSource","videoSource","inputs","initialInputs","setInitialInputs","constraints","deviceId","exact","navigator","mediaDevices","getUserMedia","audio","then","mediaStream","newAudioSource","getAudioTracks","prev","width","height","video","newVideoSource","getVideoTracks","console","log","text","enumerateDevices","deviceInfos","current","hasChildNodes","audioInputs","audioOutputs","i","length","deviceInfo","option","document","createElement","className","kind","label","push","window","micHeading","speakerHeading","appendChild","camHeading","catch","err","name","message"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport './InputSelector.css';\n\n\nexport default React.forwardRef((props, ref)=> {\nconst callObject = useContext(CallObjectContext);\nconst audioInputSelect = React.createRef();\nconst videoSelect = React.createRef();\nconst type = props.type;\nconst page = props.page;\n\n\nconst handleClick=(e) => {\n    if(!e.target.value) {return;}\n    let selectionID = e.target.value;\n    type == 'audio' && page=='main' && e.target.key.includes('audioinput') && callObject.setInputDevicesAsync({audioSource: selectionID});\n    // type == 'audio' && page=='main' && e.target.key.includes('audiooutput') && callObject.setOutputDevice({selectionID});\n    type == 'video' && page=='main' && callObject.setInputDevicesAsync({videoSource: selectionID});\n    if (type == 'audio' && page=='intro') {\n        const [initialInputs,setInitialInputs] = props.inputs;\n        let constraints = {\n            deviceId: { exact: selectionID }\n        };\n        navigator.mediaDevices.getUserMedia({audio: constraints}).then(\n            (mediaStream)=> {\n            let newAudioSource = mediaStream.getAudioTracks()[0];\n            setInitialInputs((prev)=>[newAudioSource,prev[1]]);\n            });\n    }\n    if (type == 'video' && page=='intro') {\n        const [initialInputs,setInitialInputs] = props.inputs;\n        let constraints = {\n            width: 1280,\n            height: 720,\n            deviceId: { \n                exact: selectionID ,\n            },\n        };\n        navigator.mediaDevices.getUserMedia({video: constraints}).then(\n            (mediaStream)=> {\n            let newVideoSource = mediaStream.getVideoTracks()[0];\n            setInitialInputs((prev)=>[prev[0],newVideoSource])\n            });\n    }   \n    e.target.key.includes('input') && console.log('New input: ' + e.target.text);\n    // e.target.key.includes('output') && console.log('New output: ' + e.target.text);\n}\n\nuseEffect(()=>{ \n    if(navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n        navigator.mediaDevices.enumerateDevices()\n        .then(function(deviceInfos) {\n            \n            if (type=='audio' && audioInputSelect.current) {\n                if (audioInputSelect.current.hasChildNodes()) {return}\n                let audioInputs = [];\n                let audioOutputs = [];\n\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                if (deviceInfo.kind === 'audioinput') {\n                    option.key = 'audioinput' + audioInputSelect.length + 1;\n                    option.text = deviceInfo.label ||'Microphone ' + (audioInputSelect.length + 1);\n                    audioInputs.push(option); \n                } \n                // else if (deviceInfo.kind === 'audiooutput') {\n                //     option.key = 'audiooutput' + audioInputSelect.length + 1;\n                //     option.text = deviceInfo.label || 'Speaker ' +(audioInputSelect.length + 1);\n                //     audioOutputs.push(option);\n                //     }   \n                }\n                window.audioOutputs=audioOutputs;\n                let micHeading = document.createElement('option');\n                micHeading.label = '-Select Microphone-';\n                micHeading.className='item-heading';\n                let speakerHeading = document.createElement('option');\n                // speakerHeading.label = '-Select Speaker-';\n                // speakerHeading.className='item-heading';\n                audioInputSelect.current.appendChild(micHeading);\n                for (var i=0; i!==audioInputs.length; ++i) {\n                    audioInputSelect.current.appendChild(audioInputs[i]);\n                }\n\n                // audioInputSelect.current.appendChild(speakerHeading);\n                // for (var i=0; i!==audioOutputs.length; ++i) {\n                //     console.log(audioOutputs[i]);\n                //     audioInputSelect.current.appendChild(audioOutputs[i]);\n                // }\n               \n                \n                   \n            }\n            else if (type == 'video' && videoSelect.current) {\n                if (videoSelect.current.hasChildNodes()) {return}\n                let camHeading = document.createElement('option');\n                camHeading.label = '-Select Camera-';\n                camHeading.className='item-heading';\n                videoSelect.current.appendChild(camHeading);\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                    if (deviceInfo.kind === 'videoinput') {\n                        option.key = 'videooutput' + videoSelect.length + 1;\n                        option.text = deviceInfo.label || 'Camera ' +(videoSelect.length + 1);\n                        videoSelect.current && videoSelect.current.appendChild(option);\n                    }\n                }\n            }\n        })\n        .catch(function(err) {\n          console.log(err.name + \": \" + err.message);\n        });\n       } \n})\n   \n    \n\n\n\n    return (\n        <div className=\"dropdown-selector\" ref={ref}>\n                {type=='audio' &&\n                <ul ref={audioInputSelect} onClick={handleClick}>\n                </ul>\n                }\n                {type=='video' &&\n                <ul ref={videoSelect} onClick={handleClick}>\n                </ul>\n                }\n                \n        </div>\n    );\n\n})\n"]},"metadata":{},"sourceType":"module"}