{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import CallObjectContext from'../../CallObjectContext';import'./InputSelector.css';export default React.forwardRef(function(props,ref){var callObject=useContext(CallObjectContext);var audioInputSelect=React.createRef();var videoSelect=React.createRef();var type=props.type;var page=props.page;var setInitialInputs=props.effect;var handleClick=function handleClick(e){if(!e.target.value){return;}var selectionID=e.target.value;type=='audio'&&page=='main'&&callObject.setInputDevicesAsync({audioSource:selectionID});type=='video'&&page=='main'&&callObject.setInputDevicesAsync({videoSource:selectionID});if(type=='audio'&&page=='intro'){var constraints={deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({audio:constraints}).then(function(mediaStream){var newAudioSource=mediaStream.getAudioTracks()[0];setInitialInputs(function(prev){return[newAudioSource,prev[1]];});});}if(type=='video'&&page=='intro'){var _constraints={deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({video:_constraints}).then(function(mediaStream){var newVideoSource=mediaStream.getVideoTracks()[0];setInitialInputs(function(prev){return[prev[0],newVideoSource];});});}console.log('New input: '+e.target.text);};useEffect(function(){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){navigator.mediaDevices.enumerateDevices().then(function(deviceInfos){if(type=='audio'&&audioInputSelect.current){if(audioInputSelect.current.hasChildNodes()){return;}var audioInputs=[];var audioOutputs=[];for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='audioinput'){option.text=deviceInfo.label||'Microphone '+(audioInputSelect.length+1);audioInputs.push(option);}else if(deviceInfo.kind==='audiooutput'){option.text=deviceInfo.label||'Speaker '+(audioInputSelect.length+1);audioOutputs.push(option);}}window.audioOutputs=audioOutputs;var micHeading=document.createElement('option');micHeading.label='-Select Microphone-';micHeading.className='item-heading';var speakerHeading=document.createElement('option');speakerHeading.label='-Select Speaker-';speakerHeading.className='item-heading';audioInputSelect.current.appendChild(micHeading);for(var i=0;i!==audioInputs.length;++i){audioInputSelect.current.appendChild(audioInputs[i]);}audioInputSelect.current.appendChild(speakerHeading);for(var i=0;i!==audioOutputs.length;++i){console.log(audioOutputs[i]);audioInputSelect.current.appendChild(audioOutputs[i]);}}else if(type=='video'&&videoSelect.current){if(videoSelect.current.hasChildNodes()){return;}var camHeading=document.createElement('option');camHeading.label='-Select Camera-';camHeading.className='item-heading';videoSelect.current.appendChild(camHeading);for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='videoinput'){option.text=deviceInfo.label||'Camera '+(videoSelect.length+1);videoSelect.current&&videoSelect.current.appendChild(option);}}}}).catch(function(err){console.log(err.name+\": \"+err.message);});}});return/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-selector\",ref:ref},type=='audio'&&/*#__PURE__*/React.createElement(\"ul\",{ref:audioInputSelect,onClick:handleClick}),type=='video'&&/*#__PURE__*/React.createElement(\"ul\",{ref:videoSelect,onClick:handleClick}));});","map":{"version":3,"sources":["/Users/arlosb/Documents/GitHub/new react app/test2/src/components/InputSelector/InputSelector.js"],"names":["React","useContext","useEffect","useState","CallObjectContext","forwardRef","props","ref","callObject","audioInputSelect","createRef","videoSelect","type","page","setInitialInputs","effect","handleClick","e","target","value","selectionID","setInputDevicesAsync","audioSource","videoSource","constraints","deviceId","exact","navigator","mediaDevices","getUserMedia","audio","then","mediaStream","newAudioSource","getAudioTracks","prev","video","newVideoSource","getVideoTracks","console","log","text","enumerateDevices","deviceInfos","current","hasChildNodes","audioInputs","audioOutputs","i","length","deviceInfo","option","document","createElement","className","kind","label","push","window","micHeading","speakerHeading","appendChild","camHeading","catch","err","name","message"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport './InputSelector.css';\n\n\nexport default React.forwardRef((props, ref)=> {\nconst callObject = useContext(CallObjectContext);\nconst audioInputSelect = React.createRef();\nconst videoSelect = React.createRef();\nconst type = props.type;\nconst page = props.page;\nconst setInitialInputs = props.effect;\n\nconst handleClick=(e) => {\n    if(!e.target.value) {return;}\n    let selectionID = e.target.value;\n    type == 'audio' && page=='main' && callObject.setInputDevicesAsync({audioSource: selectionID});\n    type == 'video' && page=='main' && callObject.setInputDevicesAsync({videoSource: selectionID});\n    if (type == 'audio' && page=='intro') {\n        let constraints = {\n            deviceId: { exact: selectionID }\n        };\n        navigator.mediaDevices.getUserMedia({audio: constraints}).then(\n            (mediaStream)=> {\n            let newAudioSource = mediaStream.getAudioTracks()[0];\n            setInitialInputs((prev)=>[newAudioSource,prev[1]])\n            });\n    }\n    if (type == 'video' && page=='intro') {\n        let constraints = {\n            deviceId: { exact: selectionID }\n        };\n        navigator.mediaDevices.getUserMedia({video: constraints}).then(\n            (mediaStream)=> {\n            let newVideoSource = mediaStream.getVideoTracks()[0];\n            setInitialInputs((prev)=>[prev[0],newVideoSource])\n            });\n    }\n    \n    console.log('New input: ' + e.target.text)\n}\n\nuseEffect(()=>{ \n    if(navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n        navigator.mediaDevices.enumerateDevices()\n        .then(function(deviceInfos) {\n            \n            if (type=='audio' && audioInputSelect.current) {\n                if (audioInputSelect.current.hasChildNodes()) {return}\n                let audioInputs = [];\n                let audioOutputs = [];\n\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                if (deviceInfo.kind === 'audioinput') {\n                    option.text = deviceInfo.label ||'Microphone ' + (audioInputSelect.length + 1);\n                    audioInputs.push(option); \n                } else if (deviceInfo.kind === 'audiooutput') {\n                    option.text = deviceInfo.label || 'Speaker ' +(audioInputSelect.length + 1);\n                    audioOutputs.push(option);\n                    }   \n                }\n                window.audioOutputs=audioOutputs;\n                let micHeading = document.createElement('option');\n                micHeading.label = '-Select Microphone-';\n                micHeading.className='item-heading';\n                let speakerHeading = document.createElement('option');\n                speakerHeading.label = '-Select Speaker-';\n                speakerHeading.className='item-heading';\n                audioInputSelect.current.appendChild(micHeading);\n                for (var i=0; i!==audioInputs.length; ++i) {\n                    audioInputSelect.current.appendChild(audioInputs[i]);\n                }\n                audioInputSelect.current.appendChild(speakerHeading);\n                for (var i=0; i!==audioOutputs.length; ++i) {\n                    console.log(audioOutputs[i]);\n                    audioInputSelect.current.appendChild(audioOutputs[i]);\n                }\n               \n                \n                   \n            }\n            else if (type == 'video' && videoSelect.current) {\n                if (videoSelect.current.hasChildNodes()) {return}\n                let camHeading = document.createElement('option');\n                camHeading.label = '-Select Camera-';\n                camHeading.className='item-heading';\n                videoSelect.current.appendChild(camHeading);\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                    if (deviceInfo.kind === 'videoinput') {\n                        option.text = deviceInfo.label || 'Camera ' +(videoSelect.length + 1);\n                        videoSelect.current && videoSelect.current.appendChild(option);\n                    }\n                }\n            }\n        })\n        .catch(function(err) {\n          console.log(err.name + \": \" + err.message);\n        });\n       } \n})\n   \n    \n\n\n\n    return (\n        <div className=\"dropdown-selector\" ref={ref}>\n                {type=='audio' &&\n                <ul ref={audioInputSelect} onClick={handleClick}>\n                </ul>\n                }\n                {type=='video' &&\n                <ul ref={videoSelect} onClick={handleClick}>\n                </ul>\n                }\n                \n        </div>\n    );\n\n})\n"]},"metadata":{},"sourceType":"module"}