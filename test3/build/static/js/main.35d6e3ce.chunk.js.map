{"version":3,"sources":["components/Tile/Tile.js","CallObjectContext.js","MyContext.js","components/CallMessage/CallMessage.js","components/Call/callState.js","logUtils.js","hooks/setSubscriptions.js","components/Call/Call.js","components/InputSelector/InputSelector.js","components/StartScreen/StartScreen.js","api.js","components/Icon/Icon.js","components/TrayButton/TrayButton.js","components/Chat/Chat.js","components/Tray/Tray.js","SessionStateContext.js","urlUtils.js","hooks/AudioPlayer.js","components/RoleSelector/RoleSelector.js","components/AdminPanel/AdminPanel.js","components/App/App.js","components/AdminPanel/AdminFunctions.js","components/BrowserUnsupported/BrowserUnsupported.js","index.js"],"names":["getTrackUnavailableMessage","kind","trackState","state","blocked","byPermissions","byDeviceMissing","off","byUser","byBandwidth","Tile","props","videoEl","useRef","audioEl","forceUpdate","useState","setValue","value","useForceUpdate","window","updateTile","videoTrack","useMemo","videoTrackState","isLocalPerson","subscribed","track","audioTrack","audioTrackState","isAudioOnly","isFiltered","isScreenShare","videoUnavailableMessage","audioUnavailableMessage","useEffect","current","srcObject","MediaStream","console","log","stream","mutedAudio","Audio","muted","paused","play","audioCtx","AudioContext","webkitAudioContext","audioSourceNode","createMediaStreamSource","destination","createMediaStreamDestination","gainNode","createGain","panNode","createStereoPanner","gain","pan","connect","sessionState","className","classNames","isLarge","getClassNames","onClick","style","display","autoPlay","playsInline","ref","disableCornerMessage","React","createContext","CallMessage","isError","header","detail","initialCallState","callItems","local","clickAllowTimeoutFired","camOrMicError","fatalError","callReducer","callState","action","type","participants","Object","entries","id","participant","tracks","video","audio","shouldIncludeScreenCallItem","screenVideo","screenAudio","getCallItems","message","Error","trackStatesForInclusion","includes","isLocal","endsWith","containsScreenShare","keys","some","logDailyEvent","e","setSubscriptions","callObject","viewMode","myRole","currentSubs","isActive","roleOf","Shadow1","push","Seller","Buyer2","Buyer3","Buyer1","AdminVisible","filter","str","indexOf","myName","Shadow2","Shadow3","Shadow4","setTracks","then","index","splice","iterator","values","elements","length","updateCall","updateTray","Promise","resolve","ps","forEach","p","thisUserName","user_name","isKnown","updateParticipant","session_id","setSubscribedTracks","Call","useContext","CallObjectContext","useReducer","dispatch","myState","MyContext","events","handleNewParticipantsState","event","on","getUserName","setInterval","adminPresent","userList","thisSessionId","sort","updateAdminPanel","getUserList","clearInterval","updateUserList","handleCameraErrorEvent","errorMsg","handleErrorEvent","t","setTimeout","clearTimeout","numberOfSubs","largeTiles","smallTiles","callItem","tile","key","getTiles","smallTales","add","n","i","addFakeParticipant","localCallItem","isLoading","shouldShowClickAllow","getMessage","amAdmin","forwardRef","audioInputSelect","createRef","videoSelect","page","handleClick","target","selectionID","setInputDevicesAsync","audioSource","videoSource","inputs","setInitialInputs","constraints","deviceId","exact","navigator","mediaDevices","getUserMedia","mediaStream","newAudioSource","getAudioTracks","prev","width","height","newVideoSource","getVideoTracks","text","enumerateDevices","deviceInfos","hasChildNodes","audioInputs","deviceInfo","option","document","createElement","label","audioOutputs","micHeading","appendChild","camHeading","catch","err","name","StartScreen","my","setMy","userIDEl","showMicSettings","setShowMicSettings","showCamSettings","setShowCamSettings","begin","lobbyVideo","micCaret","micSettings","camCaret","camSettings","initialInputs","hasUserMedia","setHasUserMedia","addEventListener","handleClickOutside","testMy","removeEventListener","contains","localAudio","localVideo","position","marginLeft","marginRight","padding","paddingTop","border","backgroundColor","background","opacity","zIndex","borderRadius","margin","color","fontWeight","boxSizing","cursor","location","reload","href","flexDirection","justifyContent","bottom","left","overflowY","onSubmit","preventDefault","autoComplete","fontSize","textAlign","fontFamily","onFocus","prevState","onChange","newName","handleChange","alert","a","url","createRoom","Icon","getFillColor","highlighted","viewBox","xmlns","stroke","strokeWidth","fill","fillRule","transform","d","getPath","TrayButton","disabled","newButtonGroup","Chat","inputValue","setInputValue","chatHistory","setChatHistory","handleAppMessage","split","join","data","sender","notification","onClickDisplay","map","entry","sendAppMessage","htmlFor","placeholder","Tray","isCameraMuted","setCameraMuted","isMicMuted","setMicMuted","isSharingScreen","setSharingScreen","displayChat","setChatDisplay","highlightedChat","setChatHighlight","localParticipant","screen","getStreamStates","camDisabled","setLocalVideo","micDisabled","setLocalAudio","DailyIframe","supportedBrowser","supportsScreenShare","open","host","match","setViewMode","selected","onClickLeaveCall","pageUrlFromRoomUrl","roomUrl","encodeURIComponent","audioPlayer","trackName","command","src","monologue1","monologue2","monologue3","monologue4","monologue5","monologue6","dialogue1","dialogue1B","dialogue2","dialogue2B","dialogue3","dialogue3B","dialogue4","dialogue4B","dialogue5","dialogue5B","dialogue6","dialogue6B","createMediaElementSource","disconnect","RoleSelector","session","SessionStateContext","setSessionState","role","myNewRole","myNumber","user","AdminPanel","playButtonText","setPlayButtonText","targetRecording","setTargetRecording","training","trainingToggle","sendState","selectedRoles","class","checked","camWasOn","micWasOn","recipientA","recipientB","audioIsPlaying","instructionsA","recipient","instructionsB","classList","toggle","innerText","STATE_JOINING","STATE_JOINED","STATE_ERROR","App","appState","setAppState","setRoomUrl","setCallObject","adminStatus","setCamDisabled","setMicDisabled","pass","myP","createCall","useCallback","api","room","error","startJoiningCall","newCallObject","createCallObject","subscribeToTracksAutomatically","userName","startLeavingCall","destroy","initialize","leave","getState","stateRequest","search","decodeURIComponent","roomUrlFromPageUrl","pageUrl","history","replaceState","handleNewMeetingState","meetingState","setNetworkTopology","topology","lookForMoreParticipants","fromId","constructor","priorSessionState","needToSetSubs","activateSession","pauseSession","showCall","Provider","BrowserUnsupported","ReactDOM","render","supported","getElementById"],"mappings":"ogBAOA,SAASA,EAA2BC,EAAMC,GACxC,GAAKA,EACL,OAAQA,EAAWC,OACjB,IAAK,UACH,OAAID,EAAWE,QAAQC,cACf,GAAN,OAAUJ,EAAV,sBACSC,EAAWE,QAAQE,gBACtB,GAAN,OAAUL,EAAV,mBAEI,GAAN,OAAUA,EAAV,YACF,IAAK,MACH,OAAIC,EAAWK,IAAIC,OACX,GAAN,OAAUP,EAAV,UACSC,EAAWK,IAAIE,YAClB,GAAN,OAAUR,EAAV,4BAEI,GAAN,OAAUA,EAAV,QACF,IAAK,WACH,MAAM,GAAN,OAAUA,EAAV,mBACF,IAAK,UACH,MAAM,GAAN,OAAUA,EAAV,eACF,IAAK,cACH,MAAM,GAAN,OAAUA,EAAV,gBACF,IAAK,WACH,OAAO,MAeE,SAASS,EAAKC,GAC3B,IAAMC,EAAUC,iBAAO,MACjBC,EAAUD,iBAAO,MACjBE,EA/CR,WAA0B,IAAD,EACGC,mBAAS,GADZ,mBACTC,GADS,WAEvB,OAAO,kBAAMA,GAAS,SAAAC,GAAK,OAAIA,EAAQ,MA6CnBC,GAEpBC,OAAOC,WAAa,WAClBN,KAGF,IAAMO,EAAaC,mBAAQ,WACzB,OAAOZ,EAAMa,iBAAmD,aAAhCb,EAAMa,gBAAgBrB,QAAyBQ,EAAMc,gBAAsD,IAArCd,EAAMa,gBAAgBE,YACxHf,EAAMa,gBAAgBG,MACtB,OACH,CAAChB,EAAMa,kBAEJI,EAAaL,mBAAQ,WAEzB,OAAKZ,EAAMkB,iBAAoBlB,EAAMkB,gBAAgBF,OAAyC,aAAhChB,EAAMkB,gBAAgB1B,QAA6D,IAArCQ,EAAMkB,gBAAgBH,YAG9Hf,EAAMmB,YACRnB,EAAMkB,gBAAgBF,MAAMI,YAAW,EACjCpB,EAAMkB,gBAAgBF,MAAMI,YAAW,EAC3CpB,EAAMqB,cACRrB,EAAMkB,gBAAgBF,MAAMK,eAAc,EACpCrB,EAAMkB,gBAAgBF,MAAMK,eAAc,EAC3CrB,EAAMkB,gBAAgBF,OARjB,OASX,CAAChB,EAAMkB,kBAEJI,EAA0BV,mBAAQ,WACtC,OAAOvB,EAA2B,QAASW,EAAMa,mBAChD,CAACb,EAAMa,kBAEJU,EAA0BX,mBAAQ,WACtC,OAAOvB,EAA2B,QAASW,EAAMkB,mBAChD,CAAClB,EAAMkB,kBA0JV,OArJAM,qBAAU,WACRvB,EAAQwB,UACLxB,EAAQwB,QAAQC,UAAY,IAAIC,YAAY,CAAChB,OAC/C,CAACA,IAKJa,qBAAU,WACLrB,EAAQsB,UAONR,EAAWG,YACZQ,QAAQC,IAAI,4BAKVpB,OAAOqB,OAAQ,IAAIH,YAAY,CAACV,IAG1BR,OAAOsB,WAAatB,OAAOsB,YAAc,IAAIC,MAC7CvB,OAAOsB,WAAWE,OAAQ,EACtBxB,OAAOsB,WAAWL,YAAYjB,OAAOsB,WAAWL,UAAYjB,OAAOqB,QACvErB,OAAOsB,WAAWG,QAAUzB,OAAOsB,WAAWI,OAGpD1B,OAAO2B,SAAW3B,OAAO2B,UAAY,IAAK3B,OAAO4B,cAAgB5B,OAAO6B,oBACzE7B,OAAO8B,gBAAkB9B,OAAO2B,SAASI,wBAAwB/B,OAAOqB,QACvC,oBAArBrB,OAAOgC,cAA2BhC,OAAOgC,YAAchC,OAAO2B,SAASM,gCAGrD,oBAAlBjC,OAAOkC,WAAyBlC,OAAOkC,SAAWlC,OAAO2B,SAASQ,cAEjD,oBAAjBnC,OAAOoC,UAAwBpC,OAAOoC,QAAUpC,OAAO2B,SAASU,sBAOvErC,OAAOkC,SAASI,KAAKxC,MAAM,EAC3BE,OAAOoC,QAAQG,IAAIzC,MAAM,EAE3BE,OAAO8B,gBAAgBU,QAAQxC,OAAOkC,UAAUM,QAAQxC,OAAOoC,SAASI,QAAQxC,OAAOgC,aAGzFtC,EAAQsB,QAAQC,UAAYjB,OAAOgC,YAAYX,QAG3Cb,EAAWI,eAGjBO,QAAQC,IAAI,gCAMZ1B,EAAQsB,QAAQC,UAAY,IAAIC,YAAY,CAACV,MAM7CW,QAAQC,IAAI,mCAMZ1B,EAAQsB,QAAQC,UAAY,IAAIC,YAAY,CAACV,QAwBhD,CAACA,EAAWR,OAAOyC,eAoDpB,yBAAKC,UATP,WACE,IAAIC,EAAa,OAGjB,OAFAA,GAAcpD,EAAMqD,QAAU,SAAW,SACzCrD,EAAMc,gBAAkBsC,GAAc,UAC/BA,EAKSE,GAAiBC,QAASvD,EAAMuD,QAASC,MAAO,CAACC,QAAS9C,EAAa,QAAU,SAC/F,yBAAKwC,UAAU,eApCVxC,GACLW,GACE,uBAAG6B,UAAU,WACV7B,GAjBAX,GAAc,2BAAO+C,UAAQ,EAACzB,OAAK,EAAC0B,aAAW,EAACC,IAAK3D,IAqDzDU,IArBAX,EAAM6D,sBACPtC,IACCD,GACC,uBAAG6B,UAAU,UAAU5B,IA5BxBvB,EAAMc,eACPG,GAAc,2BAAOyC,UAAQ,EAACC,aAAW,EAACC,IAAKzD,GAAjC,MClML2D,UAAMC,gBCAND,MAAMC,gB,MCON,SAASC,EAAYhE,GAClC,OACE,yBAAKmD,UAAW,gBAAkBnD,EAAMiE,QAAU,SAAW,KAC3D,uBAAGd,UAAU,uBAAuBnD,EAAMkE,QAC1C,2BAAIlE,EAAMmE,S,WCHVC,EAAmB,CACvBC,UAAW,CACTC,MAAO,CACLzD,gBAAiB,KACjBK,gBAAiB,OAGrBqD,wBAAwB,EACxBC,cAAe,KACfC,WAAY,MAkCd,SAASC,EAAYC,EAAWC,GAC9B,OAAQA,EAAOC,MACb,IA3BwB,sBA4BtB,OAAO,2BACFF,GADL,IAEEJ,wBAAwB,IAE5B,IAzBwB,sBA0BtB,IAAMF,EAkBZ,SAAsBS,GAEpB,IADA,IAAIT,EAAS,eAAQD,EAAiBC,WACtC,MAAgCU,OAAOC,QAAQF,GAA/C,eAA8D,CAAC,IAAD,sBAAlDG,EAAkD,KAA9CC,EAA8C,KAG1Db,EAAUY,GAAM,CACdpE,gBAAiBqE,EAAYC,OAAOC,MACpClE,gBAAiBgE,EAAYC,OAAOE,OAIpCC,EAA4BJ,KAC9Bb,EAAUY,EAAK,WAAa,CAC1BpE,gBAAiBqE,EAAYC,OAAOI,YACpCrE,gBAAiBgE,EAAYC,OAAOK,cAI1C,OAAOnB,EApCeoB,CAAab,EAAOE,cACtC,OAAO,2BACFH,GADL,IAEEN,cAEJ,IAxBqB,mBAyBnB,OAAO,2BAAKM,GAAZ,IAAuBH,cAAeI,EAAOc,UAC/C,IAnBgB,cAoBd,OAAO,2BAAKf,GAAZ,IAAuBF,WAAYG,EAAOc,UAC5C,QACE,MAAM,IAAIC,OA6BhB,SAASL,EAA4BJ,GACnC,IAAMU,EAA0B,CAAC,UAAW,WAAY,eACxD,OACEA,EAAwBC,SAASX,EAAYC,OAAOI,YAAY/F,QAChEoG,EAAwBC,SAASX,EAAYC,OAAOK,YAAYhG,OAOpE,SAASsG,EAAQb,GACf,MAAc,UAAPA,EAGT,SAAS5D,EAAc4D,GACrB,OAAOA,EAAGc,SAAS,WAGrB,SAASC,EAAoB3B,GAC3B,OAAOU,OAAOkB,KAAK5B,GAAW6B,MAAK,SAACjB,GAAD,OAAQ5D,EAAc4D,MCxHpD,SAASkB,EAAcC,GAC5BxE,QAAQC,IAAI,mBAAoBuE,EAAExB,QCErB,SAASyB,EAAiBC,GAA2B,IAAhBC,EAAe,uDAAN,KAEzD,GAAK9F,OAAOyC,aAAZ,CAEAtB,QAAQC,IAAI,4BACZD,QAAQC,IAAI,mBAAqBpB,OAAO+F,QACxC5E,QAAQC,IAAI,gBAAkB0E,GAM1B,GAJJ9F,OAAOgG,YAAY,GACnBhG,OAAO8F,SAAWA,GAGTA,GAAY9F,OAAOyC,aAAawD,SAAU,CAC3C,OAAQjG,OAAO+F,QACX,IAAK,SACD/F,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOC,UACxFnG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,QAC/HrG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,SACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOC,UACxFnG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,QAC/HrG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,SACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOC,UACxFnG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,QAC/HrG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxF,MACJ,IAAK,SACDtG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxFvG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,OAAO,UAC/F,MACJ,IAAK,WAGL,QACIrG,OAAOgG,YAAY,GAIvBhG,OAAOyC,aAAagE,cACxBzG,OAAOgG,YAAYI,KAAM,SAG7BpG,OAAOgG,YAAYU,QAAO,SAAUC,GAAM,OAAuC,IAAhCA,EAAIC,QAAQ5G,OAAO6G,WAIxE,GAAGf,EAAU,CAET,OAAQA,GACJ,IAAK,SACD9F,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,QACxFrG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,UACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOC,SACzFnG,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,UACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOY,SAAW9G,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOY,SACzF9G,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,UACDvG,OAAOyC,aAAayD,OAAOa,SAAW/G,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOa,SACzF/G,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,UACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOc,SAAWhH,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOc,SACzFhH,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,IAAK,MACDvG,OAAOgG,YAAY,GACnBhG,OAAOyC,aAAayD,OAAOG,QAAUrG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOG,QACxFrG,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOC,SACzFnG,OAAOyC,aAAayD,OAAOY,SAAW9G,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOY,SACzF9G,OAAOyC,aAAayD,OAAOa,SAAW/G,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOa,SACzF/G,OAAOyC,aAAayD,OAAOc,SAAWhH,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOc,SACzFhH,OAAOyC,aAAayD,OAAOM,QAAUxG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOM,QACxFxG,OAAOyC,aAAayD,OAAOI,QAAUtG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOI,QACxFtG,OAAOyC,aAAayD,OAAOK,QAAUvG,OAAOgG,YAAYI,KAAKpG,OAAOyC,aAAayD,OAAOK,QACxF,MACJ,QACIvG,OAAOgG,YAAY,GAI3BhG,OAAOgG,YAAYU,QAAO,SAAUC,GAAM,OAAuC,IAAhCA,EAAIC,QAAQ5G,OAAO6G,WAgHxEI,IAAYC,MAAK,WAGb,IAAMC,EAAQnH,OAAOgG,YAAYY,QAAQ,cACrCO,GAAS,GACXnH,OAAOgG,YAAYoB,OAAOD,EAAO,GAIvCnH,OAAOgG,YAAYU,QAAO,SAAUC,GAAM,OAAuC,IAAhCA,EAAIC,QAAQ5G,OAAO6G,WAEpE,IAAIQ,EAAWrH,OAAOgG,YAAYsB,SAClCnG,QAAQC,IAAI,4BAZS,oBAaAiG,GAbA,IAarB,2BAA+B,CAAC,IAAvBE,EAAsB,QAC3BpG,QAAQC,IAAImG,IAdK,8BAgBjBvH,OAAOgG,YAAYwB,OAAS,GAC5BrG,QAAQC,IAAK,WAEjBpB,OAAOyH,aACP3B,EAAS,KACT9F,OAAO0H,aACP1H,OAAOC,gBAlIP,SAASgH,IAEL,OAAO,IAAIU,SAAS,SAACC,GAGjB,IAAIC,EAAKhC,EAAWxB,eAEpBC,OAAOkB,KAAKqC,GAAIC,SAAQ,SAACC,GACrB,IAAItD,EAAcoD,EAAGE,GACjBC,EAAevD,EAAYwD,UAErB,UAANF,GAAiBC,GAAchI,OAAO6G,SAOrC7G,OAAOyC,aAAayF,SAOzB/G,QAAQC,IAAI,qBAAsB4G,GAE7BhI,OAAOyC,aAAawD,UAAaH,GA6D7B9F,OAAOyC,aAAawD,UAAYH,KAClC9F,OAAOgG,YAAYZ,SAAS4C,EAAa,WACxC7G,QAAQC,IAAI,kCAAoC4G,GAChDnC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,oBAAsB,CAAEzD,OAAO,EAAMD,OAAO,EAAOG,aAAa,MAElH9E,OAAOgG,YAAYZ,SAAS4C,IAChC7G,QAAQC,IAAI,mBAAqB4G,GACjCnC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,qBAAsB,KAGtErI,OAAOgG,YAAYZ,SAAS4C,KAClC7G,QAAQC,IAAI,uBAAyB4G,EAAe,gBAAkBvD,EAAY2D,YAClFvC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,qBAAsB,MAlC1D,cAAdL,GACA7G,QAAQC,IAAI,uBAAyB4G,GACrCnC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,oBAAsB,CAAEzD,OAAO,EAAOD,OAAO,EAAOG,aAAa,EAAMC,aAAa,OAI1I5D,QAAQC,IAAI,mBAAqB4G,GACjChI,OAAOgG,YAAYI,KAAK4B,GAIxBnC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,qBAAsB,MA1DpFxC,EAAWsC,kBAAkB1D,EAAY2D,WAAW,CAAEC,qBAAsB,QAqFpFT,QC7MG,SAASU,IACtB,IAAMzC,EAAa0C,qBAAWC,GADD,EAICC,qBAAWxE,EAAaN,GAJzB,mBAItBO,EAJsB,KAIXwE,EAJW,KAKvB/I,EAVR,WAA0B,IAAD,EACGC,mBAAS,GADZ,mBACTC,GADS,WAEvB,OAAO,kBAAMA,GAAS,SAAAC,GAAK,OAAIA,EAAQ,MAQnBC,GACZ4I,EAAYJ,qBAAWK,GAAvBD,QANqB,cAOTA,EAPS,aAU7B3I,OAAOyH,WAAa,WAClB9H,KAMFoB,qBAAU,WACR,GAAK8E,EAAL,CAEA,IAAMgD,EAAS,CACb,qBACA,sBACA,oBAmEFC,IAGA,cAAoBD,EAApB,eAA4B,CAAvB,IAAME,EAAK,KACdlD,EAAWmD,GAAGD,EAAOD,GAUvB,OAAO,WAAoB,IAAD,gBACJD,GADI,IACxB,2BAA4B,CAAC,IAAlBE,EAAiB,QAC1BlD,EAAW1G,IAAI4J,EAAOD,IAFA,gCA5E1B,SAASA,EAA2BnD,GAMlC,GALAA,GAAKD,EAAcC,GACnB+C,EAAS,CACPtE,KHtBoB,sBGuBpBC,aAAcwB,EAAWxB,iBAExBsB,GAAe,uBAAVA,EAAExB,OAA+B,CACvCyB,EAAiBC,GACjB1E,QAAQC,IAAI,kCAAoCuE,EAAExB,QAEhD,IAAI6D,EAAerC,EAAElB,YAAYwD,UACbtC,EAAElB,YAAY2D,WAEpB,sBAAVzC,EAAExB,QAA0C,oBAAVwB,EAAExB,SACtCnE,OAAO+I,MAAMpD,EAIf,WAEE,IAAMsD,EAAcC,aAClB,WACUlB,KAMV,WACEhI,OAAOmJ,cAAa,EACtB,IAAItB,EAAGhC,EAAWxB,eAElB,IAAK,IAAM0D,KADX/H,OAAOoJ,SAAS,GACAvB,EAAI,CAClB,IAAIG,EAAeH,EAAGE,GAAGE,UACrBoB,EAAgBxB,EAAGE,GAAGK,WAC1BpI,OAAOoJ,SAAShD,KAAK4B,GACrBhI,OAAOgI,EAAa,cAAgBqB,EAChCrB,EAAa5C,SAAS,WAAiB,UAAJ2C,IACrC/H,OAAOmJ,cAAa,GAGxBnJ,OAAOoJ,SAASE,OAEhBnI,QAAQC,IAAR,+BAAoCpB,OAAOoJ,WAEN,qBAA3BpJ,OAAOuJ,kBAAkCvJ,OAAOuJ,mBAtBjDC,GACDC,cAAcR,MAEhB,KAXRS,IAqCFvI,QAAQC,IAAI,kBAAoBpB,OAAOmJ,cACvChI,QAAQC,IAAI,aAAepB,OAAOoJ,cA4BvC,CAACvD,IAKJ9E,qBAAU,WACR,GAAK8E,EAgBL,OAFAA,EAAWmD,GAAG,eAAgBW,GAEvB,WACL9D,EAAW1G,IAAI,eAAgBwK,IAfjC,SAASA,EAAuBZ,GAC9BrD,EAAcqD,GACdL,EAAS,CACPtE,KHxGiB,mBGyGjBa,QACG8D,GAASA,EAAMa,UAAYb,EAAMa,SAASA,UAAa,eAY7D,CAAC/D,IAKJ9E,qBAAU,WACR,GAAK8E,EAeL,OAFAA,EAAWmD,GAAG,QAASa,GAEhB,WACLhE,EAAW1G,IAAI,QAAS0K,IAd1B,SAASA,EAAiBlE,GACxBD,EAAcC,GACd+C,EAAS,CACPtE,KH1HY,cG2HZa,QAAUU,GAAKA,EAAEiE,UAAa,eAYjC,CAAC/D,IAKJ9E,qBAAU,WACR,IAAM+I,EAAIC,YAAW,WACnBrB,EAAS,CAAEtE,KHnKW,0BGoKrB,MAEH,OAAO,WACL4F,aAAaF,MAEd,IAEH,IAAMG,EAAejK,OAAOgG,aAAehG,OAAOgG,YAAYU,QAAO,SAAUC,GAAM,OAAkC,IAA3BA,EAAIC,QAAQ,aAAmBF,QAAO,SAAUC,GAAM,OAAkC,IAA3BA,EAAIC,QAAQ,aAAmBF,QAAO,SAAUC,GAAM,OAAuC,IAAhCA,EAAIC,QAAQ5G,OAAO6G,WAAiBW,OAG1PzG,qBAAU,WACZf,OAAOiK,aAAcA,IACjB,CAACA,IAlL0B,MAwL7B,WACE,IAAIC,EAAa,GACbC,EAAa,GAyCjB,OAxCA7F,OAAOC,QAAQL,EAAUN,WAAWkE,SAAQ,YAAqB,IAAD,mBAAlBtD,EAAkB,KAAd4F,EAAc,KAQxDxH,EACJhC,EAAc4D,KACZa,EAAQb,KAAQe,EAAoBrB,EAAUN,YAC5CyB,EAAQb,IAAOyF,GAAgBA,EAAa,IAAM1E,EAAoBrB,EAAUN,WAGhFyG,EACJ,kBAAC,EAAD,CACEC,IAAK9F,EACLpE,gBAAiBgK,EAAShK,gBAC1BK,gBAAiB2J,EAAS3J,gBAC1BJ,cAAegF,EAAQb,GACvB9D,YAjBgB,WAClB,GAAI0J,EAAS3J,iBAAoB2J,EAAShK,gBAC1C,OAAQgK,EAAS3J,gBAAgBH,aAAe8J,EAAShK,gBAAgBE,WAe1DI,GACbkC,QAASA,EACTQ,qBAAsBxC,EAAc4D,GACpC5D,cAAeA,EAAc4D,KAU7B5B,EACFsH,EAAW9D,KAAKiE,GAEhBF,EAAW/D,KAAKiE,MAIb,CAACH,EAAYC,GAGWI,GAtOJ,mBAsOtBL,EAtOsB,KAsOVC,EAtOU,KA4O7BpJ,qBAAU,WAGRf,OAAOkK,WAAaA,EACpBlK,OAAOwK,WAAaL,EACpBnK,OAAOyK,IAAM,WACX,IAD0B,IAANC,EAAK,uDAAH,EACdC,EAAE,EAAEA,EAAED,EAAEC,IACd9E,EAAW+E,yBAQhB7J,qBAAU,WACTf,OAAOkE,UAAYA,IAClB,CAACA,IAGJ,IAAMe,EH/JR,SAAoBf,GAOlB,IAAIT,EAAS,KACTC,EAAS,KACTF,GAAU,EAqBd,OApBIU,EAAUF,YACZP,EAAM,uBAAmBS,EAAUF,YACnCR,GAAU,GACDU,EAAUH,eAEnBN,EAAM,oDACNC,EACE,gKAEFF,GAAU,IAlBZ,WACE,IAAMqH,EAAiC3G,EAAUN,UAjDnC,MAmDd,QADkBiH,IAAkBA,EAAcC,YAC7B5G,EAAUJ,uBAgBtBiH,GAE4C,IAA5CzG,OAAOkB,KAAKtB,EAAUN,WAAW4D,SAC1C/D,EAAS,6BACTC,EAAS,gCAHTD,EAAS,gDASJA,GAAUC,EAAS,CAAED,SAAQC,SAAQF,WAAY,KGiIxCwH,CAAW9G,GAC3B,OACE,yBAAKxB,UAAW1C,OAAOiL,QAAU,oBAAsB,QAErD,yBAAKvI,UAAS,4BAAwB6C,EAAoBrB,EAAUN,WAAY,IAAMqG,GAAgBA,EAAa,IAE9GhF,EAEG,KADAiF,GAIR,yBAAKxH,UAAU,eAAeyH,GAC7BlF,GACC,kBAAC,EAAD,CACExB,OAAQwB,EAAQxB,OAChBC,OAAQuB,EAAQvB,OAChBF,QAASyB,EAAQzB,W,WCrSZH,G,YAAAA,IAAM6H,YAAW,SAAC3L,EAAO4D,GACxC,IAAM0C,EAAa0C,qBAAWC,GACxB2C,EAAmB9H,IAAM+H,YACzBC,EAAchI,IAAM+H,YACpBhH,EAAO7E,EAAM6E,KACbkH,EAAO/L,EAAM+L,KAGbC,EAAY,SAAC5F,GACf,GAAIA,EAAE6F,OAAO1L,MAAb,CACA,IAAI2L,EAAc9F,EAAE6F,OAAO1L,MAI3B,GAHQ,SAARsE,GAAyB,QAANkH,GAAgB3F,EAAE6F,OAAOlB,IAAIlF,SAAS,eAAiBS,EAAW6F,qBAAqB,CAACC,YAAaF,IAEhH,SAARrH,GAAyB,QAANkH,GAAgBzF,EAAW6F,qBAAqB,CAACE,YAAaH,IACrE,SAARrH,GAAyB,SAANkH,EAAe,CAAC,IAAD,cACO/L,EAAMsM,OADb,GACbC,GADa,WAE9BC,EAAc,CACdC,SAAU,CAAEC,MAAOR,IAEvBS,UAAUC,aAAaC,aAAa,CAACxH,MAAOmH,IAAc7E,MACtD,SAACmF,GACD,IAAIC,EAAiBD,EAAYE,iBAAiB,GAClDT,GAAiB,SAACU,GAAD,MAAQ,CAACF,EAAeE,EAAK,UAGtD,GAAY,SAARpI,GAAyB,SAANkH,EAAe,CAAC,IAAD,cACO/L,EAAMsM,OADb,GACbC,GADa,WAE9BC,EAAc,CACdU,MAAO,KACPC,OAAQ,IACRV,SAAU,CACNC,MAAOR,IAGfS,UAAUC,aAAaC,aAAa,CAACzH,MAAOoH,IAAc7E,MACtD,SAACmF,GACD,IAAIM,EAAiBN,EAAYO,iBAAiB,GAClDd,GAAiB,SAACU,GAAD,MAAQ,CAACA,EAAK,GAAGG,SAG1ChH,EAAE6F,OAAOlB,IAAIlF,SAAS,UAAYjE,QAAQC,IAAI,cAAgBuE,EAAE6F,OAAOqB,QAgFvE,OA5EJ9L,qBAAU,WACHmL,UAAUC,cAAgBD,UAAUC,aAAaW,kBAChDZ,UAAUC,aAAaW,mBACtB5F,MAAK,SAAS6F,GAEX,GAAU,SAAN3I,GAAiB+G,EAAiBnK,QAAS,CAC3C,GAAImK,EAAiBnK,QAAQgM,gBAAkB,OAI/C,IAHA,IAAIC,EAAc,GAGTtC,EAAI,EAAGA,IAAMoC,EAAYvF,SAAUmD,EAAG,CAC3C,IAAIuC,EAAaH,EAAYpC,IACzBwC,EAASC,SAASC,cAAc,WAC7B3K,UAAU,OACjByK,EAAOrN,MAAQoN,EAAWlB,SACN,eAApBkB,EAAWrO,OACXsO,EAAO7C,IAAM,aAAea,EAAiB3D,OAAS,EACtD2F,EAAON,KAAOK,EAAWI,OAAQ,eAAiBnC,EAAiB3D,OAAS,GAC5EyF,EAAY7G,KAAK+G,IAQrBnN,OAAOuN,aAlBY,GAmBnB,IAAIC,EAAaJ,SAASC,cAAc,UACxCG,EAAWF,MAAQ,sBACnBE,EAAW9K,UAAU,eACA0K,SAASC,cAAc,UAG5ClC,EAAiBnK,QAAQyM,YAAYD,GACrC,IAAS7C,EAAE,EAAGA,IAAIsC,EAAYzF,SAAUmD,EACpCQ,EAAiBnK,QAAQyM,YAAYR,EAAYtC,SAYpD,GAAY,SAARvG,GAAmBiH,EAAYrK,QAAS,CAC7C,GAAIqK,EAAYrK,QAAQgM,gBAAkB,OAC1C,IAAIU,EAAaN,SAASC,cAAc,UACxCK,EAAWJ,MAAQ,kBACnBI,EAAWhL,UAAU,eACrB2I,EAAYrK,QAAQyM,YAAYC,GAChC,IAAS/C,EAAI,EAAGA,IAAMoC,EAAYvF,SAAUmD,EAAG,CAC3C,IACIwC,EADAD,EAAaH,EAAYpC,IACzBwC,EAASC,SAASC,cAAc,WAC7B3K,UAAU,OACjByK,EAAOrN,MAAQoN,EAAWlB,SACF,eAApBkB,EAAWrO,OACXsO,EAAO7C,IAAM,cAAgBe,EAAY7D,OAAS,EAClD2F,EAAON,KAAOK,EAAWI,OAAS,WAAYjC,EAAY7D,OAAS,GACnE6D,EAAYrK,SAAWqK,EAAYrK,QAAQyM,YAAYN,SAKtEQ,OAAM,SAASC,GACdzM,QAAQC,IAAIwM,EAAIC,KAAO,KAAOD,EAAI3I,eAUpC,yBAAKvC,UAAU,oBAAoBS,IAAKA,GACzB,SAANiB,GACD,wBAAIjB,IAAKgI,EAAkBrI,QAASyI,IAG7B,SAANnH,GACD,wBAAIjB,IAAKkI,EAAavI,QAASyI,SChH/B,SAASuC,EAAYvO,GAAQ,IAAD,EAChCoJ,EAAYJ,qBAAWK,GAAvBD,QADgC,cAEpBA,EAFoB,GAEhCoF,EAFgC,KAE7BC,EAF6B,KAGlCC,EAAWxO,iBAAO,MAHgB,EAIKG,oBAAS,GAJd,mBAIjCsO,EAJiC,KAIjBC,EAJiB,OAKKvO,oBAAS,GALd,mBAKjCwO,EALiC,KAKjBC,EALiB,KAMlCC,EAAQ/O,EAAMuD,QAGdyL,EAAa9O,iBAAO,MACpB+O,EAAWnL,IAAM+H,YACjBqD,EAAcpL,IAAM+H,YACpBsD,EAAWrL,IAAM+H,YACjBuD,EAActL,IAAM+H,YAbc,EAcCxL,mBAAS,MAdV,mBAcjCgP,EAdiC,KAcnB9C,EAdmB,OAeDlM,oBAAS,GAfR,mBAejCiP,EAfiC,KAepBC,EAfoB,KAkBxC/N,qBAAU,WAOX,OALGqM,SAAS2B,iBAAiB,YAAaC,GAEvChP,OAAOiP,OAASlB,EAGZ,WACJX,SAAS8B,oBAAoB,YAAaF,OAI5C,IAAMA,EAAqB,SAACjG,GAC1B5H,QAAQC,IAAI,mBACRqN,EAAYzN,SACbyN,EAAYzN,QAAQmO,SAASpG,EAAMyC,SACnCgD,EAASxN,QAAQmO,SAASpG,EAAMyC,SAGxBmD,EAAY3N,SACpB2N,EAAY3N,QAAQmO,SAASpG,EAAMyC,SACnCkD,EAAS1N,QAAQmO,SAASpG,EAAMyC,SAEjC6C,GAAmB,GALnBF,GAAmB,IAuB3BpN,qBAAU,WACRmL,UAAUC,aAAaC,aAAa,CAACxH,OAAM,EAAKD,MAAM,CAAC8H,MAAO,KAAKC,OAAQ,OAAOxF,MAAK,SAACmF,GACtF,GAAGA,EAAY,CACbrM,OAAOqM,YAAcA,EACrB,IAAI+C,EAAa/C,EAAYE,iBAAiB,GAC1C8C,EAAahD,EAAYO,iBAAiB,GAC9Cd,EAAiB,CAACsD,EAAWC,IAC7BrP,OAAOoP,WAAWA,EAClBN,GAAgB,QAEhBA,GAAgB,MAEjBnB,OAAO,SAAAC,GACRzM,QAAQC,IAAI,oBAAsBwM,GAClCkB,GAAgB,QAKnB,IAED/N,qBAAU,WACR6N,GAAiBL,EAAWvN,UAAYuN,EAAWvN,QAAQC,UAAU,IAAIC,YAAY0N,IACrFL,EAAWvN,QAAQQ,OAAM,EACzBxB,OAAO4O,cAAcA,IACrB,CAACA,IAsBC,OACA,yBAAKlM,UAAU,aAEX,yBAAKA,UAAU,4BAEf,yBAAKA,UAAU,gBACX,yBAAKA,UAAU,eAEX,sDAIA,yBAAKK,MAAO,CAACuM,SAAS,WAAYC,WAAW,QAASC,YAAY,QAASC,QAAS,OAAQC,WAAW,OAAQC,OAAQ,uBAAwBC,gBAAgB,UACzJ,yBAAK7M,MAAO,CAAC8M,WAAW,QAAQC,QAAQ,IAAIC,OAAO,SAGxDlB,EAEG,2BAAOnM,UAAU,cAAcO,UAAU,EAAME,IAAKoL,IAEpD,uBAAGxL,MAAO,CAAC2J,OAAO,QAAQD,MAAM,QAAQuD,aAAa,OAAOH,WAAW,QAAQI,OAAO,OAAOC,MAAM,QAAQC,WAAW,SAAUC,UAAU,aAAaX,QAAQ,OAAOE,OAAO,qBAA7K,6CACgC,6BAAK,6BADrC,iEACwG,uBAAG5M,MAAO,CAACsN,OAAO,WAAYvN,QAAU,WAAK9C,OAAOsQ,SAASC,WAA7D,qBACxG,6BAAK,6BAFL,OAIA,6BACA,4BACE,4BACI,uBAAG/E,OAAO,SAASgF,KAAK,uHAAxB,aAIJ,4BACI,uBAAGA,KAAM,oCAAsChF,OAAO,UAAtD,eAWH+C,EAAWvN,SAAW6N,GACnB,yBAAK9L,MAAO,CAACuM,SAAS,WAAWtM,QAAQ,OAAOyN,cAAc,MAAMC,eAAe,SAASC,OAAO,OAAQlE,MAAM,QAAQC,OAAO,MAAMuD,OAAO,SACzI,6BACE,uBAAGvN,UAAU,kBAAkBI,QAAS,WAAKuL,GAAoBD,IAAmBjL,IAAKuL,GAAzF,mBACKN,EACA,yBAAKtL,QAAS,kBAAIuL,GAAmB,IAAOtL,MAAO,CAACuM,SAAS,WAAWqB,OAAO,MAAMC,KAAK,SACzF,kBAAC,EAAD,CAAexM,KAAK,QAAQkH,KAAK,QAAQO,OAAQ,CAAC+C,EAAc9C,GAAmB3I,IAAKwL,KAG1F,MAEN,yBAAK5L,MAAO,CAAC0J,MAAM,UAEnB,6BACE,uBAAG/J,UAAU,kBAAkBI,QAAS,WAAKqL,GAAoBD,IAAmB/K,IAAKqL,GAAzF,gBACKN,EACE,yBAAKpL,QAAS,kBAAIqL,GAAmB,IAAQpL,MAAO,CAACuM,SAAS,WAAWqB,OAAO,MAAMC,KAAK,OAAOC,UAAU,YAC3G,kBAAC,EAAD,CAAezM,KAAK,QAAQkH,KAAK,QAAQnI,IAAKsL,EAAc5C,OAAQ,CAAC+C,EAAc9C,MAGvF,QAOjB+C,GACC,wBAAInM,UAAU,UAEV,0BAAMoO,SAAU,SAACnL,GAAD,OAAKA,EAAEoL,mBACnB,2BAAO3M,KAAK,OAAO4M,aAAa,MAAMjO,MAAO,CAAC6M,gBAAiB,qBAAsBqB,SAAS,OAAQxE,MAAO,QAASC,OAAQ,OAAQwE,UAAU,SAAUC,WAAW,WAAYhO,IAAK8K,EAAUnO,MAAOiO,EAAGF,KAAMuD,QAAS,WAAoB,oBAAVrD,EAAGF,MAA2BG,GAAM,SAACqD,GAAD,mBAAC,eAAiBA,GAAlB,IAA4BxD,KAAM,SAAWyD,SAAU,SAAA3L,GAAC,OAtFpU,SAAAA,GAGnB,IAAI4L,EAAU5L,EAAE6F,OAAO1L,MACvBkO,GAAM,SAACqD,GAAD,mBAAC,eACkBA,GADnB,IAEgBxD,KAAM0D,OAgF6TC,CAAa7L,MAAM,6BAAK,6BACzV,8BAAOjD,UAAU,WAAWK,MAAO,CAAC0J,MAAM,QAASyD,MAAM,UAAWe,SAAU,QAAS7M,KAAK,UAA5F,qBAA0G,UAA1G,sBAAyH,iBAAzH,yBApI1B,WACIjD,QAAQC,IAAI,sBAAwB2M,EAAGF,MACvB,KAAZE,EAAGF,MAAyB,oBAAVE,EAAGF,MAA4BE,EAAGF,KAAKrG,QAAQ,EACnEiK,MAAM,8DAEN1D,EAAGF,KAAyB,UAAlB7N,OAAO+F,OAAqBgI,EAAGF,KAAO,SAAWE,EAAGF,KAC9D7N,OAAO6G,OAASkH,EAAGF,KACnBS,QA6HoB,KAGJ,kC,4CC/LxB,sBAAAoD,EAAA,+EAkBS,CAAEC,IAAK,gDAlBhB,4C,sBAqBe,OAAEC,W,8DCrBF,SAASC,EAAKtS,GAC3B,SAASuS,IACP,OAAOvS,EAAMwS,YAAc,UAAY,UAsFzC,OACE,yBACEtF,MAAM,OACNC,OAAO,OACPsF,QAAQ,YACRtP,UAAWnD,EAAMmD,UACjBuP,MAAM,8BAzFV,WACE,OAAQ1S,EAAM6E,MACZ,IAlBmB,SAmBjB,OACE,uBACEI,GAAG,UACH0N,OAAO,OACPC,YAAY,IACZC,KAAK,OACLC,SAAS,WAET,uBACE7N,GAAG,oBACH8N,UAAU,kCACVF,KAAMN,KAEN,uBACEtN,GAAG,uBACH8N,UAAU,kCAEV,0BACEC,EAAE,8yBACF/N,GAAG,sBAMf,IA3CgB,WA4Cd,OACE,uBACEA,GAAG,UACH0N,OAAO,OACPC,YAAY,IACZC,KAAK,OACLC,SAAS,WAET,uBACE7N,GAAG,oBACH8N,UAAU,mCACVF,KAAMN,KAEN,uBACEtN,GAAG,2BACH8N,UAAU,mCAEV,0BACEC,EAAE,4rDACF/N,GAAG,sBAMf,IApEc,SAqEZ,OACE,0BACE4N,KAAMN,IACNO,SAAS,UACTE,EAAE,+VAGR,IA3Ea,QA4EX,OACE,0BACEA,EAAE,mfACFH,KAAMN,IACNO,SAAS,YAGf,IAlFY,OAmFV,OACE,0BACEE,EAAE,mNACFH,KAAMN,IACNO,SAAS,YAGf,QACE,MAAM,IAAInN,OAYXsN,IC3FQ,SAASC,EAAWlT,GACjC,OACE,4BACEmT,SAAUnT,EAAMmT,SAChB5P,QAASvD,EAAMuD,QACfJ,UAAW,eAAiBnD,EAAMoT,eAAiB,aAAe,KAElE,kBAACd,EAAD,CAAMzN,KAAM7E,EAAM6E,KAAM2N,YAAaxS,EAAMwS,e,kBCrBlC,SAASa,EAAKrT,GAC3B,IAAMsG,EAAa0C,qBAAWC,GADI,EAEE5I,mBAAS,IAFX,mBAE3BiT,EAF2B,KAEfC,EAFe,OAGIlT,mBAAS,IAHb,mBAG3BmT,EAH2B,KAGdC,EAHc,KA2DlC,OA9BAjS,qBAAU,WACR,GAAK8E,EAsBL,OAFAA,EAAWmD,GAAG,cAAeiK,GAEtB,WACLpN,EAAW1G,IAAI,cAAe8T,IAnBhC,SAASA,EAAiBlK,GACHlD,EAAWxB,eAAhC,IACMwJ,EAAOhI,EAAWxB,eAAeR,MAAMoE,UAAU7C,SAAS,UAC9DS,EAAWxB,eAAeR,MAAMoE,UAAUiL,MAAM,UAAUC,KAAK,IAC/DtN,EAAWxB,eAAeR,MAAMoE,UACjB,QAAjBc,EAAMqK,KAAKhP,MAAe4O,EAAe,GAAD,mBACnCD,GADmC,CAEtC,CACEM,OAAQxF,EACR5I,QAAS8D,EAAMqK,KAAKnO,YAIP,QAAjB8D,EAAMqK,KAAKhP,MAAe7E,EAAM+T,kBAQjC,CAACzN,EAAYkN,IAEhBhS,qBAAU,cAAU,CAACgS,IAEdxT,EAAMgU,eACX,yBAAK7Q,UAAU,QACP,yBAAKA,UAAU,gBAEfqQ,EAAYS,KAAI,SAACC,EAAOtM,GAAR,OAChB,yBAAKmD,IAAG,gBAAWnD,GAASzE,UAAU,eACpC,2BAAI+Q,EAAMJ,QADZ,KAC0BI,EAAMxO,aAKtC,0BAAM6L,SA7DV,SAAsB/H,GACpBA,EAAMgI,iBACNlL,EAAW6N,eAAe,CAAEtP,KAAK,OAAQa,QAAS4N,GAAc,KAChE,IAAMhF,EAAOhI,EAAWxB,eAAeR,MAAMoE,UAAU7C,SAAS,UAC5DS,EAAWxB,eAAeR,MAAMoE,UAAUiL,MAAM,UAAUC,KAAK,IAC/DtN,EAAWxB,eAAeR,MAAMoE,UACpC+K,EAAe,GAAD,mBACTD,GADS,CAEZ,CACEM,OAAQxF,EACR5I,QAAS4N,MAGbC,EAAc,MAiDV,2BAAOa,QAAQ,cACf,2BACEnP,GAAG,YACH9B,UAAU,aACV0B,KAAK,OACLwP,YAAY,2BACZ9T,MAAO+S,EACPvB,SAzEa,SAACvI,GACpB+J,EAAc/J,EAAMyC,OAAO1L,UA0EvB,4BAAQsE,KAAK,SAAS1B,UAAU,oBAAhC,UAKF,K,WC3CS,SAASmR,EAAKtU,GAC3B,IAAMsG,EAAa0C,qBAAWC,GADI,EAEM5I,oBAAS,GAFf,mBAE3BkU,EAF2B,KAEZC,EAFY,OAGAnU,oBAAS,GAHT,mBAG3BoU,EAH2B,KAGfC,EAHe,OAIUrU,oBAAS,GAJnB,mBAI3BsU,EAJ2B,KAIVC,EAJU,OAKIvU,oBAAS,GALb,mBAK3BwU,EAL2B,KAKdC,EALc,OAMUzU,oBAAS,GANnB,mBAM3B0U,EAN2B,KAMVC,EANU,KAO5B5U,EAvCR,WAA0B,IAAD,EACGC,mBAAS,GADZ,mBACTC,GADS,WAEvB,OAAO,kBAAMA,GAAS,SAAAC,GAAK,OAAIA,EAAQ,MAqCnBC,GACdyO,EAAWnL,IAAM+H,YACjBqD,EAAcpL,IAAM+H,YACpBsD,EAAWrL,IAAM+H,YACjBuD,EAActL,IAAM+H,YAE1BpL,OAAO0H,WAAa,WAClB/H,KAdgC,MAiBWC,oBAAS,GAjBpB,mBAiB3BsO,EAjB2B,KAiBXC,EAjBW,OAkBWvO,oBAAS,GAlBpB,mBAkB3BwO,EAlB2B,KAkBXC,EAlBW,KA6BlCtN,qBAAU,WAKX,OAHGqM,SAAS2B,iBAAiB,YAAaC,GAGnC,WACJ5B,SAAS8B,oBAAoB,YAAaF,OAI5C,IAAMA,EAAqB,SAACjG,GAC1B5H,QAAQC,IAAI,mBACRqN,EAAYzN,SACbyN,EAAYzN,QAAQmO,SAASpG,EAAMyC,SACnCgD,EAASxN,QAAQmO,SAASpG,EAAMyC,SAGxBmD,EAAY3N,SACpB2N,EAAY3N,QAAQmO,SAASpG,EAAMyC,SACnCkD,EAAS1N,QAAQmO,SAASpG,EAAMyC,SAEjC6C,GAAmB,GALnBF,GAAmB,IAwFvB,OA3BApN,qBAAU,WACR,GAAK8E,EAmBL,OANAiD,IAGAjD,EAAWmD,GAAG,sBAAuBF,GAG9B,WACLjD,EAAW1G,IAAI,sBAAuB2J,IAlBxC,SAASA,EAA2BC,GAClCA,GAASrD,EAAcqD,GADkB,MAnI/C,SAAyBlD,GACvB,IAAIiO,EACFE,EACAE,GAAkB,EACpB,GACErO,GACAA,EAAWxB,gBACXwB,EAAWxB,eAAeR,MAC1B,CACA,IAAM2Q,EAAmB3O,EAAWxB,eAAeR,MACnDiQ,GAAiBU,EAAiB7P,MAClCqP,GAAcQ,EAAiB5P,MAC/BsP,EAAkBM,EAAiBC,OAErC,MAAO,CAACX,EAAeE,EAAYE,GAuHsBQ,CACnD7O,GAHuC,mBAElCiO,EAFkC,KAEnBE,EAFmB,KAEPE,EAFO,KAKzCH,EAAeD,GACfG,EAAYD,GACZG,EAAiBD,MAalB,CAACrO,IAKF,yBAAKnD,UAAW1C,OAAOiL,QAAU,oBAAsB,QAErD,kBAAC,EAAD,CACE7G,KHrLiB,SGsLjBsO,SAAUnT,EAAMoV,YAChB5C,YAAa+B,EACbhR,QAxHN,WACE+C,EAAW+O,cAAcd,OA0HrBvU,EAAMoV,aACR,yBAAK7R,QAAS,WAAKuL,GAAoBD,IAAoBrL,MAAO,CAACuM,SAAS,WAAWsB,KAAK,OAAQD,OAAO,SACzG,uBAAGjO,UAAU,QAAQS,IAAKuL,GAA1B,KACSN,EACA,kBAAC,EAAD,CAAehK,KAAK,QAAQkH,KAAK,OAAOnI,IAAKwL,IAE9C,MAIV,kBAAC,EAAD,CACEvK,KHrMc,WGsMdsO,SAAUnT,EAAMsV,YAChB9C,YAAaiC,EACblR,QArIN,WACE+C,EAAWiP,cAAcd,OAsIrBzU,EAAMsV,aACN,yBAAK/R,QAAS,WAAKqL,GAAoBD,IAAoBnL,MAAO,CAACuM,SAAS,WAAWsB,KAAK,QAASD,OAAO,SAG5G,uBAAGjO,UAAU,QAAQS,IAAKqL,GAA1B,KACSN,EACA,kBAAC,EAAD,CAAe9J,KAAK,QAAQkH,KAAK,OAAOnI,IAAKsL,IAE9C,MAKTsG,IAAYC,mBAAmBC,qBAAuBjV,OAAOiL,SAC5D,kBAAC,EAAD,CACE7G,KHxNU,SG0NV2N,YAAamC,EACbpR,QAlFR,WACE9C,OAAOkV,KAAK,UAAYlV,OAAOsQ,SAAS6E,KAAO,SAAS,OAAO,4BAqF7D,kBAAC,EAAD,CACE/Q,KH9NU,OGgOV2N,YAAauC,EACbxR,QArGN,WACEuR,GAAgBD,GACZE,GACFC,GAAkBD,MAoGlB,kBAAC,EAAD,CAAMf,eAAgBa,EAAad,aAhGvC,WACEiB,GAAkBD,MAsGZ,yBAAK5R,UAAU,kBAEb,yBAAKK,MAAO,CAAC2J,OAAO,SAApB,kBAEiB1M,OAAOyC,aAAawD,SACnB,yBAAKvD,UAAU,uBAAf,QAEA,yBAAKA,UAAU,uBAAf,WAIlB,yBAAKA,UAAU,mBAGb1C,OAAOyC,aAAawD,UAA6B,UAAhBjG,OAAO+F,QAAoC,aAAhB/F,OAAO+F,OAE3D,yBAAKhD,MAAO,CAAC2J,OAAO,SAApB,gBAEsB,SAAf1M,OAAO+F,QAAkC,YAAf/F,OAAO+F,OAEhC,0BAAMrD,UAAU,qBAAhB,UAGA,0BAAMA,UAAU,qBACb1C,OAAO+F,OAAOqP,MAAM,OAAOjC,KAAK,MAMjD,yBAAKzQ,UAAU,WAAf,gBAEY,8BACE,0BAAMyB,OAAS,IACb,8BAAUpB,MAAO,CAAC4M,OAAO,SACrB,4BAAQjN,UAAU,mBAAmB5C,MAAOE,OAAO8F,SAAUwL,SAAY,SAAC3L,GAAD,OAAK3F,OAAOqV,YAAY1P,EAAE6F,OAAO1L,SACtG,4BAAQA,MAAQ,UAAhB,UACCE,OAAOyC,aAAayD,OAAOC,SAAW,4BAAQrG,MAAQ,UAAUwV,UAAQ,GAAlC,YACtCtV,OAAOyC,aAAayD,OAAOY,SAAW,4BAAQhH,MAAQ,WAAhB,YACtCE,OAAOyC,aAAayD,OAAOa,SAAW,4BAAQjH,MAAQ,WAAhB,YACtCE,OAAOyC,aAAayD,OAAOc,SAAW,4BAAQlH,MAAQ,WAAhB,YACtCE,OAAOyC,aAAayD,OAAOC,SAC1BnG,OAAOyC,aAAayD,OAAOY,SAC3B9G,OAAOyC,aAAayD,OAAOa,SAC3B/G,OAAOyC,aAAayD,OAAOc,SAC3B,4BAAQlH,MAAQ,OAAhB,aAmBpC,kBAAC,EAAD,CACEsE,KH5SW,QG6SXsO,SAAUnT,EAAMmT,SAChBC,gBAAgB,EAChBZ,aAAa,EACbjP,QAvLN,WACEvD,EAAMgW,kBAAoBhW,EAAMgW,uBC7HrBlS,UAAMC,gBCGd,SAASkS,EAAmBC,GACjC,OACEzV,OAAOsQ,SAASE,KAAK0C,MAAM,KAAK,IAC/BuC,EAAO,mBAAeC,mBAAmBD,IAAa,ICR5C,SAASE,EAAYC,EAAUC,GA8B1C,GARA7V,OAAO4E,MAAMkR,IArBK,CACdC,WAAY,+FACZC,WAAY,8EACZC,WAAY,qEACZC,WAAY,oEACZC,WAAY,GACZC,WAAY,GAEZC,UAAW,4EACXC,WAAY,4EACZC,UAAW,kFACXC,WAAY,kFACZC,UAAW,GACXC,WAAY,GACZC,UAAW,GACXC,WAAY,GACZC,UAAW,GACXC,WAAY,GACZC,UAAW,GACXC,WAAY,IAEapB,GAC7BzU,QAAQC,IAAR,mBAAyByU,EAAzB,YAAoCD,IACpC5V,OAAO4E,MAAMiR,KAMD,SAATA,EAAH,CAM6B,oBAAlB7V,OAAO2B,WAAyB3B,OAAO2B,SAAW,IAAK3B,OAAO4B,cAAgB5B,OAAO6B,qBAEhG7B,OAAO8B,gBAAkB9B,OAAO8B,iBAAmB9B,OAAO2B,SAASsV,yBAAyBjX,OAAO4E,OAGnG,IAAI1C,EAAWlC,OAAO2B,SAASQ,aAC/BD,EAASI,KAAKxC,MAAM,EAEpB,IAAIsC,EAAUpC,OAAO2B,SAASU,qBAC9BD,EAAQG,IAAIzC,MAAM,EAGlBE,OAAO8B,gBAAgBU,QAAQN,GAAUM,QAAQJ,GAASI,QAAQxC,OAAO2B,SAASK,kBAjB9EhC,OAAO8B,gBAAgBoV,a,YCvBhB,SAASC,EAAa5X,GACjC,IAAMsG,EAAa0C,qBAAWC,GACtB4O,EAAY7O,qBAAW8O,GAAvBD,QAFgC,cAGAA,EAHA,GAGhC3U,EAHgC,KAGnB6U,EAHmB,KAKlCC,EAAOhY,EAAMgY,KA6CnB,OAKA,0BAAM7U,UAAU,YACR,4BAAQA,UAAU,WAAW8B,GAAI+S,EAAMjG,SAzCxB,SAAC3L,GACpB3F,OAAOyC,aAAayD,OAAOP,EAAE6F,OAAOhH,IAAImB,EAAE6F,OAAO1L,MACjDwX,GAAgB,SAACjG,GAAD,mBAAC,eAEVA,GAFS,IAGZnL,OAAO,2BACImL,EAAUnL,QADf,kBAEGP,EAAE6F,OAAOhH,GAAKmB,EAAE6F,OAAO1L,aAIpCqB,QAAQC,IAAKuE,EAAE6F,OAAOhH,GAAK,YAAcmB,EAAE6F,OAAO1L,OAhBlDqB,QAAQC,IAAK,4BACbyE,EAAW6N,eAAe1T,OAAOyC,aAAc,KAkB/C,IAAI+U,EAAY,WAChB,IAAK,IAAMlN,KAAOtK,OAAOyC,aAAayD,OAC/BlG,OAAOyC,aAAayD,OAAOoE,IAAMtK,OAAO6G,SACvC2Q,EAAYlN,GAGhBkN,GAAWxX,OAAO+F,SAClB/F,OAAO+F,OAASyR,EACVxX,OAAO+F,OAAOX,SAAS,KACvBpF,OAAOyX,SAAS,EACTzX,OAAO+F,OAAOX,SAAS,OAC9BpF,OAAOyX,SAAS,IAGnBzX,OAAOyC,aAAawD,SAvCRL,EAAiBC,EAAW7F,OAAO8F,WAoDiBhG,MAAO2C,EAAayD,OAAOqR,IAC9F,4BAAQzX,MAAO,OACVE,OAAOoJ,UAAYpJ,OAAOoJ,SAAS5B,OAAO,GAAKxH,OAAOoJ,SAASoK,KAAI,SAACkE,GAAD,OAAU,4BAAQ5X,MAAO4X,GAAOA,EAAKtS,SAAS,UAAYsS,EAAKxE,MAAM,UAAUC,KAAK,IAAMuE,Q,MCf/J,SAASC,EAAWpY,GACjC,IAAMsG,EAAa0C,qBAAWC,GADU,EAGA5I,oBAAS,GAHT,mBAGlBmU,GAHkB,aAINnU,oBAAS,GAJH,mBAIrBqU,GAJqB,aAKIrU,oBAAS,GALb,mBAKhBuU,GALgB,aAMFvU,oBAAS,GANP,gCAOIA,oBAAS,IAPb,mBAQhCwX,GARgC,UAQpB7O,qBAAW8O,GAAvBD,SARgC,cASAA,EATA,GAShC3U,EATgC,KASnB6U,EATmB,KAWlC3X,EA/CR,WAA0B,IAAD,EACGC,mBAAS,GADZ,mBACTC,GADS,WAEvB,OAAO,kBAAMA,GAAS,SAAAC,GAAK,OAAIA,EAAQ,MA6CnBC,GACpBC,OAAOuJ,iBAAiB5J,EAZgB,MAaIC,mBAAS,QAbb,mBAajCgY,EAbiC,KAajBC,EAbiB,OAcMjY,mBAAS,cAdf,mBAcjCkY,EAdiC,KAchBC,EAdgB,KAelCC,EAAW3U,IAAM+H,YACjB6M,EAAiB5U,IAAM+H,YAE7BrK,qBAAU,WACR,GAAK8E,EAAL,CAQA,IANA,IAAMgD,EAAS,CACb,qBACA,mBACA,kBAGF,MAAoBA,EAApB,eAA4B,CAAvB,IAAME,EAAK,KACdlD,EAAWmD,GAAGD,GAAO,kBAAMgB,YAAW,kBAAIpK,MAAc,QAG1D,OAAO,WAAoB,IAAD,gBACJkJ,GADI,IACxB,2BAA4B,CAAC,IAAlBE,EAAiB,QAC1BlD,EAAW1G,IAAI4J,GAAO,kBAAMgB,YAAW,kBAAIpK,MAAc,SAFnC,mCAMzB,CAACkG,IAIN,IAAMqS,EAAY,WACd/W,QAAQC,IAAK,4BACbyE,EAAW6N,eAAe1T,OAAOyC,aAAc,MA4IjD,OAzIA1B,qBAAU,WACRf,OAAOkY,UAAYA,IACnB,CAACA,IAyGHnX,qBAAU,WACR,GAAK8E,EAmBL,OANAiD,IAGAjD,EAAWmD,GAAG,sBAAuBF,GAG9B,WACLjD,EAAW1G,IAAI,sBAAuB2J,IAlBxC,SAASA,EAA2BC,GAClCA,GAASrD,EAAcqD,GADkB,MApL/C,SAAyBlD,GACvB,IAAIiO,EACFE,EACAE,GAAkB,EACpB,GACErO,GACAA,EAAWxB,gBACXwB,EAAWxB,eAAeR,MAC1B,CACA,IAAM2Q,EAAmB3O,EAAWxB,eAAeR,MACnDiQ,GAAiBU,EAAiB7P,MAClCqP,GAAcQ,EAAiB5P,MAC/BsP,EAAkBM,EAAiBC,OAErC,MAAO,CAACX,EAAeE,EAAYE,GAwKsBQ,CACnD7O,GAHuC,mBAElCiO,EAFkC,KAEnBE,EAFmB,KAEPE,EAFO,KAKzCH,EAAeD,GACfG,EAAYD,GACZG,EAAiBD,MAalB,CAACrO,IAQN,6BACE,yBAAKnD,UAAU,eAGX,yBAAKA,UAAU,yBAIX,yBAAKA,UAAU,gBAAf,WAGI,kBAAC,EAAD,CACE6U,KAAK,SACLY,cAAc,kBAEhB,kBAAC,EAAD,CACEZ,KAAK,SACLY,cAAc,kBAEhB,kBAAC,EAAD,CACEZ,KAAK,SACLY,cAAc,mBAKpB,yBAAKzV,UAAU,gBAAf,SAEI,kBAAC,EAAD,CACI6U,KAAK,SACLY,cAAc,mBAKtB,yBAAKzV,UAAU,gBAAf,qBAEI,kBAAC,EAAD,CACI6U,KAAK,UACLY,cAAc,kBAEhB,kBAAC,EAAD,CACEZ,KAAK,UACLY,cAAc,kBAEhB,kBAAC,EAAD,CACEZ,KAAK,UACLY,cAAc,kBAEhB,kBAAC,EAAD,CACEZ,KAAK,UACLY,cAAc,oBAuBxB,yBAAKzV,UAAU,kBACC,2BAAO0V,MAAM,UACT,2BAAOhU,KAAK,WAAWI,GAAG,QAAQ6T,QAAS5V,EAAawD,SAAUqL,SAjN5F,WACEgG,GAAgB,SAACjG,GAAD,mBAAC,eACZA,GADW,IAEdpL,UAAWoL,EAAUpL,cAEvBjG,OAAOyC,aAAawD,UAAUjG,OAAOyC,aAAawD,SAClDiS,KAEIlY,OAAOyC,aAAawD,UAAajG,OAAO+F,OAAOX,SAAS,WAAcpF,OAAO+F,OAAOX,SAAS,WAAcpF,OAAO+F,OAAOX,SAAS,UAkBpIjE,QAAQC,IAAI,qBACZD,QAAQC,IAAI,wBAA0BpB,OAAO8F,UApE1BF,EAAiBC,GAsEpC1E,QAAQC,IAAI,wBAA0BpB,OAAO8F,YAnBzC9F,OAAOyC,aAAayD,OAAOC,QAC5BnG,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOY,QACjC9G,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOa,QACjC/G,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOc,QACjChH,OAAOqV,YAAY,WAEnBrV,OAAOqV,YAAY,UACtBrV,OAAOsY,WAAWzS,EAAWxB,eAAeR,MAAMc,MAClD3E,OAAOuY,WAAW1S,EAAWxB,eAAeR,MAAMe,MAClDiB,EAAW+O,eAAc,GACzB/O,EAAWiP,eAAc,IAQtB9U,OAAOyC,aAAawD,WACvBJ,EAAW+O,eAAc,GACzB/O,EAAWiP,eAAc,OAiLH,0BAAMsD,MAAM,kBAEhB,+CA/ExB,2BA2FA,yBAAK1V,UAAU,wBAAwBS,IAAK6U,GAA5C,iBAIoB,yBAAKjV,MAAO,CAAC2J,OAAO,OAAOuD,OAAO,SAClC,0BAAM9L,OAAS,IACX,8BAAUpB,MAAO,CAAC4M,OAAO,SACzB,4BAAQyI,MAAM,0BAA0B9G,SAAU,SAAC3L,GAAOoS,EAAoBpS,EAAE6F,OAAO1L,OAAQqB,QAAQC,IAAI,iBAAmBuE,EAAE6F,OAAO1L,SAEvI,4BAAQA,MAAQ,cAAhB,mCAEA,4BAAQA,MAAQ,cAAhB,oCACA,4BAAQA,MAAQ,cAAhB,yBACA,4BAAQA,MAAQ,cAAhB,qBACA,4BAAQA,MAAQ,aAAhB,qBACA,4BAAQA,MAAQ,aAAhB,6BAKN,0BAAMiD,MAAO,CAACmN,MAAO,QAASe,SAAU,OAAQE,WAAW,wCACvD,4BAAQrO,QAhN5B,WACE,IAAI0V,EAAaxY,OAAOyC,aAAayD,OAAOC,SAAWnG,OAAOA,OAAOyC,aAAayD,OAAOC,QAAU,cAC/FsS,EAAazY,OAAOyC,aAAayD,OAAOY,SAAW9G,OAAOA,OAAOyC,aAAayD,OAAOY,QAAU,cAInG,GAHG9G,OAAOyC,aAAayD,OAAOC,SAASnG,OAAO6G,SAAS2R,EAAW,MAC/DxY,OAAOyC,aAAayD,OAAOY,SAAS9G,OAAO6G,SAAS4R,EAAW,MAE7DD,GAAeC,EAApB,CAEA,IAAMtU,EAASnE,OAAO0Y,eAAiB,QAAU,OAC3CC,EAAgB,CACpBvU,KAAM,eACNoH,OAAQsM,EACR3T,OAAQA,EACRyU,UAAWJ,GAEPK,EAAgB,CACpBzU,KAAM,eACNoH,OAAQsM,EAAkB,IAC1B3T,OAAQA,EACRyU,UAAWH,GAGTD,IACa,MAAZA,EACD3S,EAAW6N,eAAeiF,EAAcH,GAEtB,MAAZA,GACN7C,EAAYmC,EAAgB3T,GAE9BhD,QAAQC,IAAR,eAAoB+C,EAApB,uBAAyCnE,OAAOyC,aAAayD,OAAOC,WAElEsS,IACa,MAAZA,EACD5S,EAAW6N,eAAemF,EAAcJ,GAEtB,MAAZA,GACN9C,EAAYmC,EAAgB,IAAI3T,GAElChD,QAAQC,IAAR,eAAoB+C,EAApB,uBAAyCnE,OAAOyC,aAAayD,OAAOY,WAGtE9G,OAAO0Y,gBAAiB1Y,OAAO0Y,eAC/Bb,EAAmB7X,OAAO0Y,eAA0B,QAAT,aApCVvX,QAAQC,IAAI,mBA0MMoD,GAAG,cAAcoT,KAMxE,yBAAKlV,UAAU,kBAAkBS,IAAK8U,EAAgBnV,QAtKpD,WACEkV,EAAShX,QAAQ8X,UAAUC,OAAO,UAClCd,EAAejX,QAAQgY,UAAYhB,EAAShX,QAAQ8X,UAAU3J,SAAS,UAAY,gBAAkB,MAoKzG,kBC7UA,IAEM8J,EAAgB,gBAChBC,EAAe,eAEfC,EAAc,cAKL,SAASC,IAAO,IAAD,EACIxZ,mBAXf,cAUW,mBACrByZ,EADqB,KACXC,EADW,OAEE1Z,mBAAS,MAFX,mBAErB6V,EAFqB,KAEZ8D,EAFY,OAGQ3Z,mBAAS,MAHjB,mBAGrBiG,EAHqB,KAGT2T,EAHS,OAIY5Z,mBAAS,CACCwE,KAAM,eACN8D,SAAQ,EACRjC,UAAS,EACTQ,cAAa,EACbP,OAAQ,CACEM,OAAQ,GACRF,OAAQ,GACRC,OAAQ,GACRF,OAAQ,GACRF,QAAS,GACTW,QAAS,GACTC,QAAS,GACTC,QAAS,MAjBzC,mBAIrBvE,EAJqB,KAIP6U,EAJO,OAoBR1X,mBAAS,CACCiO,KAAM,kBACN0J,KAAM,WACNkC,aAAa,IAvBf,mBAoBrB1L,EApBqB,KAoBjBC,EApBiB,OAyBYpO,oBAAS,GAzBrB,mBAyBpB+U,EAzBoB,KAyBP+E,EAzBO,OA0BY9Z,oBAAS,GA1BrB,mBA0BpBiV,EA1BoB,KA0BP8E,EA1BO,KA8BvB3Z,OAAO4Z,KAAKxU,SAASpF,OAAO6Z,OAE/B7Z,OAAOsQ,SAASE,KAAO,wBAGzBxQ,OAAOqV,YAAc,SAACvP,GACpBA,GAAY3E,QAAQC,IAAK,0BAA4B0E,GACrD9F,OAAO8F,SAASA,EAChBF,EAAiBC,EAAWC,IAQ9B,IAAMgU,EAAaC,uBAAY,WAE7B,OADAT,EAxDmB,kBAyDZU,EACJpI,aACA1K,MAAK,SAAC+S,GAAD,OAAUA,EAAKtI,OACpBhE,OAAM,SAACuM,GACN/Y,QAAQC,IAAI,sBAAuB8Y,GACnCX,EAAW,MACXD,EAhEW,mBAkEd,IAuBGa,EAAmBJ,uBAAY,SAACpI,GAEpC,IAAMyI,EAAgBrF,IAAYsF,iBAAiB,CACjDC,gCAAgC,IAElCf,EAAW5H,GACX6H,EAAcY,GACdd,EAAYL,GACTjZ,OAAO4O,eACRzN,QAAQC,IAAI,kBAAoBpB,OAAO4O,cAAc,GAAK,oBAAsB5O,OAAO4O,cAAc,IACrGwL,EAAcjH,KAAK,CAAEoH,SAASva,OAAO6G,OAAQ8K,MAAKhG,YAAa3L,OAAO4O,cAAc,GAAGhD,YAAY5L,OAAO4O,cAAc,MAExH1C,UAAUC,aAAaC,aAAa,CAACxH,OAAM,EAAKD,OAAM,IAAOuC,MAAK,SAACmF,GACjE,GAAGA,EAAY,CACb,IAAI+C,EAAa/C,EAAYE,iBACzB8C,EAAahD,EAAYO,iBAC1BwC,GAAcA,EAAW5H,OAAS,GAAK6H,GAAcA,EAAW7H,OAAS,GAEtE4S,EAAcjH,KAAK,CAAEoH,SAASxM,EAAGF,KAAM8D,MAAKhG,YAAayD,EAAW,GAAIxD,YAAYyD,EAAW,SAO3GlO,QAAQC,IAAI,uBAAyB2M,EAAGF,MACxB2H,EAAmBC,GAAezV,OAAO6G,OAAa7G,OAAO+F,SAa5E,IAOGyU,EAAmBT,uBAAY,WAC9BlU,IAEDwT,IAAaF,EACftT,EAAW4U,UAAUvT,MAAK,WACxBqS,EAAW,MACXC,EAAc,MACdF,EA9IW,cA+IXtZ,OAAO0a,iBAGTpB,EA9IgB,iBA+IhBzT,EAAW8U,QACX3a,OAAO0a,iBAER,CAAC7U,EAAYwT,IAwDjB,SAASuB,IAC6B,GAA/B5a,OAAOyC,aAAayF,SAKpBrC,EAAW6N,eAAe,gBAAiB,KAC3CvS,QAAQC,IAAI,gCALZqI,cAAczJ,OAAO6a,cApD3B9Z,qBAAU,WACR,IAAM4Q,EJjLH,WACL,IAAMyD,EAAQpV,OAAOsQ,SAASwK,OAAO1F,MAAM,oBAC3C,OAAOA,GAASA,EAAM,GAAK2F,mBAAmB3F,EAAM,IAAM,KI+K5C4F,GACZrJ,GAAO3R,OAAO4O,eAAiBuL,EAAiBxI,KAC/C,CAACwI,IASJpZ,qBAAU,WACR,IAAIka,EAAUzF,EAAmBC,GACjCzV,OAAOib,QAAQA,EAEXjb,OAAO6G,SACLoU,EAAQrU,QAAQ,MAAQ,EAC1BqU,GAAW,MAAQjb,OAAO6G,OAE1BoU,GAAW,MAAQjb,OAAO6G,QAG1B7G,OAAO+F,SACLkV,EAAQrU,QAAQ,MAAQ,EAC1BqU,GAAW,MAAQjb,OAAO+F,OAE1BkV,GAAW,MAAQjb,OAAO+F,QAG1B/F,OAAO6Z,MACLoB,EAAQrU,QAAQ,MAAQ,EAC1BqU,GAAW,MAAQjb,OAAO6Z,IAE1BoB,GAAW,MAAQjb,OAAO6Z,KAG1BoB,IAAYjb,OAAOsQ,SAASE,MAChCxQ,OAAOkb,QAAQC,aAAa,KAAM,KAAMF,KACvC,CAACxF,IAMJ1U,qBAAU,WACRf,OAAO6F,WAAaA,IACnB,CAACA,IA8CJ9E,qBAAU,WACR,GAAK8E,EAAL,CAEA,IAAMgD,EAAS,CAAC,iBAAkB,eAAgB,QAAQ,sBAgD1DuS,IAGA,cAAoBvS,EAApB,eAA4B,CAAvB,IAAME,EAAK,KACdlD,EAAWmD,GAAGD,EAAOqS,GAIvB,OAAO,WAAoB,IAAD,gBACJvS,GADI,IACxB,2BAA4B,CAAC,IAAlBE,EAAiB,QAC1BlD,EAAW1G,IAAI4J,EAAOqS,IAFA,gCAtD1B,SAASA,EAAsBrS,GAE7B,OADAA,GAASrD,EAAcqD,GACflD,EAAWwV,gBACjB,IAAK,iBACH/B,EAAYJ,GACZrT,EAAWyV,mBAAmB,CAAEC,SAAU,QAC1Cvb,OAAOoJ,SAAShD,KAAKpG,OAAO6G,QAC5B1F,QAAQC,IAAI,kBACM,IAAfpB,OAAO6G,QAAYhB,EAAW8U,QAC5B3a,OAAOyC,aAAayF,UACJ,SAAflI,OAAO+F,OA7Cd,IAAI4B,SAAQ,SAACC,GAClB5H,OAAOmJ,cAAe,EACtB,IAAItB,EAAGhC,EAAWxB,eACZmX,EAA0BtS,aAAa,WAC3C,GAAK5E,OAAOkB,KAAKqC,GAAIL,OAAS,GACpBlD,OAAOkB,KAAKqC,GAAIL,QAAU,GAAKK,EAAGhE,MAAMoE,WAAajI,OAAO6G,OADtE,CAIM,IAAK,IAAMkB,KADX0B,cAAc+R,GACE3T,EAAI,CAClB,IAAIG,EAAeH,EAAGE,GAAGE,UACrBD,EAAa5C,SAAS,WAAiB,UAAJ2C,IACrC/H,OAAOmJ,cAAe,GAExBhI,QAAQC,IAAR,+BAAoC4G,IAEtCJ,OAEN,QA6B8BV,MAAK,WACzBlH,OAAOyC,aAAayF,SAAUlI,OAAOmJ,aACrCnJ,OAAOmJ,aAAchI,QAAQC,IAAR,+BAA6CD,QAAQC,IAAR,mCAC7DpB,OAAOyC,aAAayF,UACvBlI,OAAO6a,aAAe3R,aAAY,WAAK0R,MAAY,UAIvD5a,OAAO6a,aAAe3R,aAAY,WAAK0R,MAAY,OAKvD,MACF,IAAK,eACH/U,EAAW4U,UAAUvT,MAAK,WACxBqS,EAAW,MACXC,EAAc,MACdF,EA3RO,cA4RP7P,cAAczJ,OAAO6a,cACrB7a,OAAO0a,gBAET,MACF,IAAK,qBAEH,MACF,IAAK,QACHpB,EAAYH,OAqBjB,CAACtT,IAKJ9E,qBAAU,WACR,GAAK8E,EAqOL,OAFAA,EAAWmD,GAAG,cAAeiK,GAEtB,WACLpN,EAAW1G,IAAI,cAAe8T,IAlOhC,SAASA,EAAiBtN,GACxB,GAAIA,EAAG,CACLD,EAAcC,GACdxE,QAAQC,IAAR,oCAAyCuE,EAAE8V,OAA3C,MAAuD9V,EAAEyN,MAEpCvN,EAAWxB,eAG9B,GAAIsB,EAAEyN,KAAKsI,cAAgBpX,QAAuB,gBAAbqB,EAAEyN,KAAKhP,KAAsB,CAEhE,IASMuX,EAAoB3b,OAAOyC,aAC/BzC,OAAOyC,aAAakD,EAAEyN,KACtBkE,EAAgB3R,EAAEyN,MAClB,IAAIwI,GAAc,EAId,GAAI5b,OAAOyC,aAAayD,QAAQyV,EAAkBzV,OAChD,CACE,IAAIsR,EAAY,WAChB,IAAK,IAAMlN,KAAOtK,OAAOyC,aAAayD,OAC/BlG,OAAOyC,aAAayD,OAAOoE,IAAMtK,OAAO6G,SACvC2Q,EAAYlN,GAGhBkN,GAAWxX,OAAO+F,SAClB/F,OAAO+F,OAASyR,EACVxX,OAAO+F,OAAOX,SAAS,KACvBpF,OAAOyX,SAAS,EACTzX,OAAO+F,OAAOX,SAAS,OAC9BpF,OAAOyX,SAAS,IAGnBzX,OAAOyC,aAAawD,UACnB4V,IAEJD,GAAc,EAyBlBD,EAAkB1V,WAAajG,OAAOyC,aAAawD,UACnD0V,EAAkBlV,eAAezG,OAAOyC,aAAagE,eAEjDmV,GAAgB,GAIpBA,KACGD,EAAkB1V,UAAYjG,OAAOyC,aAAawD,UAA2B,YAAfjG,OAAO+F,QAAqC,SAAf/F,OAAO+F,OACrGH,EAAiBC,EAAW,SArEfD,EAAiBC,IA6EA,GAA9B8V,EAAkB1V,UAAqD,GAAhCjG,OAAOyC,aAAawD,UAC3D4V,IAEmB,YAAf7b,OAAO+F,QAAqC,SAAf/F,OAAO+F,SAClC/F,OAAOyC,aAAayD,OAAOC,QAC5BnG,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOY,QACjC9G,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOa,QACjC/G,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOc,QACjChH,OAAOqV,YAAY,WACbrV,OAAOyC,aAAayD,OAAOG,QACjCrG,OAAOqV,YAAY,UACtBrV,OAAOsY,WAAWzS,EAAWxB,eAAeR,MAAMc,MAClD3E,OAAOuY,WAAW1S,EAAWxB,eAAeR,MAAMe,MAClDiB,EAAW+O,eAAc,GACzB/O,EAAWiP,eAAc,GACpB9U,OAAOiL,UACVyO,GAAe,GACfC,GAAe,MAKgB,GAA9BgC,EAAkB1V,UAAoD,GAAhCjG,OAAOyC,aAAawD,YAhHpD,mCAiHX6V,GACApC,GAAe,GACfC,GAAe,GACf3Z,OAAOqV,YAAY,MACfrV,OAAOsY,UACTzS,EAAW+O,eAAc,GAEvB5U,OAAOuY,UACT1S,EAAWiP,eAAc,SAK5BnP,EAAEyN,KAAKsI,cAAgBpX,QAAuB,gBAAbqB,EAAEyN,KAAKhP,MAAwBuB,EAAEyN,KAAKwF,WAAW/S,EAAWxB,eAAeR,MAAMuE,WACzHuN,EAAYhQ,EAAEyN,KAAK5H,OAAO7F,EAAEyN,KAAKjP,QAIlB,iBAARwB,EAAEyN,MACLpT,OAAOiL,SAAWjL,OAAOyC,aAAayF,SC3djD,SAAmBzF,EAAaoD,GACnC1E,QAAQC,IAAK,4BACbyE,EAAW6N,eAAejR,EAAc,KD0d5ByV,CAAUlY,OAAOyC,aAAaoD,GArIb,SAgJRgW,IAhJQ,2EAgJvB,sBAAAnK,EAAA,2DACU1R,OAAO+F,OADjB,OAEW,aAFX,OAoBW,iBApBX,MAqBW,iBArBX,OAoCW,WApCX,MAqCW,WArCX,MAsCW,WAtCX,MAuCW,WAvCX,MAwCW,WAxCX,MAyCW,WAzCX,MA0CW,WA1CX,MA2CW,WA3CX,6BAWU/F,OAAOsY,SAAWzS,EAAWwJ,aACzBrP,OAAOsY,SAZrB,gHAhJuB,kEA+MvB,sBAAA5G,EAAA,2FA/MuB,0BAoO5B,CAAC7L,IAEJ,IAMMkW,GAAW,CAAC9C,EAAeC,EAAcC,GAAa/T,SAC1DiU,GAawB,CAACH,EAAcC,GAAa/T,SAASiU,GAe/D,OAGE,yBAAK3W,UAAU,OACb,kBAAC2U,EAAoB2E,SAArB,CACAlc,MAAO,CAACsX,QAAS,CAAC3U,EAAa6U,KAE7B,kBAAC1O,EAAUoT,SAAX,CACAlc,MAAO,CAAC6I,QAAS,CAACoF,EAAGC,KAGnB+N,GAKA,kBAACvT,EAAkBwT,SAAnB,CAA4Blc,MAAO+F,GAEjC,kBAAC,EAAD,CAAM4P,QAASA,IACf,kBAAC,EAAD,CACEZ,YAAaA,EACbF,YAAaA,EACbY,iBAAkBiF,IAEnBxa,OAAOiL,SACV,kBAAC,EAAD,OAKA,kBAAC,EAAD,CAEEnI,QAAS,WACPgX,IAAa5S,MAAK,SAACyK,GAAD,OAASwI,EAAiBxI,Y,ME9nB3C,SAASsK,IACtB,OACE,uBAAG7D,MAAM,uBAAT,yEAEE,6BAFF,UAIE,uBAAG5H,KAAK,uCAAR,aAJF,wDCEJ0L,IAASC,OACPpH,IAAYC,mBAAmBoH,UAAY,kBAAC,EAAD,MAAU,kBAAC,EAAD,MACrDhP,SAASiP,eAAe,W","file":"static/js/main.35d6e3ce.chunk.js","sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport './Tile.css';\nfunction useForceUpdate(){\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => value + 1); // update the state to force render\n}\n\nfunction getTrackUnavailableMessage(kind, trackState) {\n  if (!trackState) return;\n  switch (trackState.state) {\n    case 'blocked':\n      if (trackState.blocked.byPermissions) {\n        return `${kind} permission denied`;\n      } else if (trackState.blocked.byDeviceMissing) {\n        return `${kind} device missing`;\n      }\n      return `${kind} blocked`;\n    case 'off':\n      if (trackState.off.byUser) {\n        return `${kind} muted`;\n      } else if (trackState.off.byBandwidth) {\n        return `${kind} muted to save bandwidth`;\n      }\n      return `${kind} off`;\n    case 'sendable':\n      return `${kind} not subscribed`;\n    case 'loading':\n      return `${kind} loading...`;\n    case 'interrupted':\n      return `${kind} interrupted`;\n    case 'playable':\n      return null;\n  }\n}\n\n/**\n * Props\n * - videoTrackState: DailyTrackState?\n * - audioTrackState: DailyTrackState?\n * - isLocalPerson: boolean\n * - isAudioOnly: boolean\n * - isLarge: boolean\n * - disableCornerMessage: boolean\n * - onClick: Function\n * -isScreenShare: boolean\n */\nexport default function Tile(props) {\n  const videoEl = useRef(null);\n  const audioEl = useRef(null);\n  const forceUpdate = useForceUpdate();\n\n  window.updateTile = () => {\n    forceUpdate();\n  }\n\n  const videoTrack = useMemo(() => {\n    return props.videoTrackState && props.videoTrackState.state === 'playable' && (props.isLocalPerson || props.videoTrackState.subscribed === true)\n      ? props.videoTrackState.track\n      : null;\n  }, [props.videoTrackState]);\n\n  const audioTrack = useMemo(() => {\n\n    if (!props.audioTrackState || !props.audioTrackState.track || props.audioTrackState.state !== 'playable' || props.audioTrackState.subscribed === false) \n        {return null;}\n    // if(props.disableCornerMessage) {console.log('Is a screen share');}\n    if (props.isAudioOnly) {\n      props.audioTrackState.track.isFiltered=true;\n    } else {props.audioTrackState.track.isFiltered=false;}\n    if (props.isScreenShare) {\n      props.audioTrackState.track.isScreenShare=true;\n    } else {props.audioTrackState.track.isScreenShare=false;}\n    return props.audioTrackState.track\n  }, [props.audioTrackState]);\n\n  const videoUnavailableMessage = useMemo(() => {\n    return getTrackUnavailableMessage('video', props.videoTrackState);\n  }, [props.videoTrackState]);\n\n  const audioUnavailableMessage = useMemo(() => {\n    return getTrackUnavailableMessage('audio', props.audioTrackState);\n  }, [props.audioTrackState]);\n\n  /**\n   * When video track changes, update video srcObject\n   */\n  useEffect(() => {\n    videoEl.current &&\n      (videoEl.current.srcObject = new MediaStream([videoTrack]));\n  }, [videoTrack]);\n\n  /**\n   * When audio track changes, update audio srcObject\n   */\n  useEffect(() => {\n    if(audioEl.current) {\n\n\n     ///////////////TODO START TEMP DELETED PORTION\n\n\n\n      if(audioTrack.isFiltered) {\n        console.log('**FILTERING LIVE TRACK**')\n\n          ///******audiocontext creation section///\n\n          //create audio stream\n          window.stream= new MediaStream([audioTrack]);\n\n          //workaround for bug in Chrome, see: https://bit.ly/3ryn1fW\n                window.mutedAudio = window.mutedAudio || new Audio(); \n                window.mutedAudio.muted = true;\n                if(!window.mutedAudio.srcObject) {window.mutedAudio.srcObject = window.stream;}\n                window.mutedAudio.paused && window.mutedAudio.play(); \n\n          //create Audio Context and destination\n          window.audioCtx = window.audioCtx || new (window.AudioContext || window.webkitAudioContext)();\n         window.audioSourceNode = window.audioCtx.createMediaStreamSource(window.stream);\n          if (typeof(window.destination)=='undefined'){window.destination = window.audioCtx.createMediaStreamDestination();}\n\n          //gain Node\n          if (typeof(window.gainNode)=='undefined') {window.gainNode = window.audioCtx.createGain();}\n          //panner Node\n          if (typeof(window.panNode)=='undefined') {window.panNode = window.audioCtx.createStereoPanner()}\n\n\n          //*****end audiocontext creation section\n\n\n              //adjust nodes\n              window.gainNode.gain.value=1;\n              window.panNode.pan.value=1;      \n              //Pipe source through nodes to destination\n            window.audioSourceNode.connect(window.gainNode).connect(window.panNode).connect(window.destination);\n\n            //Attach to the audio element\n          audioEl.current.srcObject = window.destination.stream;\n        \n      } \n      else if(audioTrack.isScreenShare) {\n\n        //for everyone, just piping the received audio (which was the left channel of the original video) straight through\n        console.log('***GETTING SCREENSHARE AUDIO')\n        ///***With audiocontext:  */\n        // window.audioSourceNode.connect(destination);\n\n\n        ///without Audiocontext:////\n        audioEl.current.srcObject = new MediaStream([audioTrack]);\n\n\n\n      }\n      else {      //For normal live tracks\n        console.log('***NOT FILTERING: LIVE TRACK***')\n\n         //Pipe source *straight* to destination, through audiocontext\n        // window.audioSourceNode.connect(gainNode).connect(destination);\n\n        //without audiocontext\n        audioEl.current.srcObject = new MediaStream([audioTrack]);\n\n      }\n\n      ///END TODO TEMP DELETED PORTION\n\n\n       //when above is deleted:\n      //  audioEl.current.srcObject = new MediaStream([audioTrack]);\n\n          \n\n\n     \n\n  \n\n      // for debugging\n      // window.destination=destination; \n      // window.audioTrack=audioTrack;\n      // window.audioEl = audioEl;\n\n      }\n      \n  }, [audioTrack,window.sessionState]);\n\n  function getVideoComponent() {\n    return videoTrack && <video autoPlay muted playsInline ref={videoEl} />;\n\n    \n  }\n\n  function getAudioComponent() {\n    return (\n      !props.isLocalPerson &&\n      audioTrack && <audio autoPlay playsInline ref={audioEl} > </audio>\n    );\n  }\n\n  function getOverlayComponent() {\n    // Show overlay when video is unavailable. Audio may be unavailable too.\n    return videoTrack && (\n      videoUnavailableMessage && (\n        <p className=\"overlay\">\n          {videoUnavailableMessage}\n          {/* {audioUnavailableMessage && (\n            <>\n              <br />\n              {audioUnavailableMessage}\n            </>\n          )} */}\n        </p>\n      )\n    );\n  }\n\n  function getCornerMessageComponent() {\n    // Show corner message when only audio is unavailable.\n    return (\n      !props.disableCornerMessage &&\n      audioUnavailableMessage &&\n      !videoUnavailableMessage && (\n        <p className=\"corner\">{audioUnavailableMessage}</p>\n      )\n    );\n  }\n\n  function getClassNames() {\n    let classNames = 'tile';\n    classNames += props.isLarge ? ' large' : ' small';\n    props.isLocalPerson && (classNames += ' local');\n    return classNames;\n  }\n\n  return (\n    ///TODO change to block : none\n    <div className={getClassNames()} onClick={props.onClick} style={{display: videoTrack ? \"block\" : \"none\"}}  >  \n      <div className=\"background\"/> \n      {getOverlayComponent()}\n      {getVideoComponent()}\n      {videoTrack && getCornerMessageComponent()}\n      {getAudioComponent()}\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default React.createContext();\n","import React from 'react';\n\nexport default React.createContext();\n","import React from 'react';\nimport './CallMessage.css';\n\n/**\n * Props:\n * - header: string\n * - detail: string\n * - isError: boolean\n */\nexport default function CallMessage(props) {\n  return (\n    <div className={'call-message' + (props.isError ? ' error' : '')}>\n      <p className=\"call-message-header\">{props.header}</p>\n      <p>{props.detail}</p>\n    </div>\n  );\n}\n","/**\n * Call state is comprised of:\n * - \"Call items\" (inputs to the call, i.e. participants or shared screens)\n * - UI state that depends on call items (for now, just whether to show \"click allow\" message)\n *\n * Call items are keyed by id:\n * - \"local\" for the current participant\n * - A session id for each remote participant\n * - \"<id>-screen\" for each shared screen\n */\nconst initialCallState = {\n  callItems: {\n    local: {\n      videoTrackState: null,\n      audioTrackState: null,\n    },\n  },\n  clickAllowTimeoutFired: false,\n  camOrMicError: null,\n  fatalError: null,\n};\n\n// --- Actions ---\n\n/**\n * CLICK_ALLOW_TIMEOUT action structure:\n * - type: string\n */\nconst CLICK_ALLOW_TIMEOUT = 'CLICK_ALLOW_TIMEOUT';\n\n/**\n * PARTICIPANTS_CHANGE action structure:\n * - type: string\n * - participants: Object (from Daily callObject.participants())\n */\nconst PARTICIPANTS_CHANGE = 'PARTICIPANTS_CHANGE';\n\n/**\n * CAM_OR_MIC_ERROR action structure:\n * - type: string\n * - message: string\n */\nconst CAM_OR_MIC_ERROR = 'CAM_OR_MIC_ERROR';\n\n/**\n * CAM_OR_MIC_ERROR action structure:\n * - type: string\n * - message: string\n */\nconst FATAL_ERROR = 'FATAL_ERROR';\n\n// --- Reducer and helpers --\n\nfunction callReducer(callState, action) {\n  switch (action.type) {\n    case CLICK_ALLOW_TIMEOUT:\n      return {\n        ...callState,\n        clickAllowTimeoutFired: true,\n      };\n    case PARTICIPANTS_CHANGE:\n      const callItems = getCallItems(action.participants);\n      return {\n        ...callState,\n        callItems,\n      };\n    case CAM_OR_MIC_ERROR:\n      return { ...callState, camOrMicError: action.message };\n    case FATAL_ERROR:\n      return { ...callState, fatalError: action.message };\n    default:\n      throw new Error();\n  }\n}\n\nfunction getLocalCallItem(callItems) {\n  return callItems['local'];\n}\n\nfunction getCallItems(participants) {\n  let callItems = { ...initialCallState.callItems }; // Ensure we *always* have a local participant\n  for (const [id, participant] of Object.entries(participants)) {\n\n    \n      callItems[id] = {\n        videoTrackState: participant.tracks.video,\n        audioTrackState: participant.tracks.audio,\n      };\n    \n    \n    if (shouldIncludeScreenCallItem(participant)) {\n      callItems[id + '-screen'] = {\n        videoTrackState: participant.tracks.screenVideo,\n        audioTrackState: participant.tracks.screenAudio,\n      };\n    }\n  }\n  return callItems;\n}\n\nfunction shouldIncludeScreenCallItem(participant) {\n  const trackStatesForInclusion = ['loading', 'playable', 'interrupted'];\n  return (\n    trackStatesForInclusion.includes(participant.tracks.screenVideo.state) ||\n    trackStatesForInclusion.includes(participant.tracks.screenAudio.state)\n  );\n}\n\n// --- Derived data ---\n\n// True if id corresponds to local participant (*not* their screen share)\nfunction isLocal(id) {\n  return id === 'local';\n}\n\nfunction isScreenShare(id) {\n  return id.endsWith('-screen');\n}\n\nfunction containsScreenShare(callItems) {\n  return Object.keys(callItems).some((id) => isScreenShare(id));\n}\n\nfunction getMessage(callState) {\n  function shouldShowClickAllow() {\n    const localCallItem = getLocalCallItem(callState.callItems);\n    const hasLoaded = localCallItem && !localCallItem.isLoading;\n    return !hasLoaded && callState.clickAllowTimeoutFired;\n  }\n\n  let header = null;\n  let detail = null;\n  let isError = false;\n  if (callState.fatalError) {\n    header = `Fatal error: ${callState.fatalError}`;\n    isError = true;\n  } else if (callState.camOrMicError) {\n    // header = `Camera or mic access error: ${callState.camOrMicError}`;\n    header = `Error: This page can't access your camera or mic.`;\n    detail =\n      \"To troubleshoot in Chrome: To the right in your address bar, click the picture of the camera and select 'Always allow.' Hit enter and then refresh this page.\"\n      // 'See https://help.daily.co/en/articles/2528184-unblock-camera-mic-access-on-a-computer to troubleshoot.';\n    isError = true;\n  } else if (shouldShowClickAllow()) {\n    header = 'Click \"Allow\" to enable camera and mic access';\n  } else if (Object.keys(callState.callItems).length === 1) {\n    header = \"You're here!  \";\n    detail = \"Waiting for everyone else...\"\n    // if(window.myName) {\n    //   detail = window.location.href.substring(0, window.location.href.indexOf(window.myName)-3);\n    // } else {detail = window.location.href}\n    \n  }\n  return header || detail ? { header, detail, isError } : null;\n}\n\nexport {\n  initialCallState,\n  CLICK_ALLOW_TIMEOUT,\n  PARTICIPANTS_CHANGE,\n  CAM_OR_MIC_ERROR,\n  FATAL_ERROR,\n  callReducer,\n  isLocal,\n  isScreenShare,\n  containsScreenShare,\n  getMessage,\n};\n","export function logDailyEvent(e) {\n  console.log('[daily.co event]', e.action);\n}\n","// import { useEffect } from \"react\";\n// import SessionContext from '../../SessionContext';\n\nexport default function setSubscriptions(callObject,viewMode=null) {\n\n    if (!window.sessionState) {return;}\n\n    console.log('Setting subscriptions...');\n    console.log('****My role is: ' + window.myRole);\n    console.log('viewMode is: ' + viewMode);\n    let subscribedTo=0;\n    window.currentSubs=[];\n    window.viewMode = viewMode;\n    \n    //if session is active, set currentSubs according to my role\n        if (!viewMode && window.sessionState.isActive) {\n            switch (window.myRole) {\n                case 'Buyer1':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Buyer2':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Buyer3':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    break;\n                case 'Seller':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Shadow1':\n                case 'Shadow2':\n                case 'Shadow3':\n                case 'Shadow4':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller+'_AUDIO');\n                    break;\n                case 'Attendee':\n                    window.currentSubs=[];\n                    break;\n                default:\n                    window.currentSubs=[];\n                    break;\n            }\n            //Add Admin to currentSubs if applicable\n            if (window.sessionState.AdminVisible) {\n            window.currentSubs.push (\"Admin\");\n        }\n\n        window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n\n    }\n\n    if(viewMode) {\n\n        switch (viewMode) {\n            case 'Seller':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow1':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow2':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow2 && window.currentSubs.push(window.sessionState.roleOf.Shadow2);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow3':\n                window.sessionState.roleOf.Shadow3 && window.currentSubs.push(window.sessionState.roleOf.Shadow3);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow4':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow4 && window.currentSubs.push(window.sessionState.roleOf.Shadow4);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'All':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller);\n                window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1);\n                window.sessionState.roleOf.Shadow2 && window.currentSubs.push(window.sessionState.roleOf.Shadow2);\n                window.sessionState.roleOf.Shadow3 && window.currentSubs.push(window.sessionState.roleOf.Shadow3);\n                window.sessionState.roleOf.Shadow4 && window.currentSubs.push(window.sessionState.roleOf.Shadow4);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            default:\n                window.currentSubs=[];\n                break;\n        }\n\n        window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n    }\n\n    \n    function setTracks() {\n\n        return new Promise( (resolve) => {\n\n            //cycle through each participant in meeting\n            let ps = callObject.participants();\n            // console.log('The second participant is named: ' + Object.values(ps)[1].user_name);\n            Object.keys(ps).forEach((p) => {\n                let participant = ps[p];\n                let thisUserName = participant.user_name;\n\n                if (p === 'local' || thisUserName==window.myName) {\n                    return;\n                } \n\n    \n\n                //if SESSION STATE NOT KNOWN, don't subscribe to anyone yet\n                if (!window.sessionState.isKnown) {\n                    callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    return;\n                }\n\n\n\n                console.log(\"This username is: \" +thisUserName);\n                //If NOT ACTIVE (and not setting view mode), subscribe to everyone in the meeting\n                if (!window.sessionState.isActive && !viewMode) {\n\n                    //audio only if currently Seconding\n                    // if (window.myRole.includes('Actor')) {\n                    //     switch (window.myRole) {\n                    //         case 'Actor1':\n                    //                 if (thisUserName==window.sessionState.roleOf.Participant1 || thisUserName=='SUPERDUPER') {\n                    //                     console.log('Subscribing to audio only for: ' + thisUserName);\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n                    //                 } else {\n                    //                     console.log('Subscribing to: ' + thisUserName);\n                    //                     window.currentSubs.push(thisUserName);\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                    //                     subscribedTo++;\n                    //                 }\n                    //             break;\n                    //         case 'Actor2':\n                    //             if (thisUserName==window.sessionState.roleOf.Participant2 || thisUserName=='SUPERDUPER') {\n                    //                 console.log('Subscribing to audio only for: ' + thisUserName);\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n                    //             } else {\n                    //                 console.log('Subscribing to: ' + thisUserName);\n                    //                 window.currentSubs.push(thisUserName);\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                    //                 subscribedTo++;\n                    //             }\n                    //         break;\n                        \n                    //         default:\n                    //             break;\n                    //     }\n                    // }\n\n                    // // audio and video for everyone else\n                    // else {  \n                        // exclude screenshare's in-ear audio stream\n\n                        if (thisUserName=='SUPERDUPER') {\n                            console.log('Not subscribing to: ' + thisUserName);\n                            callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: false, video: false, screenVideo: true, screenAudio: true}});\n\n                        \n                        } else {\n                            console.log('Subscribing to: ' + thisUserName);\n                            window.currentSubs.push(thisUserName);\n                            // if (!callObject.participants()[participant.session_id].tracks.video.subscribed){ \n                            //     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});  \n                            // }\n                            callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                            subscribedTo++;\n                            }    \n\n                    // }\n\n\n\n                } \n\n                //IF ACTIVE (or selecting viewmode), just subscribe to those listed in currentSubs;\n                else if (window.sessionState.isActive || viewMode) {\n                    if(window.currentSubs.includes(thisUserName+'_AUDIO')) {\n                        console.log('Subscribing to audio only for: ' + thisUserName);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: false}});\n                    }\n                    else if(window.currentSubs.includes(thisUserName)) {\n                        console.log('Subscribing to: ' + thisUserName);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                        subscribedTo++;\n                    }\n                    else if (!window.currentSubs.includes(thisUserName)) {\n                        console.log('NOT subscribing to: ' + thisUserName + ', sessionID: ' + participant.session_id);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    }\n                }\n            });\n            resolve();\n        })\n    }\n    \n    setTracks().then(()=>{\n        \n        //remove screenshare widget from currentSubs array\n        const index = window.currentSubs.indexOf('SUPERDUPER');\n        if (index > -1) {\n          window.currentSubs.splice(index, 1);\n        }\n    //print subscriptions\n\n    window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n\n    var iterator = window.currentSubs.values();\n    console.log(\"Currently subscribed to:\");\n    for (let elements of iterator) { \n        console.log(elements); \n    } \n    if (window.currentSubs.length < 1) {\n        console.log (\"No one.\")\n    }\n    window.updateCall();\n    viewMode=null;\n    window.updateTray();\n    window.updateTile();\n\n\n        //if no admin (or admin has left), start asking for state\n        // if (adminPresent==false) {\n        //     window.sessionState.isKnown=false;\n        //     if (typeof(stateRequest)!='undefined') {clearInterval(stateRequest);}\n        //     stateRequest = setInterval(getState,2500);\n        //     console.log('no Admin present');\n        // }\n        // if (subscribedTo==0) {\n        //     window.isPopulated = false;\n        //     document.getElementById('empty-room').style.opacity='1';\n        //     if(!!document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='hidden';}\n        //     if (window.sessionState.isActive==true) {\n        //         document.getElementById('empty-text').innerHTML=\"Hold that thought!  <br><br> We're working to fix a connection problem.\"\n        //     } else if (window.sessionState.isActive==false) {\n        //         document.getElementById('empty-text').innerHTML=\" <br>You're here!<br>Waiting for everyone else...\"\n\n        //     }\n        // } else if (subscribedTo>0) {\n        //     window.isPopulated = true;\n        //     document.getElementById('empty-room').style.opacity='0';\n        //     if (document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){\n        //         document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='visible';\n        //     }\n\n        // }\n\n    })\n\n    \n   \n};\n\n","import React, { useEffect, useContext, useReducer, useCallback, useState } from 'react';\nimport './Call.css';\nimport Tile from '../Tile/Tile';\nimport CallObjectContext from '../../CallObjectContext';\nimport MyContext from '../../MyContext';\n// import SessionContext from '../../SessionContext';\nimport CallMessage from '../CallMessage/CallMessage';\nimport {\n  initialCallState,\n  CLICK_ALLOW_TIMEOUT,\n  PARTICIPANTS_CHANGE,\n  CAM_OR_MIC_ERROR,\n  FATAL_ERROR,\n  callReducer,\n  isLocal,\n  isScreenShare,\n  containsScreenShare,\n  getMessage,\n} from './callState';\nimport { logDailyEvent } from '../../logUtils';\nimport setSubscriptions from '../../hooks/setSubscriptions';\nfunction useForceUpdate(){\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => value + 1); // update the state to force render\n}\n\nexport default function Call() {\n  const callObject = useContext(CallObjectContext);\n  // const [ sessionState, setSessionState ] = useContext(SessionContext);\n  // const [ myInfo, setMyInfo ] = useContext(MyInfoContext);\n  const [callState, dispatch] = useReducer(callReducer, initialCallState);\n  const forceUpdate = useForceUpdate();\n  const { myState } = useContext(MyContext);\n  const [ my,setMy] = myState;\n\n\n  window.updateCall = () => {\n    forceUpdate();\n  }\n\n  /**\n   * Start listening for participant changes, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    const events = [\n      'participant-joined',\n      'participant-updated',\n      'participant-left',\n    ];\n\n   \n\n    function handleNewParticipantsState(e) {\n      e && logDailyEvent(e);\n      dispatch({\n        type: PARTICIPANTS_CHANGE,\n        participants: callObject.participants(),\n      });\n      if(e && e.action!='participant-updated') {\n        setSubscriptions(callObject);\n        console.log(\"setting subscriptions because: \" + e.action);\n          \n          let thisUserName = e.participant.user_name;\n          let thisSessionID = e.participant.session_id;\n\n          if (e.action==\"participant-joined\" || e.action==\"participant-left\") {\n            window.event=e;\n            updateUserList();\n          }\n\n          function updateUserList() {\n\n            const getUserName = setInterval(\n              ()=>{\n                    if (thisUserName) \n                      {getUserList();\n                      clearInterval(getUserName);\n                      }\n                  },100);\n\n              function getUserList() {\n                window.adminPresent=false;\n              let ps=callObject.participants(); \n              window.userList=[]; \n              for (const p in ps) {\n                let thisUserName = ps[p].user_name;\n                let thisSessionId = ps[p].session_id;\n                window.userList.push(thisUserName);      //add  each user_name to UserList\n                window[thisUserName+'_SessionID'] = thisSessionId;\n                if (thisUserName.includes('_Admin') && p!=='local') {\n                  window.adminPresent=true;\n                }\n              }; \n              window.userList.sort();       //alphebetize that list \n\n              console.log(`now the userList is: ${window.userList}`);  //print userList\n\n              if(typeof(window.updateAdminPanel)!=='undefined') {window.updateAdminPanel()};\n              }\n              \n            }\n\n          \n\n          console.log('Admin present: ' + window.adminPresent);\n          console.log('UserList: ' + window.userList);\n      }\n      \n    }\n\n    \n\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    for (const event of events) {\n      callObject.on(event, handleNewParticipantsState);\n      // callObject.on(\"joined-meeting\",()=>{\n\n      //     callObject.setUserName('testName');\n      //     console.log(`********Setting my user name as ${'TestName'}`);\n\n      // })\n    }\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, handleNewParticipantsState);\n      }\n    };\n  }, [callObject]);\n\n  /**\n   * Start listening for call errors, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleCameraErrorEvent(event) {\n      logDailyEvent(event);\n      dispatch({\n        type: CAM_OR_MIC_ERROR,\n        message:\n          (event && event.errorMsg && event.errorMsg.errorMsg) || 'Unknown',\n      });\n    }\n\n    // We're making an assumption here: there is no camera error when callObject\n    // is first assigned.\n\n    callObject.on('camera-error', handleCameraErrorEvent);\n\n    return function cleanup() {\n      callObject.off('camera-error', handleCameraErrorEvent);\n    };\n  }, [callObject]);\n\n  /**\n   * Start listening for fatal errors, when the callObject is set.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleErrorEvent(e) {\n      logDailyEvent(e);\n      dispatch({\n        type: FATAL_ERROR,\n        message: (e && e.errorMsg) || 'Unknown',\n      });\n    }\n\n    // We're making an assumption here: there is no error when callObject is\n    // first assigned.\n\n    callObject.on('error', handleErrorEvent);\n\n    return function cleanup() {\n      callObject.off('error', handleErrorEvent);\n    };\n  }, [callObject]);\n\n  /**\n   * Start a timer to show the \"click allow\" message, when the component mounts.\n   */\n  useEffect(() => {\n    const t = setTimeout(() => {\n      dispatch({ type: CLICK_ALLOW_TIMEOUT });\n    }, 2500);\n\n    return function cleanup() {\n      clearTimeout(t);\n    };\n  }, []);\n\n  const numberOfSubs = window.currentSubs && window.currentSubs.filter(function (str) {return str.indexOf('_AUDIO') === -1}).filter(function (str) {return str.indexOf('_AUDIO') === -1}).filter(function (str) {return str.indexOf(window.myName) === -1}).length //number of subs, not counting audio-only or my name\n\n\n  useEffect(()=>{\nwindow.numberOfSubs =numberOfSubs;\n  },[numberOfSubs])\n\n\n\n \n\n  function getTiles() {\n    let largeTiles = [];\n    let smallTiles = [];\n    Object.entries(callState.callItems).forEach(([id, callItem]) => {\n\n\n      const isAudioOnly = () => {\n        if(!callItem.audioTrackState || !callItem.videoTrackState) {return}\n        return (callItem.audioTrackState.subscribed && !callItem.videoTrackState.subscribed);\n      }\n\n      const isLarge =\n        isScreenShare(id) ||\n        (!isLocal(id) && !containsScreenShare(callState.callItems)) \n        || (isLocal(id) && numberOfSubs && numberOfSubs>1 && !containsScreenShare(callState.callItems))   //videoTrackState()\n\n        \n      const tile = (\n        <Tile\n          key={id}\n          videoTrackState={callItem.videoTrackState}\n          audioTrackState={callItem.audioTrackState}\n          isLocalPerson={isLocal(id)}\n          isAudioOnly={isAudioOnly()}\n          isLarge={isLarge}\n          disableCornerMessage={isScreenShare(id)}\n          isScreenShare={isScreenShare(id)}\n          // onClick={\n          //   isLocal(id)\n          //     ? null\n          //     : () => {\n          //         sendHello(id);\n          //       }\n          // }\n        />\n      );\n      if (isLarge) {\n        largeTiles.push(tile);\n      } else {\n        smallTiles.push(tile);\n      }\n    });\n    \n    return [largeTiles, smallTiles];\n  }\n\n  const [largeTiles, smallTiles] = getTiles();\n\n  \n  /**\n   * DELETE: Attached tiles objects to window for debugging purposes.\n   */\n  useEffect(() => {\n    // console.log('re-rendered');\n    // console.log('Userlist: ' + window.userList);\n    window.largeTiles = largeTiles;\n    window.smallTales = smallTiles;\n    window.add = function(n=1) {\n      for(let i=0;i<n;i++) {\n        callObject.addFakeParticipant()\n      }\n    };\n    \n  }); \n\n\n   // attach callState to window for debugging\n   useEffect(() => {\n    window.callState = callState;\n  }, [callState]); \n\n\n  const message = getMessage(callState);\n  return (\n    <div className={window.amAdmin ? \"call-with-sidebar\" : \"call\"}>\n                                      {/* add # of tiles to class name. alternative: {largeTiles.length}*/}\n      <div className={`large-tiles count-${(containsScreenShare(callState.callItems)&&'1')||numberOfSubs && numberOfSubs+1}`}>   \n        {\n          !message\n            ? largeTiles\n            : null /* Avoid showing large tiles to make room for the message */\n        }\n      </div>\n      <div className=\"small-tiles\">{smallTiles}</div>\n      {message && (\n        <CallMessage\n          header={message.header}\n          detail={message.detail}\n          isError={message.isError}\n        />\n      )}\n    </div>\n  );\n}\n","import React, { useContext, useEffect, useState } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport './InputSelector.css';\n\n\nexport default React.forwardRef((props, ref)=> {\nconst callObject = useContext(CallObjectContext);\nconst audioInputSelect = React.createRef();\nconst videoSelect = React.createRef();\nconst type = props.type;\nconst page = props.page;\n\n\nconst handleClick=(e) => {\n    if(!e.target.value) {return;}\n    let selectionID = e.target.value;\n    type == 'audio' && page=='main' && e.target.key.includes('audioinput') && callObject.setInputDevicesAsync({audioSource: selectionID});\n    // type == 'audio' && page=='main' && e.target.key.includes('audiooutput') && callObject.setOutputDevice({selectionID});\n    type == 'video' && page=='main' && callObject.setInputDevicesAsync({videoSource: selectionID});\n    if (type == 'audio' && page=='intro') {\n        const [initialInputs,setInitialInputs] = props.inputs;\n        let constraints = {\n            deviceId: { exact: selectionID }\n        };\n        navigator.mediaDevices.getUserMedia({audio: constraints}).then(\n            (mediaStream)=> {\n            let newAudioSource = mediaStream.getAudioTracks()[0];\n            setInitialInputs((prev)=>[newAudioSource,prev[1]]);\n            });\n    }\n    if (type == 'video' && page=='intro') {\n        const [initialInputs,setInitialInputs] = props.inputs;\n        let constraints = {\n            width: 1280,\n            height: 720,\n            deviceId: { \n                exact: selectionID ,\n            },\n        };\n        navigator.mediaDevices.getUserMedia({video: constraints}).then(\n            (mediaStream)=> {\n            let newVideoSource = mediaStream.getVideoTracks()[0];\n            setInitialInputs((prev)=>[prev[0],newVideoSource])\n            });\n    }   \n    e.target.key.includes('input') && console.log('New input: ' + e.target.text);\n    // e.target.key.includes('output') && console.log('New output: ' + e.target.text);\n}\n\nuseEffect(()=>{ \n    if(navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n        navigator.mediaDevices.enumerateDevices()\n        .then(function(deviceInfos) {\n            \n            if (type=='audio' && audioInputSelect.current) {\n                if (audioInputSelect.current.hasChildNodes()) {return}\n                let audioInputs = [];\n                let audioOutputs = [];\n\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                if (deviceInfo.kind === 'audioinput') {\n                    option.key = 'audioinput' + audioInputSelect.length + 1;\n                    option.text = deviceInfo.label ||'Microphone ' + (audioInputSelect.length + 1);\n                    audioInputs.push(option); \n                } \n                // else if (deviceInfo.kind === 'audiooutput') {\n                //     option.key = 'audiooutput' + audioInputSelect.length + 1;\n                //     option.text = deviceInfo.label || 'Speaker ' +(audioInputSelect.length + 1);\n                //     audioOutputs.push(option);\n                //     }   \n                }\n                window.audioOutputs=audioOutputs;\n                let micHeading = document.createElement('option');\n                micHeading.label = '-Select Microphone-';\n                micHeading.className='item-heading';\n                let speakerHeading = document.createElement('option');\n                // speakerHeading.label = '-Select Speaker-';\n                // speakerHeading.className='item-heading';\n                audioInputSelect.current.appendChild(micHeading);\n                for (var i=0; i!==audioInputs.length; ++i) {\n                    audioInputSelect.current.appendChild(audioInputs[i]);\n                }\n\n                // audioInputSelect.current.appendChild(speakerHeading);\n                // for (var i=0; i!==audioOutputs.length; ++i) {\n                //     console.log(audioOutputs[i]);\n                //     audioInputSelect.current.appendChild(audioOutputs[i]);\n                // }\n               \n                \n                   \n            }\n            else if (type == 'video' && videoSelect.current) {\n                if (videoSelect.current.hasChildNodes()) {return}\n                let camHeading = document.createElement('option');\n                camHeading.label = '-Select Camera-';\n                camHeading.className='item-heading';\n                videoSelect.current.appendChild(camHeading);\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var option = document.createElement('option');\n                    option.className='item';\n                    option.value = deviceInfo.deviceId;\n                    if (deviceInfo.kind === 'videoinput') {\n                        option.key = 'videooutput' + videoSelect.length + 1;\n                        option.text = deviceInfo.label || 'Camera ' +(videoSelect.length + 1);\n                        videoSelect.current && videoSelect.current.appendChild(option);\n                    }\n                }\n            }\n        })\n        .catch(function(err) {\n          console.log(err.name + \": \" + err.message);\n        });\n       } \n})\n   \n    \n\n\n\n    return (\n        <div className=\"dropdown-selector\" ref={ref}>\n                {type=='audio' &&\n                <ul ref={audioInputSelect} onClick={handleClick}>\n                </ul>\n                }\n                {type=='video' &&\n                <ul ref={videoSelect} onClick={handleClick}>\n                </ul>\n                }\n                \n        </div>\n    );\n\n})\n","import React, { useEffect, useRef, useContext, useState } from 'react';\nimport './StartScreen.css';\nimport InputSelector from '../InputSelector/InputSelector';\nimport MyContext from '../../MyContext';\n\n\n\n//   if (parent.myRole=='Actor') {\n//     document.getElementById('instructions').remove();\n//     document.getElementById('actor-instructions').style.visibility='visible';\n//     let qrCode = '../images/Audio' + parent.myNumber + '.png';\n//     document.getElementById('QR-code').src=qrCode;\n//   }\n\n\n/**\n * Props:\n * -\n * -\n */\n export default function StartScreen(props) {\n    const { myState } = useContext(MyContext);\n    const [ my,setMy] = myState;\n    const userIDEl = useRef(null);\n    const [showMicSettings,setShowMicSettings] = useState(false);\n    const [showCamSettings,setShowCamSettings] = useState(false);\n    const begin = props.onClick;\n    // const [ myInfo, setMyInfo ] = useContext(MyInfoContext);\n    // const [ userID, setUserID ] = useState('Your first name');\n    const lobbyVideo = useRef(null);\n    const micCaret = React.createRef();\n    const micSettings = React.createRef();\n    const camCaret = React.createRef();\n    const camSettings = React.createRef();\n    const [initialInputs,setInitialInputs] = useState(null);\n    const [hasUserMedia,setHasUserMedia] = useState(true);\n  \n\n    useEffect(()=> {\n\n      document.addEventListener(\"mousedown\", handleClickOutside);\n      ///temp\n      window.testMy = my;\n  \n  \n   return function cleanup() {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n      };\n    })\n\n    const handleClickOutside = (event) => {\n      console.log('handling click');\n      if (micSettings.current &&\n        !micSettings.current.contains(event.target) &&\n        !micCaret.current.contains(event.target)\n      ) {\n        setShowMicSettings(false);\n      } else if (camSettings.current &&\n        !camSettings.current.contains(event.target) &&\n        !camCaret.current.contains(event.target)\n      ) {\n        setShowCamSettings(false);\n      } \n      \n    }\n \n    \n\n\n  function setMyName() {\n      console.log('setting user ID as ' + my.name);\n      if (my.name === '' || my.name==='Your first name' || my.name.length<=1) {\n        alert('Please enter your name to help your partner identify you.')\n      } else {\n        my.name = window.myRole === 'Admin' ? my.name + '_Admin' : my.name;\n        window.myName = my.name;\n        begin();\n      }\n  }\nuseEffect(()=>{\n  navigator.mediaDevices.getUserMedia({audio:true,video:{width: 1280,height: 720}}).then((mediaStream)=>{\n    if(mediaStream){\n      window.mediaStream = mediaStream;\n      let localAudio = mediaStream.getAudioTracks()[0];\n      let localVideo = mediaStream.getVideoTracks()[0];  \n      setInitialInputs([localAudio,localVideo]);\n      window.localAudio=localAudio;\n      setHasUserMedia(true);\n    } else {\n      setHasUserMedia(false);\n    }\n  }).catch( err => {\n    console.log(\"You got an error:\" + err);\n    setHasUserMedia(false);\n});\n\n}\n\n,[])\n\nuseEffect(()=>{\n  initialInputs && lobbyVideo.current && (lobbyVideo.current.srcObject=new MediaStream(initialInputs));\n  lobbyVideo.current.muted=true;\n  window.initialInputs=initialInputs;\n},[initialInputs]);\n    \n\n        // if(localAudio && localAudio.length > 0)\n        //     {\n        //       newCallObject.join({ url, userName:window.myName, audioSource: localSrc[0]});\n        //     }\n        //     else {}:\n\n  \n  const handleChange = e => {\n    // setUserID(e.target.value);\n    // window.userID=userID;\n    let newName = e.target.value;\n    setMy((prevState)=>({\n                          ...prevState,\n                          name: newName,\n                        })\n          );\n}\n\n\n    return (\n    <div className='container'>\n\n        <div className='start-screen-background'></div>\n  \n        <div className='instructions'> \n            <div className='fixed-width'>\n          \n                <h2>Welcome to SecondBody.</h2>\n\n               \n\n                <div style={{position:'relative', marginLeft:'180px', marginRight:'180px', padding: '20px', paddingTop:'40px', border: '4px solid whitesmoke', backgroundColor:'white'}}>\n                      <div style={{background:'white',opacity:'1',zIndex:'1000'}}>\n                      \n                      \n                {hasUserMedia ? \n\n                    <video className='lobby-video' autoPlay={true} ref={lobbyVideo}/>\n                    :\n                    <p style={{height:'198px',width:'352px',borderRadius:'20px',background:'black',margin:'auto',color:'white',fontWeight:'bolder', boxSizing:'border-box',padding:'24px',border:'2px yellow solid'}}>\n                     Your camera / mic is blocked <br/><br/>Please give this site access to your camera and mic, and then <u style={{cursor:'pointer'}} onClick={(()=>{window.location.reload()})}>refresh the page.</u>\n                    <br/><br/>\n                    How?\n                    <br/>\n                    <ul>\n                      <li>\n                          <a target='_blank' href='https://downloads.intercomcdn.com/i/o/193872927/17dc7d06694d2c9bcd47b17a/Web+Meeting+Permissions+Blocked+Modal.jpg?'>\n                          Option 1\n                          </a>\n                      </li>\n                      <li>\n                          <a href={'https://youtu.be/GceAjizU5WU?t=39'}  target='_blank'>Option 2</a>\n                      </li>\n                      </ul>\n                      </p>\n                  }\n                      \n                      \n\n             {/* <img src={Unblock} style={{width:'100px'}} /> */}\n                      \n                      \n                      {lobbyVideo.current && hasUserMedia && (\n                          <div style={{position:'relative',display:'flex',flexDirection:'row',justifyContent:'center',bottom:'40px', width:'250px',height:'0px',margin:'auto'}}>\n                              <div >\n                                <p className=\"selector-button\" onClick={()=>{setShowCamSettings(!showCamSettings)}} ref={camCaret}>Select Camera ^</p>\n                                    {showCamSettings ? \n                                    (<div onClick={()=>setShowCamSettings(false)}style={{position:'relative',bottom:'0px',left:'80px'}}>\n                                      <InputSelector type='video' page='intro' inputs={[initialInputs,setInitialInputs]} ref={camSettings} />\n                                    </div>)\n                                    : \n                                    null}\n                              </div>\n                              <div style={{width:'15px'}}></div>\n\n                              <div>\n                                <p className=\"selector-button\" onClick={()=>{setShowMicSettings(!showMicSettings)}} ref={micCaret}>Select Mic ^</p>\n                                    {showMicSettings ? \n                                      (<div onClick={()=>setShowMicSettings(false)} style={{position:'relative',bottom:'0px',left:'72px',overflowY:'visible'}}>\n                                        <InputSelector type='audio' page='intro' ref={micSettings}  inputs={[initialInputs,setInitialInputs]}/>\n                                      </div>)\n                                    : \n                                    null}\n                              </div>\n                          </div>\n                      )}\n\n                  </div>\n                    \n                 { hasUserMedia && (\n                    <h4 className='signin'>\n            \n                        <form onSubmit={(e)=>e.preventDefault()}>\n                            <input type=\"text\" autoComplete=\"off\" style={{backgroundColor: 'rgb(230, 240, 249)', fontSize:'15px', width: '200px', height: '30px', textAlign:'center', fontFamily:'poppins'}} ref={userIDEl} value={my.name} onFocus={()=> {if (my.name==='Your first name') {setMy((prevState)=>({...prevState,name: '',}));}}} onChange={e=>handleChange(e)} /><br/><br/>\n                            <input className='new-card' style={{width:'150px', color:'#1b8bc4', fontSize: '17px'}} type=\"submit\" type=\"submit\" value='Enter session' onClick={setMyName} />\n                        </form>\n\n                        <br/>\n                    </h4>\n                  )}\n                    \n                </div>\n        \n  \n            </div>\n        </div>\n  \n    \n  \n       \n    </div>\n    );\n  }\n\n              \n                \n\n\n\n\n","const newRoomEndpoint =\n  '`${window.location.origin}/api/rooms`';\n\n/**\n * Create a short-lived room for demo purposes.\n *\n * It uses the redirect proxy as specified in netlify.toml`\n * This will work locally if you following the Netlify specific instructions\n * in README.md\n *\n * See https://docs.daily.co/reference#create-room for more information on how\n * to use the Daily REST API to create rooms and what options are available. \n */\nasync function createRoom() {\n\n  // const exp = Math.round(Date.now() / 1000) + 60 * 30;\n  // const options = {\n  //   properties: {\n  //     exp: exp,\n  //     enable_recording: true,\n  //   },\n  // };\n  // let response = await fetch(newRoomEndpoint, {\n  //   method: \"POST\",\n  //   body: JSON.stringify(options),\n  //   mode: 'cors',\n  // }),\n  //   room = await response.json();\n  // return room;\n\n  // Comment out the above and uncomment the below, using your own URL\n  return { url: \"https://secondbody.daily.co/react-test-room\" };\n}\n\nexport default { createRoom };","import React from 'react';\n\nconst TYPE_MUTE_CAMERA = 'camera';\nconst TYPE_MUTE_MIC = 'mute-mic';\nconst TYPE_SCREEN = 'screen';\nconst TYPE_LEAVE = 'leave';\nconst TYPE_CHAT = 'chat';\n\n/**\n * Props:\n * - type: string\n * - highlighted: boolean\n */\nexport default function Icon(props) {\n  function getFillColor() {\n    return props.highlighted ? '#fb5554' : '#000000';\n  }\n\n  function getPath() {\n    switch (props.type) {\n      case TYPE_MUTE_CAMERA:\n        return (\n          <g\n            id=\"Symbols\"\n            stroke=\"none\"\n            strokeWidth=\"1\"\n            fill=\"none\"\n            fillRule=\"evenodd\"\n          >\n            <g\n              id=\"Assets-for-Export\"\n              transform=\"translate(-24.000000, 0.000000)\"\n              fill={getFillColor()}\n            >\n              <g\n                id=\"Icon-Camera-Off-24px\"\n                transform=\"translate(24.000000, 0.000000)\"\n              >\n                <path\n                  d=\"M13.7573593,6 L4.00585866,6 C2.89706013,6 2,6.8992496 2,8.0085302 L2,15.9914698 C2,16.4835828 2.17760958,16.9352259 2.47229113,17.2850682 L13.7573593,6 Z M16,12.2426407 L16,15.9914698 C16,17.1007504 15.1029399,18 13.9941413,18 L10.2426407,18 L16,12.2426407 Z M16,12.2426407 L16,14.499966 L21.0756492,16.6148096 C21.586154,16.8275189 22,16.5442917 22,16.0045612 L22,7.99539512 C22,7.44565489 21.5875957,7.17183667 21.0756492,7.38514669 L20.7016702,7.54097052 L16,12.2426407 Z M20.4877316,2.09805481 C20.8769027,1.70888376 21.506248,1.70725811 21.8994949,2.10050506 C22.2900192,2.49102936 22.2956069,3.1186067 21.9019452,3.51226838 L3.51226838,21.9019452 C3.12309732,22.2911162 2.49375202,22.2927419 2.10050506,21.8994949 C1.70998077,21.5089706 1.70439313,20.8813933 2.09805481,20.4877316 L20.4877316,2.09805481 Z\"\n                  id=\"Combined-Shape\"\n                ></path>\n              </g>\n            </g>\n          </g>\n        );\n      case TYPE_MUTE_MIC:\n        return (\n          <g\n            id=\"Symbols\"\n            stroke=\"none\"\n            strokeWidth=\"1\"\n            fill=\"none\"\n            fillRule=\"evenodd\"\n          >\n            <g\n              id=\"Assets-for-Export\"\n              transform=\"translate(-120.000000, 0.000000)\"\n              fill={getFillColor()}\n            >\n              <g\n                id=\"Icon-Microphone-Off-24px\"\n                transform=\"translate(120.000000, 0.000000)\"\n              >\n                <path\n                  d=\"M15.8931049,12.3495358 L15.8883757,12.354265 C15.7702192,12.7237203 15.5976472,13.0928313 15.3634551,13.4334743 C14.9080287,14.0959127 14.281481,14.5761112 13.4232304,14.8194102 L11,17.2426407 L11,18.9906311 C11,18.9937578 11.0000137,18.9968808 11.0000409,19 L9.99077797,19 C9.45097518,19 9,19.4477153 9,20 C9,20.5561352 9.44358641,21 9.99077797,21 L14.009222,21 C14.5490248,21 15,20.5522847 15,20 C15,19.4438648 14.5564136,19 14.009222,19 L12.9999626,19 C12.999986,18.9968804 13,18.9937574 13,18.9906311 L13,16.9383953 C14.793746,16.7093537 16.1268712,15.8533183 17.0115375,14.566531 C17.631941,13.6641258 17.9116422,12.769082 17.9922726,12.124039 C18.0567667,11.6080864 17.715976,11.1348845 17.2185349,11.0241058 L17.2162194,11.0264213 C17.1758852,11.0160463 17.1430789,11.0101085 17.12403,11.0077274 C16.5760096,10.9392248 16.076219,11.3279514 16.0077165,11.8759725 C15.9990827,11.9450424 15.9659776,12.1062504 15.8970768,12.3267333 C15.8944966,12.3349898 15.8931939,12.3425837 15.8931049,12.3495358 Z M14.8100942,4.94726512 C14.3837386,3.80970165 13.2864273,3 12,3 C10.3431458,3 9,4.34314575 9,6 L9,10.7573593 L14.8100942,4.94726512 Z M7.97590142,11.7814579 C7.86511978,11.2840207 7.39191988,10.9432336 6.87596978,11.0077274 C6.32795032,11.0762298 5.93922497,11.5760196 6.0077274,12.124039 C6.05291889,12.4855709 6.16064541,12.9256367 6.35584336,13.401516 L7.97590142,11.7814579 Z M20.4877316,2.09805481 C20.8769027,1.70888376 21.506248,1.70725811 21.8994949,2.10050506 C22.2900192,2.49102936 22.2956069,3.1186067 21.9019452,3.51226838 L3.51226838,21.9019452 C3.12309732,22.2911162 2.49375202,22.2927419 2.10050506,21.8994949 C1.70998077,21.5089706 1.70439313,20.8813933 2.09805481,20.4877316 L20.4877316,2.09805481 Z\"\n                  id=\"Combined-Shape\"\n                ></path>\n              </g>\n            </g>\n          </g>\n        );\n      case TYPE_SCREEN:\n        return (\n          <path\n            fill={getFillColor()}\n            fillRule=\"evenodd\"\n            d=\"M2 5.006C2 3.898 2.898 3 3.99 3h16.02C21.108 3 22 3.897 22 5.006v9.988A2.003 2.003 0 0 1 20.01 17H3.99C2.892 17 2 16.103 2 14.994V5.006zm2 .99v8.009c0 .54.448.995 1 .995h14c.555 0 1-.446 1-.995v-8.01c0-.54-.448-.995-1-.995H5c-.555 0-1 .446-1 .995zM7 20c0-.552.456-1 .995-1h8.01c.55 0 .995.444.995 1 0 .552-.456 1-.995 1h-8.01A.995.995 0 0 1 7 20z\"\n          />\n        );\n      case TYPE_LEAVE:\n        return (\n          <path\n            d=\"M19.347 11l-1.71-1.638a.832.832 0 0 1 0-1.222l.03-.03a.922.922 0 0 1 1.27-.003l3.34 3.2a.95.95 0 0 1 0 1.386l-3.34 3.2a.918.918 0 0 1-1.27-.003l-.03-.03a.842.842 0 0 1 0-1.221L19.348 13h-7.352A.995.995 0 0 1 11 12c0-.552.456-1 .995-1h7.352zM16 10h-2V7.995c0-.54-.446-.995-.997-.995H6.997A1 1 0 0 0 6 7.995v8.01c0 .54.446.995.997.995h6.006a1 1 0 0 0 .997-.995V14h2v2.994A2.009 2.009 0 0 1 13.991 19H6.01A2.007 2.007 0 0 1 4 16.994V7.006C4 5.898 4.902 5 6.009 5h7.982C15.101 5 16 5.897 16 7.006V10z\"\n            fill={getFillColor()}\n            fillRule=\"evenodd\"\n          />\n        );\n      case TYPE_CHAT:\n        return (\n          <path\n            d=\"M8.984 17.522c.93.308 1.949.478 3.016.478 4.418 0 8-2.91 8-6.5S16.418 5 12 5s-8 2.91-8 6.5c0 1.65.756 3.156 2.003 4.302a8.751 8.751 0 0 1-.71 2.187c-.317.606-.457 1.011 0 1.011 1.727 0 1.99-1.236 3.691-1.478z\"\n            fill={getFillColor()}\n            fillRule=\"evenodd\"\n          />\n        );\n      default:\n        throw new Error();\n    }\n  }\n\n  return (\n    <svg\n      width=\"28px\"\n      height=\"28px\"\n      viewBox=\"0 0 24 24\"\n      className={props.className}\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      {getPath()}\n    </svg>\n  );\n}\n\nexport { TYPE_MUTE_CAMERA, TYPE_MUTE_MIC, TYPE_SCREEN, TYPE_LEAVE, TYPE_CHAT };\n","import React from 'react';\nimport './TrayButton.css';\nimport Icon, {\n  TYPE_MUTE_CAMERA,\n  TYPE_MUTE_MIC,\n  TYPE_SCREEN,\n  TYPE_LEAVE,\n  TYPE_CHAT,\n} from '../Icon/Icon';\n\n/**\n * Props:\n * - type: string\n * - disabled: boolean\n * - highlighted: boolean\n * - onClick: () => ()\n * - newButtonGroup: boolean\n */\nexport default function TrayButton(props) {\n  return (\n    <button\n      disabled={props.disabled}\n      onClick={props.onClick}\n      className={'tray-button' + (props.newButtonGroup ? ' new-group' : '')}\n    >\n      <Icon type={props.type} highlighted={props.highlighted} />\n    </button>\n  );\n}\n\nexport { TYPE_MUTE_CAMERA, TYPE_MUTE_MIC, TYPE_SCREEN, TYPE_LEAVE, TYPE_CHAT };\n","import React, { useContext, useState, useEffect } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport './Chat.css';\n\nexport default function Chat(props) {\n  const callObject = useContext(CallObjectContext);\n  const [inputValue, setInputValue] = useState('');\n  const [chatHistory, setChatHistory] = useState([]);\n\n  const handleChange = (event) => {\n    setInputValue(event.target.value);\n  };\n\n  function handleSubmit(event) {\n    event.preventDefault();\n    callObject.sendAppMessage({ type:'chat', message: inputValue }, '*');\n    const name = callObject.participants().local.user_name.includes('_Admin')\n      ? callObject.participants().local.user_name.split('_Admin').join('')\n      : callObject.participants().local.user_name;\n    setChatHistory([\n      ...chatHistory,\n      {\n        sender: name,\n        message: inputValue,\n      },\n    ]);\n    setInputValue('');\n  }\n\n  /**\n   * Update chat state based on a message received to all participants.\n   *\n   */\n  useEffect(() => {\n    if (!callObject) {\n      return;\n    }\n\n    function handleAppMessage(event) {\n      const participants = callObject.participants();\n      const name = callObject.participants().local.user_name.includes('_Admin')\n      ? callObject.participants().local.user_name.split('_Admin').join('')\n      : callObject.participants().local.user_name;\n      event.data.type=='chat'&& setChatHistory([\n        ...chatHistory,\n        {\n          sender: name,\n          message: event.data.message,\n        },\n      ]);\n      // Make other icons light up\n      event.data.type=='chat'&& props.notification();\n    }\n\n    callObject.on('app-message', handleAppMessage);\n\n    return function cleanup() {\n      callObject.off('app-message', handleAppMessage);\n    };\n  }, [callObject, chatHistory]);\n\n  useEffect(() => {}, [chatHistory]);\n\n  return props.onClickDisplay ? (\n    <div className=\"chat\">\n            <div className=\"chat-history\">\n          {\n            chatHistory.map((entry, index) => (\n            <div key={`entry-${index}`} className=\"messageList\">\n              <b>{entry.sender}</b>: {entry.message}\n            </div>\n          ))\n          }\n          </div>\n      <form onSubmit={handleSubmit}>\n        <label htmlFor=\"chatInput\"></label>\n        <input\n          id=\"chatInput\"\n          className=\"chat-input\"\n          type=\"text\"\n          placeholder=\"Type your message here..\"\n          value={inputValue}\n          onChange={handleChange}\n        ></input>\n        <button type=\"submit\" className=\"send-chat-button\">\n          Send\n        </button>\n      </form>\n    </div>\n  ) : null;\n}\n","import React, { useContext, useEffect, useState } from 'react';\nimport './Tray.css';\nimport TrayButton, {\n  TYPE_MUTE_CAMERA,\n  TYPE_MUTE_MIC,\n  TYPE_SCREEN,\n  TYPE_LEAVE,\n  TYPE_CHAT,\n} from '../TrayButton/TrayButton';\nimport InputSelector from '../InputSelector/InputSelector';\nimport Chat from '../Chat/Chat';\nimport CallObjectContext from '../../CallObjectContext';\nimport { logDailyEvent } from '../../logUtils';\nimport DailyIframe from '@daily-co/daily-js';\nfunction useForceUpdate(){\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => value + 1); // update the state to force render\n}\n\n/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */\nfunction getStreamStates(callObject) {\n  let isCameraMuted,\n    isMicMuted,\n    isSharingScreen = false;\n  if (\n    callObject &&\n    callObject.participants() &&\n    callObject.participants().local\n  ) {\n    const localParticipant = callObject.participants().local;\n    isCameraMuted = !localParticipant.video;\n    isMicMuted = !localParticipant.audio;\n    isSharingScreen = localParticipant.screen;\n  }\n  return [isCameraMuted, isMicMuted, isSharingScreen];\n}\n\n/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */\nexport default function Tray(props) {\n  const callObject = useContext(CallObjectContext);\n  const [isCameraMuted, setCameraMuted] = useState(false);\n  const [isMicMuted, setMicMuted] = useState(false);\n  const [isSharingScreen, setSharingScreen] = useState(false);\n  const [displayChat, setChatDisplay] = useState(false);\n  const [highlightedChat, setChatHighlight] = useState(false);\n  const forceUpdate = useForceUpdate();\n  const micCaret = React.createRef();\n  const micSettings = React.createRef();\n  const camCaret = React.createRef();\n  const camSettings = React.createRef();\n\n  window.updateTray = () => {\n    forceUpdate();\n  }\n\n  const [showMicSettings,setShowMicSettings] = useState(false);\n  const [showCamSettings,setShowCamSettings] = useState(false);\n\n  function toggleCamera() {\n    callObject.setLocalVideo(isCameraMuted);\n  }\n\n  function toggleMic() {\n    callObject.setLocalAudio(isMicMuted);\n  }\n\n\n  useEffect(()=> {\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n\n\n return function cleanup() {\n    document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  })\n\n  const handleClickOutside = (event) => {\n    console.log('handling click');\n    if (micSettings.current &&\n      !micSettings.current.contains(event.target) &&\n      !micCaret.current.contains(event.target)\n    ) {\n      setShowMicSettings(false);\n    } else if (camSettings.current &&\n      !camSettings.current.contains(event.target) &&\n      !camCaret.current.contains(event.target)\n    ) {\n      setShowCamSettings(false);\n    } \n    \n  }\n\n  // function toggleSharingScreen() {\n\n    \n  //   isSharingScreen\n  //     ? callObject.stopScreenShare()\n  //     : navigator.mediaDevices.getDisplayMedia({\n  //       video: true,\n  //       audio: true,\n  //     }).then((stream)=>callObject.startScreenShare({\n  //       mediaStream:stream}))\n  //       // share getDisplayMedia stream\n  //       // mediaStream: window.screenStream,\n\n  //       // share getDisplayMedia audio track only\n        \n  //       // mediaStream: window.screenStream,\n\n  //       // share local cam via screen stream\n  //       // mediaStream: window.localCam,\n\n  //       // share only audio from local cam via screen stream\n  //       // mediaStream: new MediaStream(window.localCam.getAudioTracks()),\n  //     // });\n  // }\n\n  function leaveCall() {\n    props.onClickLeaveCall && props.onClickLeaveCall();\n  }\n\n  function toggleChat() {\n    setChatDisplay(!displayChat);\n    if (highlightedChat) {\n      setChatHighlight(!highlightedChat);\n    }\n  }\n\n  function handleNewChat() {\n    setChatHighlight(!highlightedChat);\n  }\n\n  function openScreenShareWindow () {\n    window.open(\"http://\" + window.location.host + \"/share\",\"test\",\"width=300, height=300\");\n\n  }\n\n\n\n  /**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleNewParticipantsState(event) {\n      event && logDailyEvent(event);\n      const [isCameraMuted, isMicMuted, isSharingScreen] = getStreamStates(\n        callObject\n      );\n      setCameraMuted(isCameraMuted);\n      setMicMuted(isMicMuted);\n      setSharingScreen(isSharingScreen);\n    }\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    callObject.on('participant-updated', handleNewParticipantsState);\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      callObject.off('participant-updated', handleNewParticipantsState);\n    };\n  }, [callObject]);\n\n\n\n  return (\n    <div className={window.amAdmin ? \"tray-with-sidebar\" : \"tray\"}>\n\n      <TrayButton\n        type={TYPE_MUTE_CAMERA}\n        disabled={props.camDisabled}\n        highlighted={isCameraMuted}\n        onClick={toggleCamera}\n      />\n      \n      {!props.camDisabled &&\n      <div onClick={()=>{setShowCamSettings(!showCamSettings)}}  style={{position:'absolute',left:'57px', bottom:'23px'}}>\n        <p className=\"caret\" ref={camCaret}>^</p>\n                {showCamSettings ? \n                (<InputSelector type='video' page='main' ref={camSettings}/>)\n                : \n                null}\n      </div>\n      }\n      \n      <TrayButton\n        type={TYPE_MUTE_MIC}\n        disabled={props.micDisabled}\n        highlighted={isMicMuted}\n        onClick={toggleMic}\n      />\n      {!props.micDisabled &&\n        <div onClick={()=>{setShowMicSettings(!showMicSettings)}}  style={{position:'absolute',left:'123px', bottom:'23px'}}>\n        \n\n        <p className=\"caret\" ref={micCaret}>^</p>\n                {showMicSettings ? \n                (<InputSelector type='audio' page='main' ref={micSettings}/>)\n                : \n                null}\n                \n        </div>\n      }\n\n      {DailyIframe.supportedBrowser().supportsScreenShare && window.amAdmin && (\n        <TrayButton\n          type={TYPE_SCREEN}\n          // disabled={props.disabled}\n          highlighted={isSharingScreen}\n          onClick={openScreenShareWindow}\n          // onClick={toggleSharingScreen}\n        />\n      )}\n      <TrayButton\n        type={TYPE_CHAT}\n        // disabled={props.disabled}\n        highlighted={highlightedChat}\n        onClick={toggleChat}\n      />\n      <Chat onClickDisplay={displayChat} notification={handleNewChat} />\n      \n        \n\n\n\n      {/* Display room status and either my role or room selector +  */}\n          <div className='status-display'>\n\n            <div style={{height:'30px'}}>\n               Roleplay:  &nbsp;            \n                            {window.sessionState.isActive ? \n                              <div className='display-card active'>Live</div>\n                              :\n                              <div className='display-card paused'>Paused</div>\n                            }\n              </div>\n\n            <div className='vertical-line'></div>\n\n            {/* if session is paused or I have a role, display my role, otherwise show room selector */}\n            {!window.sessionState.isActive || (window.myRole!=='Admin' && window.myRole!=='Attendee')\n            \n                ?   ( <div style={{height:'30px'}}>\n                            My Role: &nbsp;\n                            {window.myRole=='Admin' || window.myRole=='Attendee' \n\n                            ? <span className='display-card role'> \n                                Viewer\n                              </span>\n                            : <span className='display-card role'> \n                                {window.myRole.match(/\\D/g).join('')} \n                              </span>\n                            \n                            }\n                       </div>\n                    )\n            : ( <div className='my-view'>\n                        My View: &nbsp;\n                            <span > \n                              <form action = ''>\n                                <fieldset style={{border:'none'}}>\n                                    <select className='my-view-selector' value={window.viewMode} onChange = {(e)=>window.setViewMode(e.target.value)}>\n                                        <option value = 'Seller'>Seller</option>\n                                        {window.sessionState.roleOf.Shadow1 && <option value = 'Shadow1' selected>Shadow 1</option>}\n                                        {window.sessionState.roleOf.Shadow2 && <option value = 'Shadow2'>Shadow 2</option>}\n                                        {window.sessionState.roleOf.Shadow3 && <option value = 'Shadow3'>Shadow 3</option>}\n                                        {window.sessionState.roleOf.Shadow4 && <option value = 'Shadow4'>Shadow 4</option>}\n                                        {window.sessionState.roleOf.Shadow1 ||\n                                          window.sessionState.roleOf.Shadow2 ||\n                                          window.sessionState.roleOf.Shadow3 ||\n                                          window.sessionState.roleOf.Shadow4 &&\n                                          <option value = 'All'>All</option>}\n                                    </select>\n                                </fieldset>\n                              </form>\n                            </span>\n                  </div>\n              )\n            \n              \n            }\n                            \n          \n             \n\n\n          </div>\n     \n      \n\n      <TrayButton\n        type={TYPE_LEAVE}\n        disabled={props.disabled}\n        newButtonGroup={true}\n        highlighted={true}\n        onClick={leaveCall}\n      />\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default React.createContext();\n","export function roomUrlFromPageUrl() {\n  const match = window.location.search.match(/roomUrl=([^&]+)/i);\n  return match && match[1] ? decodeURIComponent(match[1]) : null;\n}\n\nexport function pageUrlFromRoomUrl(roomUrl) {\n  return (\n    window.location.href.split('?')[0] +\n    (roomUrl ? `?roomUrl=${encodeURIComponent(roomUrl)}` : '')\n  );\n}\n","export default function audioPlayer(trackName,command) {\n    const trackList = {\n        monologue1: 'https://storage.googleapis.com/secondbodyuploads/What%20Makes%20CEB%20Different%20(Mono).mp3',\n        monologue2: 'https://storage.googleapis.com/secondbodyuploads/PAGA%20Claims%20(mono).mp3',\n        monologue3: 'https://storage.googleapis.com/secondbodyuploads/AudioEngineer.mp3',\n        monologue4: 'https://storage.googleapis.com/secondbodyuploads/IBM%20Garage.mp3',\n        monologue5: '',\n        monologue6: '',\n\n        dialogue1: 'https://storage.googleapis.com/secondbodyuploads/EthicsA%20(dialogue).mp3',\n        dialogue1B: 'https://storage.googleapis.com/secondbodyuploads/EthicsB%20(dialogue).mp3',\n        dialogue2: 'https://storage.googleapis.com/secondbodyuploads/CoursePass(A)%20(dialogue).mp3',\n        dialogue2B: 'https://storage.googleapis.com/secondbodyuploads/CoursePass(B)%20(dialogue).mp3',\n        dialogue3: '',\n        dialogue3B: '',\n        dialogue4: '',\n        dialogue4B: '',\n        dialogue5: '',\n        dialogue5B: '',\n        dialogue6: '',\n        dialogue6B: '',\n    }\n    window.audio.src = trackList[trackName];\n    console.log (`going to ${command} ${trackName}`);\n    window.audio[command]();\n\n   \n\n    //TODO: PUT BACK IN*********\n\n    if(command=='pause') {\n        window.audioSourceNode.disconnect();\n        return;\n    }\n\n    //create Audio Context and destination\n    if (typeof(window.audioCtx)=='undefined') {window.audioCtx = new (window.AudioContext || window.webkitAudioContext)();}\n    // let src=document.getElementById('MediaPlayer');\n    window.audioSourceNode = window.audioSourceNode || window.audioCtx.createMediaElementSource(window.audio);\n\n    //gain Node\n    let gainNode = window.audioCtx.createGain();\n    gainNode.gain.value=1;\n    //panner Node\n    var panNode = window.audioCtx.createStereoPanner();\n    panNode.pan.value=1;\n\n    //Pipe source through nodes to destination\n    window.audioSourceNode.connect(gainNode).connect(panNode).connect(window.audioCtx.destination);\n\n\n    //END TODO*******\n\n    \n\n}","import React, { useContext, useEffect, useState } from 'react';\nimport './RoleSelector.css';\nimport setSubscriptions from '../../hooks/setSubscriptions';\nimport CallObjectContext from '../../CallObjectContext';\nimport SessionStateContext from '../../SessionStateContext';\n\n\n\nexport default function RoleSelector(props) {\n    const callObject = useContext(CallObjectContext);\n    const { session } = useContext(SessionStateContext);\n    const [ sessionState,setSessionState] = session;\n    const setSubs = () => {setSubscriptions(callObject,window.viewMode)};  \n    const role = props.role;\n    // const [selectedOption, setSelectedOption] = useState('');\n\n    \n    const sendState = () => {\n        console.log (\"Sending current state...\");\n        callObject.sendAppMessage(window.sessionState, '*'); \n    }\n\n\n    let handleRoleChange = (e) => {\n        window.sessionState.roleOf[e.target.id]=e.target.value;\n        setSessionState((prevState)=>(\n            {\n            ...prevState,\n            roleOf: {\n                    ...prevState.roleOf,\n                    [e.target.id]: e.target.value\n                    }\n            }\n            ))\n        console.log (e.target.id + ' is now: ' + e.target.value);\n        sendState();\n    \n        let myNewRole = 'Attendee'; //default, if no role assigned\n        for (const key in window.sessionState.roleOf) {\n            if(window.sessionState.roleOf[key]==window.myName) {\n                myNewRole = key;\n            }\n        }\n        if (myNewRole!=window.myRole) {\n            window.myRole = myNewRole;\n              if (window.myRole.includes('1')) {\n                  window.myNumber=1;\n              } else if (window.myRole.includes('2')) {\n                  window.myNumber=2;\n              }\n          }\n            if(window.sessionState.isActive){\n                // activateSession();  //rebuild UI for the newly assigned role, mid-session\n            } \n            setSubs();\n      }\n\n\n    return (\n\n\n\n\n    <form className='dropdown'>\n            <select className='selector' id={role} onChange={handleRoleChange} value={sessionState.roleOf[role]}>            \n            <option value={null}></option>\n                {window.userList && window.userList.length>0 && window.userList.map((user) => <option value={user}>{user.includes('_Admin') ? user.split('_Admin').join('') : user}</option>)}\n                </select>\n    </form>\n                    \n\n    );\n  }\n\n        ","import React, { useContext, useEffect, useState } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport { logDailyEvent } from '../../logUtils';\nimport './AdminPanel.css';\nimport setSubscriptions from '../../hooks/setSubscriptions';\nimport audioPlayer from '../../hooks/AudioPlayer';\nimport RoleSelector from '../RoleSelector/RoleSelector';\nimport RoleContainer from '../RoleContainer/RoleContainer';\nimport SessionStateContext from '../../SessionStateContext';\n\n// import { sendState } from '../AdminPanel/AdminFunctions'\n// import SessionContext from '../../SessionContext';\n\n\n\nfunction useForceUpdate(){\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => value + 1); // update the state to force render\n}\n\n\n\n/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */\nfunction getStreamStates(callObject) {\n  let isCameraMuted,\n    isMicMuted,\n    isSharingScreen = false;\n  if (\n    callObject &&\n    callObject.participants() &&\n    callObject.participants().local\n  ) {\n    const localParticipant = callObject.participants().local;\n    isCameraMuted = !localParticipant.video;\n    isMicMuted = !localParticipant.audio;\n    isSharingScreen = localParticipant.screen;\n  }\n  return [isCameraMuted, isMicMuted, isSharingScreen];\n}\n\n\n\n/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */\nexport default function AdminPanel(props) {\n  const callObject = useContext(CallObjectContext);\n  // const [sessionState, setSessionState ] = useContext(SessionContext);\n  const [isCameraMuted, setCameraMuted] = useState(false);\n  const [isMicMuted, setMicMuted] = useState(false);\n  const [isSharingScreen, setSharingScreen] = useState(false);\n  const [displayChat, setChatDisplay] = useState(false);\n  const [highlightedChat, setChatHighlight] = useState(false);\n  const { session } = useContext(SessionStateContext);\n  const [ sessionState,setSessionState] = session;\n  const setSubs = () => {setSubscriptions(callObject)};  \n  const forceUpdate = useForceUpdate();\n  window.updateAdminPanel=forceUpdate;\n  const [playButtonText, setPlayButtonText] = useState('Play');\n  const [targetRecording, setTargetRecording] = useState('monologue1') ///////HAVE TO CHANGE THIS IN TWO PLACES\n  const training = React.createRef();\n  const trainingToggle = React.createRef();\n\n  useEffect(() => {           //listen for participants leaving or joining and update component\n    if (!callObject) return;\n\n    const events = [\n      'participant-joined',\n      'participant-left',\n      'joined-meeting',\n    ];\n\n    for (const event of events) {\n      callObject.on(event, () => setTimeout(()=>forceUpdate(),100));\n    }\n\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, () => setTimeout(()=>forceUpdate(),100));\n      }\n    };\n\n  }, [callObject]);\n\n\n\nconst sendState = () => {\n    console.log (\"Sending current state...\");\n    callObject.sendAppMessage(window.sessionState, '*'); \n}\n\n  useEffect(()=> {\n    window.sendState = sendState;\n  },[sendState]);\n\n\n  function toggleSessionActive() {\n    setSessionState((prevState)=>({\n      ...prevState,\n      isActive: !prevState.isActive\n      }));\n    window.sessionState.isActive=!window.sessionState.isActive;\n    sendState();\n    //set ViewMode when session is started by host. \n    if (window.sessionState.isActive && !window.myRole.includes('Shadow') && !window.myRole.includes('Seller') && !window.myRole.includes('Buyer')) \n    {\n      if (window.sessionState.roleOf.Shadow1)\n        {window.setViewMode('Shadow1');}\n      else if (window.sessionState.roleOf.Shadow2)    //fallbacks in case shadow1 is not assigned\n        {window.setViewMode('Shadow2');}\n      else if (window.sessionState.roleOf.Shadow3)\n        {window.setViewMode('Shadow3');}\n      else if (window.sessionState.roleOf.Shadow4)\n        {window.setViewMode('Shadow4');}\n      else\n        {window.setViewMode('Seller');}\n      window.camWasOn = callObject.participants().local.video ? true : false;\n      window.micWasOn = callObject.participants().local.audio ? true : false;\n      callObject.setLocalVideo(false);\n      callObject.setLocalAudio(false);\n    }\n    else {\n      console.log('***SettingSubs***');\n      console.log('Current viewmode is: ' + window.viewMode);\n      setSubs();\n      console.log('And now viewmode is: ' + window.viewMode);\n    }\n    if (!window.sessionState.isActive) {\n      callObject.setLocalVideo(true);\n      callObject.setLocalAudio(true);\n    }\n  }\n\n  function togglePractice() {\n    let recipientA = window.sessionState.roleOf.Shadow1 && window[window.sessionState.roleOf.Shadow1 + '_SessionID'];\n    let recipientB = window.sessionState.roleOf.Shadow2 && window[window.sessionState.roleOf.Shadow2 + '_SessionID'];\n    if(window.sessionState.roleOf.Shadow1==window.myName) {recipientA='me'}\n    if(window.sessionState.roleOf.Shadow2==window.myName) {recipientB='me'}\n\n    if (!recipientA && !recipientB) {console.log('no recipients.'); return}\n\n    const action = window.audioIsPlaying ? 'pause' : 'play';\n    const instructionsA = {\n      type: 'instructions',\n      target: targetRecording,\n      action: action,\n      recipient: recipientA,\n    }\n    const instructionsB = {\n      type: 'instructions',\n      target: targetRecording + 'B',\n      action: action,\n      recipient: recipientB\n    }\n\n    if (recipientA) {\n      if(recipientA!='me') {\n        callObject.sendAppMessage(instructionsA,recipientA);\n      }\n      else if(recipientA=='me') {\n        audioPlayer(targetRecording,action);\n      }\n      console.log(`Sent ${action} request to ${window.sessionState.roleOf.Shadow1}`);\n    }\n    if (recipientB) {\n      if(recipientB!='me') {\n        callObject.sendAppMessage(instructionsB,recipientB);\n      }\n      else if(recipientB=='me') {\n        audioPlayer(targetRecording+'B',action);\n      }\n      console.log(`Sent ${action} request to ${window.sessionState.roleOf.Shadow2}`);\n    }\n      \n    window.audioIsPlaying=(!window.audioIsPlaying);\n    setPlayButtonText(!window.audioIsPlaying ? 'Play' : 'Pause');\n\n\n  }\n\n\n  function toggleTrainingMode () {\n    training.current.classList.toggle('hidden');\n    trainingToggle.current.innerText = training.current.classList.contains('hidden') ? 'Show Practice' : 'X';\n  }\n\n\n\n  \n\n                  \n         \n\n\n  /**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleNewParticipantsState(event) {\n      event && logDailyEvent(event);\n      const [isCameraMuted, isMicMuted, isSharingScreen] = getStreamStates(\n        callObject\n      );\n      setCameraMuted(isCameraMuted);\n      setMicMuted(isMicMuted);\n      setSharingScreen(isSharingScreen);\n    }\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    callObject.on('participant-updated', handleNewParticipantsState);\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      callObject.off('participant-updated', handleNewParticipantsState);\n    };\n  }, [callObject]);\n\n\n    /* // Play practice audio for users */\n\n    \n\n  return (\n<div>\n  <div className=\"admin-panel\">\n\n    {/* BEGIN ROLE SELECTORS SECTION*/}\n      <div className=\"role-selector-section\">\n\n\n          {/* Buyer selector */}\n          <div className=\"selector-box\">\n            Buyer(s)\n\n              <RoleSelector \n                role=\"Buyer1\"\n                selectedRoles='selectedRoles'\n              />\n              <RoleSelector \n                role=\"Buyer2\"\n                selectedRoles='selectedRoles'\n              />\n              <RoleSelector \n                role=\"Buyer3\"\n                selectedRoles='selectedRoles'\n              />\n          </div>\n          \n          {/* Seller Selector */}\n          <div className=\"selector-box\">\n            Seller\n              <RoleSelector \n                  role=\"Seller\"\n                  selectedRoles='selectedRoles'\n                />\n          </div>\n\n          {/* Shadow selector */}\n          <div className=\"selector-box\">\n            Seller's shadow(s)\n              <RoleSelector \n                  role=\"Shadow1\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow2\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow3\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow4\"\n                  selectedRoles='selectedRoles'\n                />\n            </div>\n\n          {/* Unassigned (working) */}\n          {/* <div className=\"selector-box\">\n            Unassigned\n            <RoleContainer\n            />\n           </div> */}\n\n\n        </div>\n    {/* END ROLE SELECTORS SECTION */}\n\n\n    \n\n\n\n\n\n    {/* <!-- BEGIN START / STOP TOGGLE --> */}\n        <div className='session-toggle'>\n                        <label class=\"switch\">\n                            <input type=\"checkbox\" id='state' checked={sessionState.isActive} onChange={toggleSessionActive}/>\n                            <span class=\"slider round\"></span>\n                        </label>\n                        <p>Session active</p>\n        </div>\n     {/* <!-- END START / STOP TOGGLE --> */}\n\n\n     \n\n    </div>\n// ***End admin panel***\n\n{/* START TRAINING AUDIO SECTION */}\n\n<div className='practice-audio hidden' ref={training}>\n    Practice audio\n        \n                    {/* Recordings for Seconding */}\n                    <div style={{height:'30px',margin:'auto'}}>\n                    <form action = ''>\n                        <fieldset style={{border:'none'}}>\n                        <select class='practice-audio-dropdown' onChange={(e) => {setTargetRecording (e.target.value); console.log('***CHANGED TO ' + e.target.value)}}\n                        >\n                        <option value = 'monologue1'>What makes CEB different (mono)</option>    \n                        {/* ///IMPORTANT: IF DEFAULT VALUE CHANGES ABOVE, ALSO HAVE TO CHANGE IT IN setTargetRecording HOOK */}\n                        <option value = 'monologue2'>Searching for PAGA Claims (mono)</option>\n                        <option value = 'monologue3'>Audio Engineer (mono)</option>\n                        <option value = 'monologue4'>IBM Garage (mono)</option>\n                        <option value = 'dialogue1'>Ethics (dialogue)</option>\n                        <option value = 'dialogue2'>CoursePass (dialogue)</option>\n                    </select>\n                    </fieldset>\n                    </form>\n                </div> \n                  <span style={{color: 'green', fontSize: '16px', fontFamily:'Verdana, Geneva, Tahoma, sans-serif'}}>\n                      <button onClick={togglePractice} id='play-pause'>{playButtonText}</button>\n                    </span>\n    </div>\n\n    {/* END TRAINING AUDIO SECTION */}\n\n<div className='training-toggle' ref={trainingToggle} onClick={toggleTrainingMode}>Show Practice</div>\n</div>\n    \n  );\n  \n}\n","import React, { useEffect, useState, useCallback } from 'react';\nimport Call from '../Call/Call';\nimport StartScreen from '../StartScreen/StartScreen';\nimport api from '../../api';\nimport './App.css';\nimport Tray from '../Tray/Tray';\nimport CallObjectContext from '../../CallObjectContext';\nimport SessionStateContext from '../../SessionStateContext';\nimport MyContext from '../../MyContext'\nimport { roomUrlFromPageUrl, pageUrlFromRoomUrl } from '../../urlUtils';\nimport DailyIframe from '@daily-co/daily-js';\nimport { logDailyEvent } from '../../logUtils';\nimport setSubscriptions from '../../hooks/setSubscriptions';\nimport { sendState } from '../AdminPanel/AdminFunctions';\nimport audioPlayer from '../../hooks/AudioPlayer';\nimport AdminPanel from '../AdminPanel/AdminPanel';\n\n\n\n\nconst STATE_IDLE = 'STATE_IDLE';\nconst STATE_CREATING = 'STATE_CREATING';\nconst STATE_JOINING = 'STATE_JOINING';\nconst STATE_JOINED = 'STATE_JOINED';\nconst STATE_LEAVING = 'STATE_LEAVING';\nconst STATE_ERROR = 'STATE_ERROR';\n\n\n\n\nexport default function App() {\n  const [appState, setAppState] = useState(STATE_IDLE);\n  const [roomUrl, setRoomUrl] = useState(null);\n  const [callObject, setCallObject] = useState(null);\n  const [sessionState, setSessionState] = useState({\n                                                    type: 'sessionState',\n                                                    isKnown:false,\n                                                    isActive:false,\n                                                    AdminVisible:false,\n                                                    roleOf: {\n                                                              Buyer1: '',\n                                                              Buyer2: '',\n                                                              Buyer3: '',\n                                                              Seller: '',\n                                                              Shadow1: '',\n                                                              Shadow2: '',\n                                                              Shadow3: '',\n                                                              Shadow4: '',\n                                                            }\n                                                    });\n  const [my, setMy] = useState({\n                                name: 'Your first name',\n                                role: 'Attendee',\n                                adminStatus: false,\n                              });\n  const [ camDisabled, setCamDisabled ] = useState(false);\n  const [ micDisabled, setMicDisabled ] = useState(false);\n\n\n\n  if (!window.pass.includes(window.myP)) {\n    //redirect if password is wrong\n    window.location.href = \"http://secondbody.co\"\n  }\n\n  window.setViewMode = (viewMode) => {\n    viewMode && console.log ('Changing view mode to: ' + viewMode);\n    window.viewMode=viewMode;\n    setSubscriptions(callObject,viewMode)\n  }\n\n\n  \n  /**\n   * Creates a new call room.\n   */\n  const createCall = useCallback(() => {\n    setAppState(STATE_CREATING);\n    return api\n      .createRoom()\n      .then((room) => room.url)\n      .catch((error) => {\n        console.log('Error creating room', error);\n        setRoomUrl(null);\n        setAppState(STATE_IDLE);\n      });\n  }, []);\n\n\n\n  /**\n   * Starts joining an existing call.\n   *\n   * NOTE: In this demo we show how to completely clean up a call with destroy(),\n   * which requires creating a new call object before you can join() again.\n   * This isn't strictly necessary, but is good practice when you know you'll\n   * be done with the call object for a while and you're no longer listening to its\n   * events.\n   */\n\n\n/*   \nARLO NOTE:\n      Below is where the trouble is. myInfo.name is set via a child component, <StartScreen>, \n      and it successfully changes myInfo.name (I've confirmed since it's pinned to the Window).\n      The below works... the first time. But then callObject.participants().local.user_name gets \"stuck\", \n      so if you exit and leave, or even refresh the page, it never changes. Weird behavior\n*/\n\n  const startJoiningCall = useCallback((url) => {\n    // if(!initialInputs) {return}\n    const newCallObject = DailyIframe.createCallObject({ \n      subscribeToTracksAutomatically: false, \n    });\n    setRoomUrl(url);\n    setCallObject(newCallObject);\n    setAppState(STATE_JOINING);\n    if(window.initialInputs) {\n      console.log('initial audio: ' + window.initialInputs[0] + '. Initial video: ' + window.initialInputs[1])\n      newCallObject.join({ userName:window.myName, url, audioSource: window.initialInputs[0],videoSource:window.initialInputs[1]}); \n    } else {\n      navigator.mediaDevices.getUserMedia({audio:true,video:true}).then((mediaStream)=>{\n        if(mediaStream){\n          let localAudio = mediaStream.getAudioTracks();\n          let localVideo = mediaStream.getVideoTracks();\n          if(localAudio && localAudio.length > 0 && localVideo && localVideo.length > 0)\n              {\n                newCallObject.join({ userName:my.name, url, audioSource: localAudio[0], videoSource:localVideo[0]});\n              }\n        }else{\n          //say something to user, like you don't have any mic or you should allow use mic to this website\n        }\n      })\n    }\n    console.log('joining the call as ' + my.name); \n    const pageUrl = pageUrlFromRoomUrl(roomUrl)+'&N='+window.myName+'&R='+window.myRole;\n    // let connector = '?';\n    // if (pageUrl.includes('?roomUrl=')) {let connector = '&'};\n    // if (window.myName) {\n    //   if (pageUrl === window.location.href) return;\n    //   window.history.replaceState(null, null, pageUrl + connector + \"R=\" + window.myRole + \"&N=\" + window.myName);\n    // } else if (window.myRole) {\n    //   if (pageUrl === window.location.href) return;\n    //   window.history.replaceState(null, null, pageUrl + connector + \"R=\" + window.myRole);\n    // } else {\n    //   if (pageUrl === window.location.href) return;\n    //   window.history.replaceState(null, null, pageUrl);\n    // }\n  }, []); \n\n\n\n  /**\n   * Starts leaving the current call.\n   */\n  const startLeavingCall = useCallback(() => {\n    if (!callObject) return;\n    // If we're in the error state, we've already \"left\", so just clean up\n    if (appState === STATE_ERROR) {\n      callObject.destroy().then(() => {\n        setRoomUrl(null);\n        setCallObject(null);\n        setAppState(STATE_IDLE);\n        window.initialize();\n      });\n    } else {\n      setAppState(STATE_LEAVING);\n      callObject.leave();\n      window.initialize();    \n    }\n  }, [callObject, appState]);\n\n  /**\n   * If a room's already specified in the page's URL when the component mounts,\n   * join the room.\n   */\n  useEffect(() => {\n    const url = roomUrlFromPageUrl();\n    url && window.initialInputs && startJoiningCall(url);\n  }, [startJoiningCall]);\n\n  /**\n   * Update the page's URL to reflect the active call when roomUrl changes.\n   *\n   * This demo uses replaceState rather than pushState in order to avoid a bit\n   * of state-management complexity. See the comments around enableCallButtons\n   * and enableStartButton for more information.\n   */\n  useEffect(() => {\n    let pageUrl = pageUrlFromRoomUrl(roomUrl);\n    window.pageUrl=pageUrl;\n    \n    if (window.myName) {\n      if (pageUrl.indexOf('?') > -1){\n        pageUrl += '&N=' + window.myName;\n      }else{\n        pageUrl += '?N=' + window.myName;\n      }\n    }\n    if (window.myRole) {\n      if (pageUrl.indexOf('?') > -1){\n        pageUrl += '&R=' + window.myRole;\n      }else{\n        pageUrl += '?R=' + window.myRole;\n      }\n    }\n    if (window.myP) {\n      if (pageUrl.indexOf('?') > -1){\n        pageUrl += '&P=' + window.myP;\n      }else{\n        pageUrl += '?P=' + window.myP;\n      }\n    }\n    if (pageUrl === window.location.href) return;\n    window.history.replaceState(null, null, pageUrl);\n  }, [roomUrl]);\n\n\n  /**\n   * Uncomment to attach call object to window for debugging purposes.\n   */\n  useEffect(() => {\n    window.callObject = callObject;\n  }, [callObject]); // Only re-run the effect if callObject changes\n\n  \n function getState () {\n    if (window.sessionState.isKnown == true) {\n        clearInterval(window.stateRequest);            \n        return;\n    }\n    // if (window.adminPresent) {\n        callObject.sendAppMessage(\"State please?\", '*'); \n        console.log('Requesting meeting state...');\n    \n}\n\nconst checkIfAdminPresent = () => {\n\n  return new Promise((resolve) => {\n    window.adminPresent = false;\n    let ps=callObject.participants();\n    const lookForMoreParticipants = setInterval (()=>{  //This interval should be redundant, but checking to make sure a dummy user doesn't pop up first\n      if  (Object.keys(ps).length > 1\n            || (Object.keys(ps).length <= 1 && ps.local.user_name == window.myName)  \n      ) {\n            clearInterval(lookForMoreParticipants);\n            for (const p in ps) {\n              let thisUserName = ps[p].user_name;\n              if (thisUserName.includes('_Admin') && p!=='local') {\n                window.adminPresent = true;\n              }\n              console.log(`Participant present: ${thisUserName}`);\n            }\n            resolve ();\n      } else {return;}\n    },500)\n  })\n}\n \n\n  /**\n   * Update app state based on reported meeting state changes.\n   *\n   * NOTE: Here we're showing how to completely clean up a call with destroy().\n   * This isn't strictly necessary between join()s, but is good practice when\n   * you know you'll be done with the call object for a while and you're no\n   * longer listening to its events.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    const events = ['joined-meeting', 'left-meeting', 'error','participant-joined'];\n\n    function handleNewMeetingState(event) {\n      event && logDailyEvent(event);\n      switch (callObject.meetingState()) {\n        case 'joined-meeting':\n          setAppState(STATE_JOINED);\n          callObject.setNetworkTopology({ topology: 'sfu' });\n          window.userList.push(window.myName);\n          console.log('JOINED MEETING');\n          if(window.myName==\"\"){callObject.leave();}\n          if (!window.sessionState.isKnown) {\n            if (window.myRole==\"Admin\") {\n              checkIfAdminPresent().then(()=> {\n                window.sessionState.isKnown = window.adminPresent ? false : true;\n                window.adminPresent? console.log(`An admin is already present`) : console.log(`An admin is NOT already present`);\n                if (!window.sessionState.isKnown) {\n                  window.stateRequest = setInterval(()=>{getState()},2500);\n                }\n              })\n            } else {\n              window.stateRequest = setInterval(()=>{getState()},2500);\n            }\n          }\n          \n\n          break;\n        case 'left-meeting':\n          callObject.destroy().then(() => {\n            setRoomUrl(null);\n            setCallObject(null);\n            setAppState(STATE_IDLE);\n            clearInterval(window.stateRequest);\n            window.initialize();\n          });\n          break;\n        case 'participant-joined':\n\n          break;\n        case 'error':\n          setAppState(STATE_ERROR);\n          break;\n        default:\n          break;\n      }\n    }\n\n    // Use initial state\n    handleNewMeetingState();\n\n    // Listen for changes in state\n    for (const event of events) {\n      callObject.on(event, handleNewMeetingState);\n    }\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, handleNewMeetingState);\n      }\n    };\n  }, [callObject]);\n\n  /**\n   * Listen for app messages from other call participants.\n   */\n  useEffect(() => {\n    if (!callObject) {\n      return;\n    }\n\n    function handleAppMessage(e) {\n      if (e) {\n        logDailyEvent(e);\n        console.log(`received app message from ${e.fromId}: `, e.data);\n\n          let participants = callObject.participants();\n      \n          //handle sessionState updates\n          if (e.data.constructor === Object && e.data.type==\"sessionState\") {\n\n            const setSubs = () => {setSubscriptions(callObject)}\n                  \n            //temporarily commented out\n                  // if (e.data.isKnown==false)   //probably redundant. only use received sessionState if isKnown = true\n                  //     {return;}\n                  // else if (e.data.isKnown==true && typeof(stateRequest)!='undefined') {   //if state is known, stop asking for state\n                  //     clearInterval(stateRequest);\n                  // }\n      \n              let priorSessionState = window.sessionState;\n              window.sessionState=e.data;\n              setSessionState(e.data);\n              let needToSetSubs=false;\n                \n      \n                  // change my role if it has been updated in sessionState\n                  if (window.sessionState.roleOf!=priorSessionState.roleOf) \n                    {\n                      let myNewRole = 'Attendee'; //default, if no role assigned\n                      for (const key in window.sessionState.roleOf) {\n                          if(window.sessionState.roleOf[key]==window.myName) {\n                              myNewRole = key;\n                          }\n                      }\n                      if (myNewRole!=window.myRole) {\n                          window.myRole = myNewRole;\n                            if (window.myRole.includes('1')) {\n                                window.myNumber=1;\n                            } else if (window.myRole.includes('2')) {\n                                window.myNumber=2;\n                            }\n                        }\n                          if(window.sessionState.isActive){\n                              activateSession();  //rebuild UI for the newly assigned role, mid-session\n                          } \n                          needToSetSubs=true;\n                    }\n\n\n      \n                      //create or delete rooms according to assignments of Thirds\n                      // if (window.sessionState.roleOf.Room3A!='') {\n                      //     !$(\"#view-mode option[value=Room3\").length>0 && $(\"#view-mode\").append(\"<option value='Room3'>Room3</option>\");\n                      //   } else {\n                      //     $(\"#view-mode option[value=Room3\").remove();\n                      //   }\n      \n                      // if (window.sessionState.roleOf.Room4A!='') {\n                      //     !$(\"#view-mode option[value=Room4\").length>0 && $(\"#view-mode\").append(\"<option value='Room4'>Room4</option>\");\n                      //   } else {\n                      //     $(\"#view-mode option[value=Room4\").remove();\n                      //   }\n      \n                      // if (window.sessionState.roleOf.Room5A!='') {\n                      //     !$(\"#view-mode option[value=Room5\").length>0 && $(\"#view-mode\").append(\"<option value='Room5'>Room5</option>\");\n                      //   } else {\n                      //     $(\"#view-mode option[value=Room5\").remove();\n                      //   }\n                      \n                  //determine if need to reset subs\n                  if (priorSessionState.isActive !== window.sessionState.isActive ||\n                      priorSessionState.AdminVisible!==window.sessionState.AdminVisible ) \n                      {\n                          needToSetSubs = true;\n                      }\n      \n                  //now, reset subscriptions if necessary\n                  if (needToSetSubs) {\n                    if (!priorSessionState.isActive && window.sessionState.isActive && window.myRole=='Attendee' || window.myRole=='Admin') {\n                      setSubscriptions(callObject,'Room1')\n                    }\n                    else {\n                      setSubs();\n                    }\n                  }\n                  \n                  //when session starts\n                  if (priorSessionState.isActive == false && window.sessionState.isActive == true) {\n                      activateSession();\n                      //set ViewMode when session is started by self. \n                      if (window.myRole=='Attendee' || window.myRole=='Admin') {\n                        if (window.sessionState.roleOf.Shadow1)\n                          {window.setViewMode('Shadow1');}\n                        else if (window.sessionState.roleOf.Shadow2)    //fallbacks in case shadow1 is not assigned\n                          {window.setViewMode('Shadow2');}\n                        else if (window.sessionState.roleOf.Shadow3)\n                          {window.setViewMode('Shadow3');}\n                        else if (window.sessionState.roleOf.Shadow4)\n                          {window.setViewMode('Shadow4');}\n                        else if (window.sessionState.roleOf.Seller)\n                          {window.setViewMode('Seller');}\n                        window.camWasOn = callObject.participants().local.video ? true : false;\n                        window.micWasOn = callObject.participants().local.audio ? true : false;\n                        callObject.setLocalVideo(false);\n                        callObject.setLocalAudio(false);\n                        if (!window.amAdmin) {\n                          setCamDisabled(true);\n                          setMicDisabled(true);\n                        }\n                      }\n                  }\n                  //when session is paused\n                  else if (priorSessionState.isActive == true && window.sessionState.isActive == false) {\n                      pauseSession();\n                      setCamDisabled(false);\n                      setMicDisabled(false);\n                      window.setViewMode(null);\n                      if (window.camWasOn) {\n                        callObject.setLocalVideo(true);\n                      }\n                      if (window.micWasOn) {\n                        callObject.setLocalAudio(true);\n                      }\n                  } \n            }\n\n            else if (e.data.constructor === Object && e.data.type==\"instructions\" && e.data.recipient==callObject.participants().local.session_id) {\n              audioPlayer(e.data.target,e.data.action)\n            }\n\n\n            else if (e.data==\"State please?\") {\n              if (window.amAdmin && window.sessionState.isKnown) {\n                sendState(window.sessionState,callObject);\n              }\n            } \n          }\n          //not used in this module, since there's no timer\n          \n          // if none of the above, just overlay the message\n          // else if (e.data.constructor !== Object) {    \n          //     overlayMessage(e.data,10000);\n          // }\n\n          async function activateSession() {\n            switch (window.myRole) {\n                case 'Attendee':\n                    // $(\"#cam-instructions\").fadeOut(500);\n                    // $(\"#cam-image\").fadeOut(500);\n                    // $(\"#mic-instructions\").fadeOut(500);\n                    // $(\"#mic-image\").fadeOut(500);\n                    // $('#show-qr-code').fadeOut(500);\n                    // $('#get-prompt').fadeOut(500);\n                    // document.getElementById('my-view').style.visibility='visible';\n                    // $('#my-view').fadeIn(500);\n                    window.camWasOn = callObject.localVideo();\n                    if (window.camWasOn) {\n                        // toggleCam()\n                    }\n                    // $('#view-mode').val('Room1').trigger(\"change\");\n                    // document.getElementById(\"overlay\").className = \"superimposed-text-attendees\";\n                    // document.getElementById(\"overlay-text\").className = \"overlay-text-attendees\";\n                    break;\n        \n                case 'Participant1':\n                case 'Participant2':\n                    // $(\"#cam-instructions\").fadeIn(500);\n                    // $(\"#cam-image\").fadeIn(500);\n                    // $(\"#mic-instructions\").fadeIn(500);\n                    // $(\"#mic-image\").fadeIn(500);\n                    // $('#show-qr-code').fadeOut(500);\n                    // $('#get-prompt').fadeIn(500);\n                    // $('#my-view').fadeOut(500);\n                    // document.getElementById('my-view').style.visibility='hidden';\n                    // document.getElementById(\"overlay\").className = \"superimposed-text\";\n                    // document.getElementById(\"overlay-text\").className = \"overlay-text\";\n                    // displayName();\n                    // closeChat();\n                    break;\n        \n                case 'Actor1':\n                case 'Actor2':\n                case 'Room3A':\n                case 'Room3B':\n                case 'Room4A':\n                case 'Room4B':\n                case 'Room5A':\n                case 'Room5B':\n                    // $(\"#cam-instructions\").fadeIn(500);\n                    // $(\"#cam-image\").fadeIn(500);\n                    // $(\"#mic-instructions\").fadeIn(500);\n                    // $(\"#mic-image\").fadeIn(500);\n                    // $('#show-qr-code').fadeIn(500);\n                    // $('#get-prompt').fadeOut(500);\n                    // $('#my-view').fadeOut(500);\n                    // document.getElementById('my-view').style.visibility='hidden';\n                    // document.getElementById(\"overlay\").className = \"superimposed-text\";\n                    // document.getElementById(\"overlay-text\").className = \"overlay-text\";\n                    // displayName();\n                    // closeChat();\n                    break;\n                \n                default:\n                    break;\n            }\n        }\n          \n          async function pauseSession() {\n            // $(\"#cam-instructions\").fadeIn(500);\n            // $(\"#cam-image\").fadeIn(500);\n            // $(\"#mic-instructions\").fadeIn(500);\n            // $(\"#mic-image\").fadeIn(500);\n            // $('#show-qr-code').fadeIn(500);\n            // $('#get-prompt').fadeOut(500);\n            // document.getElementById('get-prompt').style.visibility='hidden';\n            // $('#my-view').fadeOut(500);\n            // if (window.camWasOn && !callObject.localVideo()) {toggleCam()}; // turn back on cam if it was noted as on before session\n          }\n\n\n      \n    } //end handleAppMessage\n\n    callObject.on('app-message', handleAppMessage);\n\n    return function cleanup() {\n      callObject.off('app-message', handleAppMessage);\n    };\n  }, [callObject]);\n\n  const updateSessionState = (newSessionState) => setSessionState(newSessionState);\n\n  /**\n   * Show the call UI if we're either joining, already joined, or are showing\n   * an error.\n   */\n  const showCall = [STATE_JOINING, STATE_JOINED, STATE_ERROR].includes(\n    appState\n  );\n\n  /**\n   * Only enable the call buttons (camera toggle, leave call, etc.) if we're joined\n   * or if we've errored out.\n   *\n   * !!!\n   * IMPORTANT: calling callObject.destroy() *before* we get the \"joined-meeting\"\n   * can result in unexpected behavior. Disabling the leave call button\n   * until then avoids this scenario.\n   * !!!\n   */\n  const enableCallButtons = [STATE_JOINED, STATE_ERROR].includes(appState);\n\n  /**\n   * Only enable the start button if we're in an idle state (i.e. not creating,\n   * joining, etc.).\n   *\n   * !!!\n   * IMPORTANT: only one call object is meant to be used at a time. Creating a\n   * new call object with DailyIframe.createCallObject() *before* your previous\n   * callObject.destroy() completely finishes can result in unexpected behavior.\n   * Disabling the start button until then avoids that scenario.\n   * !!!\n   */\n  const enableStartButton = appState === STATE_IDLE;\n\n  return (\n\n\n    <div className=\"app\">\n      <SessionStateContext.Provider \n      value={{session: [sessionState,setSessionState]}}\n      >\n        <MyContext.Provider \n        value={{myState: [my,setMy]}}\n        >\n\n        {(showCall) ? (\n          // NOTE: for an app this size, it's not obvious that using a Context\n          // is the best choice. But for larger apps with deeply-nested components\n          // that want to access call object state and bind event listeners to the\n          // call object, this can be a helpful pattern.\n          <CallObjectContext.Provider value={callObject}>\n\n            <Call roomUrl={roomUrl} />\n            <Tray\n              micDisabled={micDisabled}\n              camDisabled={camDisabled}\n              onClickLeaveCall={startLeavingCall}\n            />\n            {window.amAdmin && (\n          <AdminPanel\n        />\n        )}\n          </CallObjectContext.Provider>\n        ) : (\n          <StartScreen\n            // disabled={!enableStartButton}\n            onClick={() => {\n              createCall().then((url) => startJoiningCall(url));\n            }}\n          />\n        )}\n        </MyContext.Provider>\n      </SessionStateContext.Provider>\n    </div>\n\n\n  );\n}\n","export function sendState(sessionState,callObject) {\n    console.log (\"Sending current state...\");\n    callObject.sendAppMessage(sessionState, '*'); \n}\n\n\n","import React from 'react';\nimport './BrowserUnsupported.css';\n\nexport default function BrowserUnsupported() {\n  return (\n    <p class=\"browser-unsupported\">\n      Looks like you need to upgrade your browser to make Daily video calls.\n      <br />\n      See&nbsp;\n      <a href=\"https://docs.daily.co/docs/browsers\">this page</a>\n      &nbsp;for help getting on a supported browser version.\n    </p>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App/App';\nimport BrowserUnsupported from './components/BrowserUnsupported/BrowserUnsupported';\nimport DailyIframe from '@daily-co/daily-js';\n\nReactDOM.render(\n  DailyIframe.supportedBrowser().supported ? <App /> : <BrowserUnsupported />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}