{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/arlosb/Documents/GitHub/new react app/test3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";// import { useEffect } from \"react\";\n// import SessionContext from '../../SessionContext';\nexport default function setSubscriptions(callObject){var viewMode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!window.sessionState){return;}console.log('Setting subscriptions...');console.log('****My role is: '+window.myRole);console.log('viewMode is: '+viewMode);var subscribedTo=0;window.currentSubs=[];window.viewMode=viewMode;//if session is active, set currentSubs according to my role\nif(!viewMode&&window.sessionState.isActive){switch(window.myRole){case'Buyer1':window.currentSubs=[];window.sessionState.roleOf.Shadow1&&window.currentSubs.push(window.sessionState.roleOf.Shadow1);// see shadow1 if there is a shadow1\n!window.sessionState.roleOf.Shadow1&&window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller);//otherwise, see the original seller\nwindow.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Buyer2':window.currentSubs=[];window.sessionState.roleOf.Shadow1&&window.currentSubs.push(window.sessionState.roleOf.Shadow1);// see shadow1 if there is a shadow1\n!window.sessionState.roleOf.Shadow1&&window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller);//otherwise, see the original seller\nwindow.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Buyer3':window.currentSubs=[];window.sessionState.roleOf.Shadow1&&window.currentSubs.push(window.sessionState.roleOf.Shadow1);// see shadow1 if there is a shadow1\n!window.sessionState.roleOf.Shadow1&&window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller);//otherwise, see the original seller\nwindow.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);break;case'Seller':window.currentSubs=[];window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Shadow1':case'Shadow2':case'Shadow3':case'Shadow4':window.currentSubs=[];window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller+'_AUDIO');break;case'Attendee':window.currentSubs=[];break;default:window.currentSubs=[];break;}//Add Admin to currentSubs if applicable\nif(window.sessionState.AdminVisible){window.currentSubs.push(\"Admin\");}window.currentSubs.filter(function(str){return str.indexOf(window.myName)===-1;});//don't include self\n}if(viewMode){switch(viewMode){case'Seller':window.currentSubs=[];window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Shadow1':window.currentSubs=[];window.sessionState.roleOf.Shadow1&&window.currentSubs.push(window.sessionState.roleOf.Shadow1);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Shadow2':window.currentSubs=[];window.sessionState.roleOf.Shadow2&&window.currentSubs.push(window.sessionState.roleOf.Shadow2);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Shadow3':window.sessionState.roleOf.Shadow3&&window.currentSubs.push(window.sessionState.roleOf.Shadow3);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'Shadow4':window.currentSubs=[];window.sessionState.roleOf.Shadow4&&window.currentSubs.push(window.sessionState.roleOf.Shadow4);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;case'All':window.currentSubs=[];window.sessionState.roleOf.Seller&&window.currentSubs.push(window.sessionState.roleOf.Seller);window.sessionState.roleOf.Shadow1&&window.currentSubs.push(window.sessionState.roleOf.Shadow1);window.sessionState.roleOf.Shadow2&&window.currentSubs.push(window.sessionState.roleOf.Shadow2);window.sessionState.roleOf.Shadow3&&window.currentSubs.push(window.sessionState.roleOf.Shadow3);window.sessionState.roleOf.Shadow4&&window.currentSubs.push(window.sessionState.roleOf.Shadow4);window.sessionState.roleOf.Buyer1&&window.currentSubs.push(window.sessionState.roleOf.Buyer1);window.sessionState.roleOf.Buyer2&&window.currentSubs.push(window.sessionState.roleOf.Buyer2);window.sessionState.roleOf.Buyer3&&window.currentSubs.push(window.sessionState.roleOf.Buyer3);break;default:window.currentSubs=[];break;}window.currentSubs.filter(function(str){return str.indexOf(window.myName)===-1;});//don't include self\n}function setTracks(){return new Promise(function(resolve){//cycle through each participant in meeting\nvar ps=callObject.participants();// console.log('The second participant is named: ' + Object.values(ps)[1].user_name);\nObject.keys(ps).forEach(function(p){var participant=ps[p];var thisUserName=participant.user_name;if(p==='local'||thisUserName==window.myName){return;}//if SESSION STATE NOT KNOWN, don't subscribe to anyone yet\nif(!window.sessionState.isKnown){callObject.updateParticipant(participant.session_id,{setSubscribedTracks:false});return;}console.log(\"This username is: \"+thisUserName);//If NOT ACTIVE (and not setting view mode), subscribe to everyone in the meeting\nif(!window.sessionState.isActive&&!viewMode){//audio only if currently Seconding\n// if (window.myRole.includes('Actor')) {\n//     switch (window.myRole) {\n//         case 'Actor1':\n//                 if (thisUserName==window.sessionState.roleOf.Participant1 || thisUserName=='SUPERDUPER') {\n//                     console.log('Subscribing to audio only for: ' + thisUserName);\n//                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n//                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n//                 } else {\n//                     console.log('Subscribing to: ' + thisUserName);\n//                     window.currentSubs.push(thisUserName);\n//                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n//                     subscribedTo++;\n//                 }\n//             break;\n//         case 'Actor2':\n//             if (thisUserName==window.sessionState.roleOf.Participant2 || thisUserName=='SUPERDUPER') {\n//                 console.log('Subscribing to audio only for: ' + thisUserName);\n//                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n//                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n//             } else {\n//                 console.log('Subscribing to: ' + thisUserName);\n//                 window.currentSubs.push(thisUserName);\n//                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n//                 subscribedTo++;\n//             }\n//         break;\n//         default:\n//             break;\n//     }\n// }\n// // audio and video for everyone else\n// else {  \n// exclude screenshare's in-ear audio stream\nif(thisUserName=='SUPERDUPER'){console.log('Not subscribing to: '+thisUserName);callObject.updateParticipant(participant.session_id,{setSubscribedTracks:{audio:false,video:false,screenVideo:true,screenAudio:true}});}else{console.log('Subscribing to: '+thisUserName);window.currentSubs.push(thisUserName);// if (!callObject.participants()[participant.session_id].tracks.video.subscribed){ \n//     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});  \n// }\ncallObject.updateParticipant(participant.session_id,{setSubscribedTracks:true});subscribedTo++;}// }\n}//IF ACTIVE (or selecting viewmode), just subscribe to those listed in currentSubs;\nelse if(window.sessionState.isActive||viewMode){if(window.currentSubs.includes(thisUserName+'_AUDIO')){console.log('Subscribing to audio only for: '+thisUserName);callObject.updateParticipant(participant.session_id,{setSubscribedTracks:{audio:true,video:false,screenVideo:false}});}else if(window.currentSubs.includes(thisUserName)){console.log('Subscribing to: '+thisUserName);callObject.updateParticipant(participant.session_id,{setSubscribedTracks:true});subscribedTo++;}else if(!window.currentSubs.includes(thisUserName)){console.log('NOT subscribing to: '+thisUserName+', sessionID: '+participant.session_id);callObject.updateParticipant(participant.session_id,{setSubscribedTracks:false});}}});resolve();});}setTracks().then(function(){//remove screenshare widget from currentSubs array\nvar index=window.currentSubs.indexOf('SUPERDUPER');if(index>-1){window.currentSubs.splice(index,1);}//print subscriptions\nwindow.currentSubs.filter(function(str){return str.indexOf(window.myName)===-1;});//don't include self\nvar iterator=window.currentSubs.values();console.log(\"Currently subscribed to:\");var _iterator=_createForOfIteratorHelper(iterator),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var elements=_step.value;console.log(elements);}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(window.currentSubs.length<1){console.log(\"No one.\");}window.updateCall();viewMode=null;window.updateTray();window.updateTile();//if no admin (or admin has left), start asking for state\n// if (adminPresent==false) {\n//     window.sessionState.isKnown=false;\n//     if (typeof(stateRequest)!='undefined') {clearInterval(stateRequest);}\n//     stateRequest = setInterval(getState,2500);\n//     console.log('no Admin present');\n// }\n// if (subscribedTo==0) {\n//     window.isPopulated = false;\n//     document.getElementById('empty-room').style.opacity='1';\n//     if(!!document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='hidden';}\n//     if (window.sessionState.isActive==true) {\n//         document.getElementById('empty-text').innerHTML=\"Hold that thought! üòê <br><br> We're working to fix a connection problem.\"\n//     } else if (window.sessionState.isActive==false) {\n//         document.getElementById('empty-text').innerHTML=\"üëã <br>You're here!<br>Waiting for everyone else...\"\n//     }\n// } else if (subscribedTo>0) {\n//     window.isPopulated = true;\n//     document.getElementById('empty-room').style.opacity='0';\n//     if (document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){\n//         document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='visible';\n//     }\n// }\n});};","map":{"version":3,"sources":["/Users/arlosb/Documents/GitHub/new react app/test3/src/hooks/setSubscriptions.js"],"names":["setSubscriptions","callObject","viewMode","window","sessionState","console","log","myRole","subscribedTo","currentSubs","isActive","roleOf","Shadow1","push","Seller","Buyer2","Buyer3","Buyer1","AdminVisible","filter","str","indexOf","myName","Shadow2","Shadow3","Shadow4","setTracks","Promise","resolve","ps","participants","Object","keys","forEach","p","participant","thisUserName","user_name","isKnown","updateParticipant","session_id","setSubscribedTracks","audio","video","screenVideo","screenAudio","includes","then","index","splice","iterator","values","elements","length","updateCall","updateTray","updateTile"],"mappings":"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","sourcesContent":["// import { useEffect } from \"react\";\n// import SessionContext from '../../SessionContext';\n\nexport default function setSubscriptions(callObject,viewMode=null) {\n\n    if (!window.sessionState) {return;}\n\n    console.log('Setting subscriptions...');\n    console.log('****My role is: ' + window.myRole);\n    console.log('viewMode is: ' + viewMode);\n    let subscribedTo=0;\n    window.currentSubs=[];\n    window.viewMode = viewMode;\n    \n    //if session is active, set currentSubs according to my role\n        if (!viewMode && window.sessionState.isActive) {\n            switch (window.myRole) {\n                case 'Buyer1':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Buyer2':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Buyer3':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1); // see shadow1 if there is a shadow1\n                    !window.sessionState.roleOf.Shadow1 && window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller); //otherwise, see the original seller\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    break;\n                case 'Seller':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    break;\n                case 'Shadow1':\n                case 'Shadow2':\n                case 'Shadow3':\n                case 'Shadow4':\n                    window.currentSubs=[];\n                    window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                    window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                    window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                    window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller+'_AUDIO');\n                    break;\n                case 'Attendee':\n                    window.currentSubs=[];\n                    break;\n                default:\n                    window.currentSubs=[];\n                    break;\n            }\n            //Add Admin to currentSubs if applicable\n            if (window.sessionState.AdminVisible) {\n            window.currentSubs.push (\"Admin\");\n        }\n\n        window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n\n    }\n\n    if(viewMode) {\n\n        switch (viewMode) {\n            case 'Seller':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow1':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow2':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow2 && window.currentSubs.push(window.sessionState.roleOf.Shadow2);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow3':\n                window.sessionState.roleOf.Shadow3 && window.currentSubs.push(window.sessionState.roleOf.Shadow3);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'Shadow4':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Shadow4 && window.currentSubs.push(window.sessionState.roleOf.Shadow4);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            case 'All':\n                window.currentSubs=[];\n                window.sessionState.roleOf.Seller && window.currentSubs.push(window.sessionState.roleOf.Seller);\n                window.sessionState.roleOf.Shadow1 && window.currentSubs.push(window.sessionState.roleOf.Shadow1);\n                window.sessionState.roleOf.Shadow2 && window.currentSubs.push(window.sessionState.roleOf.Shadow2);\n                window.sessionState.roleOf.Shadow3 && window.currentSubs.push(window.sessionState.roleOf.Shadow3);\n                window.sessionState.roleOf.Shadow4 && window.currentSubs.push(window.sessionState.roleOf.Shadow4);\n                window.sessionState.roleOf.Buyer1 && window.currentSubs.push(window.sessionState.roleOf.Buyer1);\n                window.sessionState.roleOf.Buyer2 && window.currentSubs.push(window.sessionState.roleOf.Buyer2);\n                window.sessionState.roleOf.Buyer3 && window.currentSubs.push(window.sessionState.roleOf.Buyer3);\n                break;\n            default:\n                window.currentSubs=[];\n                break;\n        }\n\n        window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n    }\n\n    \n    function setTracks() {\n\n        return new Promise( (resolve) => {\n\n            //cycle through each participant in meeting\n            let ps = callObject.participants();\n            // console.log('The second participant is named: ' + Object.values(ps)[1].user_name);\n            Object.keys(ps).forEach((p) => {\n                let participant = ps[p];\n                let thisUserName = participant.user_name;\n\n                if (p === 'local' || thisUserName==window.myName) {\n                    return;\n                } \n\n    \n\n                //if SESSION STATE NOT KNOWN, don't subscribe to anyone yet\n                if (!window.sessionState.isKnown) {\n                    callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    return;\n                }\n\n\n\n                console.log(\"This username is: \" +thisUserName);\n                //If NOT ACTIVE (and not setting view mode), subscribe to everyone in the meeting\n                if (!window.sessionState.isActive && !viewMode) {\n\n                    //audio only if currently Seconding\n                    // if (window.myRole.includes('Actor')) {\n                    //     switch (window.myRole) {\n                    //         case 'Actor1':\n                    //                 if (thisUserName==window.sessionState.roleOf.Participant1 || thisUserName=='SUPERDUPER') {\n                    //                     console.log('Subscribing to audio only for: ' + thisUserName);\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n                    //                 } else {\n                    //                     console.log('Subscribing to: ' + thisUserName);\n                    //                     window.currentSubs.push(thisUserName);\n                    //                     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                    //                     subscribedTo++;\n                    //                 }\n                    //             break;\n                    //         case 'Actor2':\n                    //             if (thisUserName==window.sessionState.roleOf.Participant2 || thisUserName=='SUPERDUPER') {\n                    //                 console.log('Subscribing to audio only for: ' + thisUserName);\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: true, screenAudio:true}});\n                    //             } else {\n                    //                 console.log('Subscribing to: ' + thisUserName);\n                    //                 window.currentSubs.push(thisUserName);\n                    //                 callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                    //                 subscribedTo++;\n                    //             }\n                    //         break;\n                        \n                    //         default:\n                    //             break;\n                    //     }\n                    // }\n\n                    // // audio and video for everyone else\n                    // else {  \n                        // exclude screenshare's in-ear audio stream\n\n                        if (thisUserName=='SUPERDUPER') {\n                            console.log('Not subscribing to: ' + thisUserName);\n                            callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: false, video: false, screenVideo: true, screenAudio: true}});\n\n                        \n                        } else {\n                            console.log('Subscribing to: ' + thisUserName);\n                            window.currentSubs.push(thisUserName);\n                            // if (!callObject.participants()[participant.session_id].tracks.video.subscribed){ \n                            //     callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});  \n                            // }\n                            callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                            subscribedTo++;\n                            }    \n\n                    // }\n\n\n\n                } \n\n                //IF ACTIVE (or selecting viewmode), just subscribe to those listed in currentSubs;\n                else if (window.sessionState.isActive || viewMode) {\n                    if(window.currentSubs.includes(thisUserName+'_AUDIO')) {\n                        console.log('Subscribing to audio only for: ' + thisUserName);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : { audio: true, video: false, screenVideo: false}});\n                    }\n                    else if(window.currentSubs.includes(thisUserName)) {\n                        console.log('Subscribing to: ' + thisUserName);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : true});\n                        subscribedTo++;\n                    }\n                    else if (!window.currentSubs.includes(thisUserName)) {\n                        console.log('NOT subscribing to: ' + thisUserName + ', sessionID: ' + participant.session_id);\n                        callObject.updateParticipant(participant.session_id,{ setSubscribedTracks : false});\n                    }\n                }\n            });\n            resolve();\n        })\n    }\n    \n    setTracks().then(()=>{\n        \n        //remove screenshare widget from currentSubs array\n        const index = window.currentSubs.indexOf('SUPERDUPER');\n        if (index > -1) {\n          window.currentSubs.splice(index, 1);\n        }\n    //print subscriptions\n\n    window.currentSubs.filter(function (str) {return str.indexOf(window.myName) === -1}) //don't include self\n\n    var iterator = window.currentSubs.values();\n    console.log(\"Currently subscribed to:\");\n    for (let elements of iterator) { \n        console.log(elements); \n    } \n    if (window.currentSubs.length < 1) {\n        console.log (\"No one.\")\n    }\n    window.updateCall();\n    viewMode=null;\n    window.updateTray();\n    window.updateTile();\n\n\n        //if no admin (or admin has left), start asking for state\n        // if (adminPresent==false) {\n        //     window.sessionState.isKnown=false;\n        //     if (typeof(stateRequest)!='undefined') {clearInterval(stateRequest);}\n        //     stateRequest = setInterval(getState,2500);\n        //     console.log('no Admin present');\n        // }\n        // if (subscribedTo==0) {\n        //     window.isPopulated = false;\n        //     document.getElementById('empty-room').style.opacity='1';\n        //     if(!!document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='hidden';}\n        //     if (window.sessionState.isActive==true) {\n        //         document.getElementById('empty-text').innerHTML=\"Hold that thought! üòê <br><br> We're working to fix a connection problem.\"\n        //     } else if (window.sessionState.isActive==false) {\n        //         document.getElementById('empty-text').innerHTML=\"üëã <br>You're here!<br>Waiting for everyone else...\"\n\n        //     }\n        // } else if (subscribedTo>0) {\n        //     window.isPopulated = true;\n        //     document.getElementById('empty-room').style.opacity='0';\n        //     if (document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\")){\n        //         document.querySelector(\"#root > div > div.daily-videos-wrapper > div.daily-video-div.remote.cam.cam-muted.mic-muted\").style.visibility='visible';\n        //     }\n\n        // }\n\n    })\n\n    \n   \n};\n\n"]},"metadata":{},"sourceType":"module"}