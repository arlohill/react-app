{"ast":null,"code":"import _slicedToArray from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import CallObjectContext from'../../../CallObjectContext';import'./InputSelector.css';export default React.forwardRef(function(props,ref){var callObject=useContext(CallObjectContext);var audioInputSelect=React.createRef();var videoSelect=React.createRef();var type=props.type;var page=props.page;var handleClick=function handleClick(e){if(!e.target.value){return;}var selectionID=e.target.value;type=='audio'&&page=='main'&&e.target.key.includes('audioinput')&&callObject.setInputDevicesAsync({audioSource:selectionID});// type == 'audio' && page=='main' && e.target.key.includes('audiooutput') && callObject.setOutputDevice({selectionID});\ntype=='video'&&page=='main'&&callObject.setInputDevicesAsync({videoSource:selectionID});if(type=='audio'&&page=='intro'){var _props$inputs=_slicedToArray(props.inputs,2),initialInputs=_props$inputs[0],setInitialInputs=_props$inputs[1];var constraints={deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({audio:constraints}).then(function(mediaStream){var newAudioSource=mediaStream.getAudioTracks()[0];setInitialInputs(function(prev){return[newAudioSource,prev[1]];});});}if(type=='video'&&page=='intro'){var _props$inputs2=_slicedToArray(props.inputs,2),_initialInputs=_props$inputs2[0],_setInitialInputs=_props$inputs2[1];var _constraints={width:1280,height:720,deviceId:{exact:selectionID}};navigator.mediaDevices.getUserMedia({video:_constraints}).then(function(mediaStream){var newVideoSource=mediaStream.getVideoTracks()[0];_setInitialInputs(function(prev){return[prev[0],newVideoSource];});});}e.target.key.includes('input')&&console.log('New input: '+e.target.text);// e.target.key.includes('output') && console.log('New output: ' + e.target.text);\n};useEffect(function(){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){navigator.mediaDevices.enumerateDevices().then(function(deviceInfos){if(type=='audio'&&audioInputSelect.current){if(audioInputSelect.current.hasChildNodes()){return;}var audioInputs=[];var audioOutputs=[];for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='audioinput'){option.key='audioinput'+audioInputSelect.length+1;option.text=deviceInfo.label||'Microphone '+(audioInputSelect.length+1);audioInputs.push(option);}// else if (deviceInfo.kind === 'audiooutput') {\n//     option.key = 'audiooutput' + audioInputSelect.length + 1;\n//     option.text = deviceInfo.label || 'Speaker ' +(audioInputSelect.length + 1);\n//     audioOutputs.push(option);\n//     }   \n}window.audioOutputs=audioOutputs;var micHeading=document.createElement('option');micHeading.label='-Select Microphone-';micHeading.className='item-heading';var speakerHeading=document.createElement('option');// speakerHeading.label = '-Select Speaker-';\n// speakerHeading.className='item-heading';\naudioInputSelect.current.appendChild(micHeading);for(var i=0;i!==audioInputs.length;++i){audioInputSelect.current.appendChild(audioInputs[i]);}// audioInputSelect.current.appendChild(speakerHeading);\n// for (var i=0; i!==audioOutputs.length; ++i) {\n//     console.log(audioOutputs[i]);\n//     audioInputSelect.current.appendChild(audioOutputs[i]);\n// }\n}else if(type=='video'&&videoSelect.current){if(videoSelect.current.hasChildNodes()){return;}var camHeading=document.createElement('option');camHeading.label='-Select Camera-';camHeading.className='item-heading';videoSelect.current.appendChild(camHeading);for(var i=0;i!==deviceInfos.length;++i){var deviceInfo=deviceInfos[i];var option=document.createElement('option');option.className='item';option.value=deviceInfo.deviceId;if(deviceInfo.kind==='videoinput'){option.key='videooutput'+videoSelect.length+1;option.text=deviceInfo.label||'Camera '+(videoSelect.length+1);videoSelect.current&&videoSelect.current.appendChild(option);}}}}).catch(function(err){console.log(err.name+\": \"+err.message);});}});return/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-selector\",ref:ref},type=='audio'&&/*#__PURE__*/React.createElement(\"ul\",{ref:audioInputSelect,onClick:handleClick}),type=='video'&&/*#__PURE__*/React.createElement(\"ul\",{ref:videoSelect,onClick:handleClick}));});","map":null,"metadata":{},"sourceType":"module"}