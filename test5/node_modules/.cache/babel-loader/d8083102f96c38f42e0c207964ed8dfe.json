{"ast":null,"code":"import _objectSpread from\"/Users/arlosb/Documents/GitHub/new react app/test3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"/Users/arlosb/Documents/GitHub/new react app/test3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/Users/arlosb/Documents/GitHub/new react app/test3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import CallObjectContext from'../../CallObjectContext';import{logDailyEvent}from'../../logUtils';import'./AdminPanel.css';import setSubscriptions from'../../hooks/setSubscriptions';import audioPlayer from'../../hooks/AudioPlayer';import RoleSelector from'../RoleSelector/RoleSelector';import RoleContainer from'../RoleContainer/RoleContainer';import SessionStateContext from'../../SessionStateContext';// import { sendState } from '../AdminPanel/AdminFunctions'\n// import SessionContext from '../../SessionContext';\nfunction useForceUpdate(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];// integer state\nreturn function(){return setValue(function(value){return value+1;});};// update the state to force render\n}/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */function getStreamStates(callObject){var isCameraMuted,isMicMuted,isSharingScreen=false;if(callObject&&callObject.participants()&&callObject.participants().local){var localParticipant=callObject.participants().local;isCameraMuted=!localParticipant.video;isMicMuted=!localParticipant.audio;isSharingScreen=localParticipant.screen;}return[isCameraMuted,isMicMuted,isSharingScreen];}/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */export default function AdminPanel(props){var callObject=useContext(CallObjectContext);// const [sessionState, setSessionState ] = useContext(SessionContext);\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isCameraMuted=_useState4[0],setCameraMuted=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isMicMuted=_useState6[0],setMicMuted=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSharingScreen=_useState8[0],setSharingScreen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),displayChat=_useState10[0],setChatDisplay=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),highlightedChat=_useState12[0],setChatHighlight=_useState12[1];var _useContext=useContext(SessionStateContext),session=_useContext.session;var _session=_slicedToArray(session,2),sessionState=_session[0],setSessionState=_session[1];var setSubs=function setSubs(){setSubscriptions(callObject);};var forceUpdate=useForceUpdate();window.updateAdminPanel=forceUpdate;var _useState13=useState('Play'),_useState14=_slicedToArray(_useState13,2),playButtonText=_useState14[0],setPlayButtonText=_useState14[1];var _useState15=useState('monologue1'),_useState16=_slicedToArray(_useState15,2),targetRecording=_useState16[0],setTargetRecording=_useState16[1];///////HAVE TO CHANGE THIS IN TWO PLACES\nvar training=React.createRef();var trainingToggle=React.createRef();useEffect(function(){//listen for participants leaving or joining and update component\nif(!callObject)return;var events=['participant-joined','participant-left','joined-meeting'];for(var _i=0,_events=events;_i<_events.length;_i++){var event=_events[_i];callObject.on(event,function(){return setTimeout(function(){return forceUpdate();},100);});}return function cleanup(){var _iterator=_createForOfIteratorHelper(events),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _event=_step.value;callObject.off(_event,function(){return setTimeout(function(){return forceUpdate();},100);});}}catch(err){_iterator.e(err);}finally{_iterator.f();}};},[callObject]);var sendState=function sendState(){console.log(\"Sending current state...\");callObject.sendAppMessage(window.sessionState,'*');};useEffect(function(){window.sendState=sendState;},[sendState]);function toggleSessionActive(){setSessionState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isActive:!prevState.isActive});});window.sessionState.isActive=!window.sessionState.isActive;sendState();if(window.sessionState.isActive&&!window.myRole.includes('Shadow')&&!window.myRole.includes('Seller')&&!window.myRole.includes('Buyer')){setSubscriptions(callObject,'Shadow1');window.viewMode='Shadow1';callObject.setLocalVideo(false);callObject.setLocalAudio(false);}else{setSubs();}if(!window.sessionState.isActive){callObject.setLocalVideo(true);callObject.setLocalAudio(true);}}function togglePractice(){var recipientA=window.sessionState.roleOf.Shadow1&&window[window.sessionState.roleOf.Shadow1+'_SessionID'];var recipientB=window.sessionState.roleOf.Shadow2&&window[window.sessionState.roleOf.Shadow2+'_SessionID'];if(window.sessionState.roleOf.Shadow1==window.myName){recipientA='me';}if(window.sessionState.roleOf.Shadow2==window.myName){recipientB='me';}if(!recipientA&&!recipientB){console.log('no recipients.');return;}var action=window.audioIsPlaying?'pause':'play';var instructionsA={type:'instructions',target:targetRecording,action:action,recipient:recipientA};var instructionsB={type:'instructions',target:targetRecording+'B',action:action,recipient:recipientB};if(recipientA){if(recipientA!='me'){callObject.sendAppMessage(instructionsA,recipientA);}else if(recipientA=='me'){audioPlayer(targetRecording,action);}console.log(\"Sent \".concat(action,\" request to \").concat(window.sessionState.roleOf.Shadow1));}if(recipientB){if(recipientB!='me'){callObject.sendAppMessage(instructionsB,recipientB);}else if(recipientB=='me'){audioPlayer(targetRecording+'B',action);}console.log(\"Sent \".concat(action,\" request to \").concat(window.sessionState.roleOf.Shadow2));}window.audioIsPlaying=!window.audioIsPlaying;setPlayButtonText(!window.audioIsPlaying?'Play':'Pause');}function toggleTrainingMode(){training.current.classList.toggle('hidden');trainingToggle.current.innerText=training.current.classList.contains('hidden')?'Show Practice':'X';}/**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */useEffect(function(){if(!callObject)return;function handleNewParticipantsState(event){event&&logDailyEvent(event);var _getStreamStates=getStreamStates(callObject),_getStreamStates2=_slicedToArray(_getStreamStates,3),isCameraMuted=_getStreamStates2[0],isMicMuted=_getStreamStates2[1],isSharingScreen=_getStreamStates2[2];setCameraMuted(isCameraMuted);setMicMuted(isMicMuted);setSharingScreen(isSharingScreen);}// Use initial state\nhandleNewParticipantsState();// Listen for changes in state\ncallObject.on('participant-updated',handleNewParticipantsState);// Stop listening for changes in state\nreturn function cleanup(){callObject.off('participant-updated',handleNewParticipantsState);};},[callObject]);/* // Play practice audio for users */return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"admin-panel\"},/*#__PURE__*/React.createElement(\"div\",{className:\"role-selector-section\"},/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Buyer(s)\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer1\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer2\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer3\",selectedRoles:\"selectedRoles\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Seller\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Seller\",selectedRoles:\"selectedRoles\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Seller's shadow(s)\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow1\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow2\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow3\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow4\",selectedRoles:\"selectedRoles\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"session-toggle\"},/*#__PURE__*/React.createElement(\"label\",{class:\"switch\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",id:\"state\",checked:sessionState.isActive,onChange:toggleSessionActive}),/*#__PURE__*/React.createElement(\"span\",{class:\"slider round\"})),/*#__PURE__*/React.createElement(\"p\",null,\"Session active\"))),\"// ***End admin panel***\",/*#__PURE__*/React.createElement(\"div\",{className:\"practice-audio hidden\",ref:training},\"Practice audio\",/*#__PURE__*/React.createElement(\"div\",{style:{height:'30px',margin:'auto'}},/*#__PURE__*/React.createElement(\"form\",{action:\"\"},/*#__PURE__*/React.createElement(\"fieldset\",{style:{border:'none'}},/*#__PURE__*/React.createElement(\"select\",{class:\"practice-audio-dropdown\",onChange:function onChange(e){setTargetRecording(e.target.value);console.log('***CHANGED TO '+e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"monologue1\"},\"What makes CEB different (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue2\"},\"Searching for PAGA Claims (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue3\"},\"Audio Engineer (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue4\"},\"IBM Garage (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue1\"},\"Ethics (dialogue)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue2\"},\"CoursePass (dialogue)\"))))),/*#__PURE__*/React.createElement(\"span\",{style:{color:'green',fontSize:'16px',fontFamily:'Verdana, Geneva, Tahoma, sans-serif'}},/*#__PURE__*/React.createElement(\"button\",{onClick:togglePractice,id:\"play-pause\"},playButtonText))),/*#__PURE__*/React.createElement(\"div\",{className:\"training-toggle\",ref:trainingToggle,onClick:toggleTrainingMode},\"Show Practice\"));}","map":{"version":3,"sources":["/Users/arlosb/Documents/GitHub/new react app/test3/src/components/AdminPanel/AdminPanel.js"],"names":["React","useContext","useEffect","useState","CallObjectContext","logDailyEvent","setSubscriptions","audioPlayer","RoleSelector","RoleContainer","SessionStateContext","useForceUpdate","value","setValue","getStreamStates","callObject","isCameraMuted","isMicMuted","isSharingScreen","participants","local","localParticipant","video","audio","screen","AdminPanel","props","setCameraMuted","setMicMuted","setSharingScreen","displayChat","setChatDisplay","highlightedChat","setChatHighlight","session","sessionState","setSessionState","setSubs","forceUpdate","window","updateAdminPanel","playButtonText","setPlayButtonText","targetRecording","setTargetRecording","training","createRef","trainingToggle","events","event","on","setTimeout","cleanup","off","sendState","console","log","sendAppMessage","toggleSessionActive","prevState","isActive","myRole","includes","viewMode","setLocalVideo","setLocalAudio","togglePractice","recipientA","roleOf","Shadow1","recipientB","Shadow2","myName","action","audioIsPlaying","instructionsA","type","target","recipient","instructionsB","toggleTrainingMode","current","classList","toggle","innerText","contains","handleNewParticipantsState","height","margin","border","e","color","fontSize","fontFamily"],"mappings":"khBAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,SAA5B,CAAuCC,QAAvC,KAAuD,OAAvD,CACA,MAAOC,CAAAA,iBAAP,KAA8B,yBAA9B,CACA,OAASC,aAAT,KAA8B,gBAA9B,CACA,MAAO,kBAAP,CACA,MAAOC,CAAAA,gBAAP,KAA6B,8BAA7B,CACA,MAAOC,CAAAA,WAAP,KAAwB,yBAAxB,CACA,MAAOC,CAAAA,YAAP,KAAyB,8BAAzB,CACA,MAAOC,CAAAA,aAAP,KAA0B,gCAA1B,CACA,MAAOC,CAAAA,mBAAP,KAAgC,2BAAhC,CAEA;AACA;AAIA,QAASC,CAAAA,cAAT,EAAyB,eACGR,QAAQ,CAAC,CAAD,CADX,wCAChBS,KADgB,eACTC,QADS,eACgB;AACvC,MAAO,kBAAMA,CAAAA,QAAQ,CAAC,SAAAD,KAAK,QAAIA,CAAAA,KAAK,CAAG,CAAZ,EAAN,CAAd,EAAP,CAA2C;AAC5C,CAID;AACA;AACA;AACA;AACA,GACA,QAASE,CAAAA,eAAT,CAAyBC,UAAzB,CAAqC,CACnC,GAAIC,CAAAA,aAAJ,CACEC,UADF,CAEEC,eAAe,CAAG,KAFpB,CAGA,GACEH,UAAU,EACVA,UAAU,CAACI,YAAX,EADA,EAEAJ,UAAU,CAACI,YAAX,GAA0BC,KAH5B,CAIE,CACA,GAAMC,CAAAA,gBAAgB,CAAGN,UAAU,CAACI,YAAX,GAA0BC,KAAnD,CACAJ,aAAa,CAAG,CAACK,gBAAgB,CAACC,KAAlC,CACAL,UAAU,CAAG,CAACI,gBAAgB,CAACE,KAA/B,CACAL,eAAe,CAAGG,gBAAgB,CAACG,MAAnC,CACD,CACD,MAAO,CAACR,aAAD,CAAgBC,UAAhB,CAA4BC,eAA5B,CAAP,CACD,CAID;AACA;AACA;AACA;AACA,GACA,cAAe,SAASO,CAAAA,UAAT,CAAoBC,KAApB,CAA2B,CACxC,GAAMX,CAAAA,UAAU,CAAGd,UAAU,CAACG,iBAAD,CAA7B,CACA;AAFwC,eAGAD,QAAQ,CAAC,KAAD,CAHR,yCAGjCa,aAHiC,eAGlBW,cAHkB,8BAINxB,QAAQ,CAAC,KAAD,CAJF,yCAIjCc,UAJiC,eAIrBW,WAJqB,8BAKIzB,QAAQ,CAAC,KAAD,CALZ,yCAKjCe,eALiC,eAKhBW,gBALgB,8BAMF1B,QAAQ,CAAC,KAAD,CANN,0CAMjC2B,WANiC,gBAMpBC,cANoB,gCAOI5B,QAAQ,CAAC,KAAD,CAPZ,2CAOjC6B,eAPiC,gBAOhBC,gBAPgB,gCAQpBhC,UAAU,CAACS,mBAAD,CARU,CAQhCwB,OARgC,aAQhCA,OARgC,6BASAA,OATA,IAShCC,YATgC,aASnBC,eATmB,aAUxC,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CAAC/B,gBAAgB,CAACS,UAAD,CAAhB,CAA6B,CAApD,CACA,GAAMuB,CAAAA,WAAW,CAAG3B,cAAc,EAAlC,CACA4B,MAAM,CAACC,gBAAP,CAAwBF,WAAxB,CAZwC,gBAaInC,QAAQ,CAAC,MAAD,CAbZ,2CAajCsC,cAbiC,gBAajBC,iBAbiB,gCAcMvC,QAAQ,CAAC,YAAD,CAdd,2CAcjCwC,eAdiC,gBAchBC,kBAdgB,gBAc6B;AACrE,GAAMC,CAAAA,QAAQ,CAAG7C,KAAK,CAAC8C,SAAN,EAAjB,CACA,GAAMC,CAAAA,cAAc,CAAG/C,KAAK,CAAC8C,SAAN,EAAvB,CAEA5C,SAAS,CAAC,UAAM,CAAY;AAC1B,GAAI,CAACa,UAAL,CAAiB,OAEjB,GAAMiC,CAAAA,MAAM,CAAG,CACb,oBADa,CAEb,kBAFa,CAGb,gBAHa,CAAf,CAMA,qBAAoBA,MAApB,wBAA4B,CAAvB,GAAMC,CAAAA,KAAK,YAAX,CACHlC,UAAU,CAACmC,EAAX,CAAcD,KAAd,CAAqB,iBAAME,CAAAA,UAAU,CAAC,iBAAIb,CAAAA,WAAW,EAAf,EAAD,CAAmB,GAAnB,CAAhB,EAArB,EACD,CAED,MAAO,SAASc,CAAAA,OAAT,EAAmB,0CACJJ,MADI,YACxB,+CAA4B,IAAjBC,CAAAA,MAAiB,aAC1BlC,UAAU,CAACsC,GAAX,CAAeJ,MAAf,CAAsB,iBAAME,CAAAA,UAAU,CAAC,iBAAIb,CAAAA,WAAW,EAAf,EAAD,CAAmB,GAAnB,CAAhB,EAAtB,EACD,CAHuB,qDAIzB,CAJD,CAMD,CAnBQ,CAmBN,CAACvB,UAAD,CAnBM,CAAT,CAuBF,GAAMuC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBC,OAAO,CAACC,GAAR,CAAa,0BAAb,EACAzC,UAAU,CAAC0C,cAAX,CAA0BlB,MAAM,CAACJ,YAAjC,CAA+C,GAA/C,EACH,CAHD,CAKEjC,SAAS,CAAC,UAAK,CACbqC,MAAM,CAACe,SAAP,CAAmBA,SAAnB,CACD,CAFQ,CAEP,CAACA,SAAD,CAFO,CAAT,CAKA,QAASI,CAAAA,mBAAT,EAA+B,CAC7BtB,eAAe,CAAC,SAACuB,SAAD,wCACXA,SADW,MAEdC,QAAQ,CAAE,CAACD,SAAS,CAACC,QAFP,IAAD,CAAf,CAIArB,MAAM,CAACJ,YAAP,CAAoByB,QAApB,CAA6B,CAACrB,MAAM,CAACJ,YAAP,CAAoByB,QAAlD,CACAN,SAAS,GACT,GAAIf,MAAM,CAACJ,YAAP,CAAoByB,QAApB,EAAgC,CAACrB,MAAM,CAACsB,MAAP,CAAcC,QAAd,CAAuB,QAAvB,CAAjC,EAAqE,CAACvB,MAAM,CAACsB,MAAP,CAAcC,QAAd,CAAuB,QAAvB,CAAtE,EAA0G,CAACvB,MAAM,CAACsB,MAAP,CAAcC,QAAd,CAAuB,OAAvB,CAA/G,CACA,CACExD,gBAAgB,CAACS,UAAD,CAAY,SAAZ,CAAhB,CACAwB,MAAM,CAACwB,QAAP,CAAgB,SAAhB,CACAhD,UAAU,CAACiD,aAAX,CAAyB,KAAzB,EACAjD,UAAU,CAACkD,aAAX,CAAyB,KAAzB,EACD,CAND,IAOK,CACH5B,OAAO,GACR,CACD,GAAI,CAACE,MAAM,CAACJ,YAAP,CAAoByB,QAAzB,CAAmC,CACjC7C,UAAU,CAACiD,aAAX,CAAyB,IAAzB,EACAjD,UAAU,CAACkD,aAAX,CAAyB,IAAzB,EACD,CACF,CAED,QAASC,CAAAA,cAAT,EAA0B,CACxB,GAAIC,CAAAA,UAAU,CAAG5B,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BC,OAA3B,EAAsC9B,MAAM,CAACA,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BC,OAA3B,CAAqC,YAAtC,CAA7D,CACA,GAAIC,CAAAA,UAAU,CAAG/B,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BG,OAA3B,EAAsChC,MAAM,CAACA,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BG,OAA3B,CAAqC,YAAtC,CAA7D,CACA,GAAGhC,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BC,OAA3B,EAAoC9B,MAAM,CAACiC,MAA9C,CAAsD,CAACL,UAAU,CAAC,IAAX,CAAgB,CACvE,GAAG5B,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BG,OAA3B,EAAoChC,MAAM,CAACiC,MAA9C,CAAsD,CAACF,UAAU,CAAC,IAAX,CAAgB,CAEvE,GAAI,CAACH,UAAD,EAAe,CAACG,UAApB,CAAgC,CAACf,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA+B,OAAO,CAEvE,GAAMiB,CAAAA,MAAM,CAAGlC,MAAM,CAACmC,cAAP,CAAwB,OAAxB,CAAkC,MAAjD,CACA,GAAMC,CAAAA,aAAa,CAAG,CACpBC,IAAI,CAAE,cADc,CAEpBC,MAAM,CAAElC,eAFY,CAGpB8B,MAAM,CAAEA,MAHY,CAIpBK,SAAS,CAAEX,UAJS,CAAtB,CAMA,GAAMY,CAAAA,aAAa,CAAG,CACpBH,IAAI,CAAE,cADc,CAEpBC,MAAM,CAAElC,eAAe,CAAG,GAFN,CAGpB8B,MAAM,CAAEA,MAHY,CAIpBK,SAAS,CAAER,UAJS,CAAtB,CAOA,GAAIH,UAAJ,CAAgB,CACd,GAAGA,UAAU,EAAE,IAAf,CAAqB,CACnBpD,UAAU,CAAC0C,cAAX,CAA0BkB,aAA1B,CAAwCR,UAAxC,EACD,CAFD,IAGK,IAAGA,UAAU,EAAE,IAAf,CAAqB,CACxB5D,WAAW,CAACoC,eAAD,CAAiB8B,MAAjB,CAAX,CACD,CACDlB,OAAO,CAACC,GAAR,gBAAoBiB,MAApB,wBAAyClC,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BC,OAApE,GACD,CACD,GAAIC,UAAJ,CAAgB,CACd,GAAGA,UAAU,EAAE,IAAf,CAAqB,CACnBvD,UAAU,CAAC0C,cAAX,CAA0BsB,aAA1B,CAAwCT,UAAxC,EACD,CAFD,IAGK,IAAGA,UAAU,EAAE,IAAf,CAAqB,CACxB/D,WAAW,CAACoC,eAAe,CAAC,GAAjB,CAAqB8B,MAArB,CAAX,CACD,CACDlB,OAAO,CAACC,GAAR,gBAAoBiB,MAApB,wBAAyClC,MAAM,CAACJ,YAAP,CAAoBiC,MAApB,CAA2BG,OAApE,GACD,CAEDhC,MAAM,CAACmC,cAAP,CAAuB,CAACnC,MAAM,CAACmC,cAA/B,CACAhC,iBAAiB,CAAC,CAACH,MAAM,CAACmC,cAAR,CAAyB,MAAzB,CAAkC,OAAnC,CAAjB,CAGD,CAGD,QAASM,CAAAA,kBAAT,EAA+B,CAC7BnC,QAAQ,CAACoC,OAAT,CAAiBC,SAAjB,CAA2BC,MAA3B,CAAkC,QAAlC,EACApC,cAAc,CAACkC,OAAf,CAAuBG,SAAvB,CAAmCvC,QAAQ,CAACoC,OAAT,CAAiBC,SAAjB,CAA2BG,QAA3B,CAAoC,QAApC,EAAgD,eAAhD,CAAkE,GAArG,CACD,CAUD;AACF;AACA;AACA,KACEnF,SAAS,CAAC,UAAM,CACd,GAAI,CAACa,UAAL,CAAiB,OAEjB,QAASuE,CAAAA,0BAAT,CAAoCrC,KAApC,CAA2C,CACzCA,KAAK,EAAI5C,aAAa,CAAC4C,KAAD,CAAtB,CADyC,qBAEYnC,eAAe,CAClEC,UADkE,CAF3B,sDAElCC,aAFkC,sBAEnBC,UAFmB,sBAEPC,eAFO,sBAKzCS,cAAc,CAACX,aAAD,CAAd,CACAY,WAAW,CAACX,UAAD,CAAX,CACAY,gBAAgB,CAACX,eAAD,CAAhB,CACD,CAED;AACAoE,0BAA0B,GAE1B;AACAvE,UAAU,CAACmC,EAAX,CAAc,qBAAd,CAAqCoC,0BAArC,EAEA;AACA,MAAO,SAASlC,CAAAA,OAAT,EAAmB,CACxBrC,UAAU,CAACsC,GAAX,CAAe,qBAAf,CAAsCiC,0BAAtC,EACD,CAFD,CAGD,CAvBQ,CAuBN,CAACvE,UAAD,CAvBM,CAAT,CA0BE,sCAIF,mBACF,4CACE,2BAAK,SAAS,CAAC,aAAf,eAGI,2BAAK,SAAS,CAAC,uBAAf,eAII,2BAAK,SAAS,CAAC,cAAf,0BAGI,oBAAC,YAAD,EACE,IAAI,CAAC,QADP,CAEE,aAAa,CAAC,eAFhB,EAHJ,cAOI,oBAAC,YAAD,EACE,IAAI,CAAC,QADP,CAEE,aAAa,CAAC,eAFhB,EAPJ,cAWI,oBAAC,YAAD,EACE,IAAI,CAAC,QADP,CAEE,aAAa,CAAC,eAFhB,EAXJ,CAJJ,cAsBI,2BAAK,SAAS,CAAC,cAAf,wBAEI,oBAAC,YAAD,EACI,IAAI,CAAC,QADT,CAEI,aAAa,CAAC,eAFlB,EAFJ,CAtBJ,cA+BI,2BAAK,SAAS,CAAC,cAAf,oCAEI,oBAAC,YAAD,EACI,IAAI,CAAC,SADT,CAEI,aAAa,CAAC,eAFlB,EAFJ,cAMM,oBAAC,YAAD,EACE,IAAI,CAAC,SADP,CAEE,aAAa,CAAC,eAFhB,EANN,cAUM,oBAAC,YAAD,EACE,IAAI,CAAC,SADP,CAEE,aAAa,CAAC,eAFhB,EAVN,cAcM,oBAAC,YAAD,EACE,IAAI,CAAC,SADP,CAEE,aAAa,CAAC,eAFhB,EAdN,CA/BJ,CAHJ,cAyEM,2BAAK,SAAS,CAAC,gBAAf,eACgB,6BAAO,KAAK,CAAC,QAAb,eACI,6BAAO,IAAI,CAAC,UAAZ,CAAuB,EAAE,CAAC,OAA1B,CAAkC,OAAO,CAAEoB,YAAY,CAACyB,QAAxD,CAAkE,QAAQ,CAAEF,mBAA5E,EADJ,cAEI,4BAAM,KAAK,CAAC,cAAZ,EAFJ,CADhB,cAKgB,8CALhB,CAzEN,CADF,yCA2FA,2BAAK,SAAS,CAAC,uBAAf,CAAuC,GAAG,CAAEb,QAA5C,gCAIoB,2BAAK,KAAK,CAAE,CAAC0C,MAAM,CAAC,MAAR,CAAeC,MAAM,CAAC,MAAtB,CAAZ,eACA,4BAAM,MAAM,CAAG,EAAf,eACI,gCAAU,KAAK,CAAE,CAACC,MAAM,CAAC,MAAR,CAAjB,eACA,8BAAQ,KAAK,CAAC,yBAAd,CAAwC,QAAQ,CAAE,kBAACC,CAAD,CAAO,CAAC9C,kBAAkB,CAAE8C,CAAC,CAACb,MAAF,CAASjE,KAAX,CAAlB,CAAqC2C,OAAO,CAACC,GAAR,CAAY,iBAAmBkC,CAAC,CAACb,MAAF,CAASjE,KAAxC,EAA+C,CAA9I,eAEA,8BAAQ,KAAK,CAAG,YAAhB,oCAFA,cAIA,8BAAQ,KAAK,CAAG,YAAhB,qCAJA,cAKA,8BAAQ,KAAK,CAAG,YAAhB,0BALA,cAMA,8BAAQ,KAAK,CAAG,YAAhB,sBANA,cAOA,8BAAQ,KAAK,CAAG,WAAhB,sBAPA,cAQA,8BAAQ,KAAK,CAAG,WAAhB,0BARA,CADA,CADJ,CADA,CAJpB,cAoBkB,4BAAM,KAAK,CAAE,CAAC+E,KAAK,CAAE,OAAR,CAAiBC,QAAQ,CAAE,MAA3B,CAAmCC,UAAU,CAAC,qCAA9C,CAAb,eACI,8BAAQ,OAAO,CAAE3B,cAAjB,CAAiC,EAAE,CAAC,YAApC,EAAkDzB,cAAlD,CADJ,CApBlB,CA3FA,cAsHA,2BAAK,SAAS,CAAC,iBAAf,CAAiC,GAAG,CAAEM,cAAtC,CAAsD,OAAO,CAAEiC,kBAA/D,kBAtHA,CADE,CA4HD","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport CallObjectContext from '../../CallObjectContext';\nimport { logDailyEvent } from '../../logUtils';\nimport './AdminPanel.css';\nimport setSubscriptions from '../../hooks/setSubscriptions';\nimport audioPlayer from '../../hooks/AudioPlayer';\nimport RoleSelector from '../RoleSelector/RoleSelector';\nimport RoleContainer from '../RoleContainer/RoleContainer';\nimport SessionStateContext from '../../SessionStateContext';\n\n// import { sendState } from '../AdminPanel/AdminFunctions'\n// import SessionContext from '../../SessionContext';\n\n\n\nfunction useForceUpdate(){\n  const [value, setValue] = useState(0); // integer state\n  return () => setValue(value => value + 1); // update the state to force render\n}\n\n\n\n/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */\nfunction getStreamStates(callObject) {\n  let isCameraMuted,\n    isMicMuted,\n    isSharingScreen = false;\n  if (\n    callObject &&\n    callObject.participants() &&\n    callObject.participants().local\n  ) {\n    const localParticipant = callObject.participants().local;\n    isCameraMuted = !localParticipant.video;\n    isMicMuted = !localParticipant.audio;\n    isSharingScreen = localParticipant.screen;\n  }\n  return [isCameraMuted, isMicMuted, isSharingScreen];\n}\n\n\n\n/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */\nexport default function AdminPanel(props) {\n  const callObject = useContext(CallObjectContext);\n  // const [sessionState, setSessionState ] = useContext(SessionContext);\n  const [isCameraMuted, setCameraMuted] = useState(false);\n  const [isMicMuted, setMicMuted] = useState(false);\n  const [isSharingScreen, setSharingScreen] = useState(false);\n  const [displayChat, setChatDisplay] = useState(false);\n  const [highlightedChat, setChatHighlight] = useState(false);\n  const { session } = useContext(SessionStateContext);\n  const [ sessionState,setSessionState] = session;\n  const setSubs = () => {setSubscriptions(callObject)};  \n  const forceUpdate = useForceUpdate();\n  window.updateAdminPanel=forceUpdate;\n  const [playButtonText, setPlayButtonText] = useState('Play');\n  const [targetRecording, setTargetRecording] = useState('monologue1') ///////HAVE TO CHANGE THIS IN TWO PLACES\n  const training = React.createRef();\n  const trainingToggle = React.createRef();\n\n  useEffect(() => {           //listen for participants leaving or joining and update component\n    if (!callObject) return;\n\n    const events = [\n      'participant-joined',\n      'participant-left',\n      'joined-meeting',\n    ];\n\n    for (const event of events) {\n      callObject.on(event, () => setTimeout(()=>forceUpdate(),100));\n    }\n\n    return function cleanup() {\n      for (const event of events) {\n        callObject.off(event, () => setTimeout(()=>forceUpdate(),100));\n      }\n    };\n\n  }, [callObject]);\n\n\n\nconst sendState = () => {\n    console.log (\"Sending current state...\");\n    callObject.sendAppMessage(window.sessionState, '*'); \n}\n\n  useEffect(()=> {\n    window.sendState = sendState;\n  },[sendState]);\n\n\n  function toggleSessionActive() {\n    setSessionState((prevState)=>({\n      ...prevState,\n      isActive: !prevState.isActive\n      }));\n    window.sessionState.isActive=!window.sessionState.isActive;\n    sendState();\n    if (window.sessionState.isActive && !window.myRole.includes('Shadow') && !window.myRole.includes('Seller') && !window.myRole.includes('Buyer')) \n    {\n      setSubscriptions(callObject,'Shadow1')\n      window.viewMode='Shadow1';\n      callObject.setLocalVideo(false);\n      callObject.setLocalAudio(false);\n    }\n    else {\n      setSubs();\n    }\n    if (!window.sessionState.isActive) {\n      callObject.setLocalVideo(true);\n      callObject.setLocalAudio(true);\n    }\n  }\n\n  function togglePractice() {\n    let recipientA = window.sessionState.roleOf.Shadow1 && window[window.sessionState.roleOf.Shadow1 + '_SessionID'];\n    let recipientB = window.sessionState.roleOf.Shadow2 && window[window.sessionState.roleOf.Shadow2 + '_SessionID'];\n    if(window.sessionState.roleOf.Shadow1==window.myName) {recipientA='me'}\n    if(window.sessionState.roleOf.Shadow2==window.myName) {recipientB='me'}\n\n    if (!recipientA && !recipientB) {console.log('no recipients.'); return}\n\n    const action = window.audioIsPlaying ? 'pause' : 'play';\n    const instructionsA = {\n      type: 'instructions',\n      target: targetRecording,\n      action: action,\n      recipient: recipientA,\n    }\n    const instructionsB = {\n      type: 'instructions',\n      target: targetRecording + 'B',\n      action: action,\n      recipient: recipientB\n    }\n\n    if (recipientA) {\n      if(recipientA!='me') {\n        callObject.sendAppMessage(instructionsA,recipientA);\n      }\n      else if(recipientA=='me') {\n        audioPlayer(targetRecording,action);\n      }\n      console.log(`Sent ${action} request to ${window.sessionState.roleOf.Shadow1}`);\n    }\n    if (recipientB) {\n      if(recipientB!='me') {\n        callObject.sendAppMessage(instructionsB,recipientB);\n      }\n      else if(recipientB=='me') {\n        audioPlayer(targetRecording+'B',action);\n      }\n      console.log(`Sent ${action} request to ${window.sessionState.roleOf.Shadow2}`);\n    }\n      \n    window.audioIsPlaying=(!window.audioIsPlaying);\n    setPlayButtonText(!window.audioIsPlaying ? 'Play' : 'Pause');\n\n\n  }\n\n\n  function toggleTrainingMode () {\n    training.current.classList.toggle('hidden');\n    trainingToggle.current.innerText = training.current.classList.contains('hidden') ? 'Show Practice' : 'X';\n  }\n\n\n\n  \n\n                  \n         \n\n\n  /**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */\n  useEffect(() => {\n    if (!callObject) return;\n\n    function handleNewParticipantsState(event) {\n      event && logDailyEvent(event);\n      const [isCameraMuted, isMicMuted, isSharingScreen] = getStreamStates(\n        callObject\n      );\n      setCameraMuted(isCameraMuted);\n      setMicMuted(isMicMuted);\n      setSharingScreen(isSharingScreen);\n    }\n\n    // Use initial state\n    handleNewParticipantsState();\n\n    // Listen for changes in state\n    callObject.on('participant-updated', handleNewParticipantsState);\n\n    // Stop listening for changes in state\n    return function cleanup() {\n      callObject.off('participant-updated', handleNewParticipantsState);\n    };\n  }, [callObject]);\n\n\n    /* // Play practice audio for users */\n\n    \n\n  return (\n<div>\n  <div className=\"admin-panel\">\n\n    {/* BEGIN ROLE SELECTORS SECTION*/}\n      <div className=\"role-selector-section\">\n\n\n          {/* Buyer selector */}\n          <div className=\"selector-box\">\n            Buyer(s)\n\n              <RoleSelector \n                role=\"Buyer1\"\n                selectedRoles='selectedRoles'\n              />\n              <RoleSelector \n                role=\"Buyer2\"\n                selectedRoles='selectedRoles'\n              />\n              <RoleSelector \n                role=\"Buyer3\"\n                selectedRoles='selectedRoles'\n              />\n          </div>\n          \n          {/* Seller Selector */}\n          <div className=\"selector-box\">\n            Seller\n              <RoleSelector \n                  role=\"Seller\"\n                  selectedRoles='selectedRoles'\n                />\n          </div>\n\n          {/* Shadow selector */}\n          <div className=\"selector-box\">\n            Seller's shadow(s)\n              <RoleSelector \n                  role=\"Shadow1\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow2\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow3\"\n                  selectedRoles='selectedRoles'\n                />\n                <RoleSelector \n                  role=\"Shadow4\"\n                  selectedRoles='selectedRoles'\n                />\n            </div>\n\n          {/* Unassigned (working) */}\n          {/* <div className=\"selector-box\">\n            Unassigned\n            <RoleContainer\n            />\n           </div> */}\n\n\n        </div>\n    {/* END ROLE SELECTORS SECTION */}\n\n\n    \n\n\n\n\n\n    {/* <!-- BEGIN START / STOP TOGGLE --> */}\n        <div className='session-toggle'>\n                        <label class=\"switch\">\n                            <input type=\"checkbox\" id='state' checked={sessionState.isActive} onChange={toggleSessionActive}/>\n                            <span class=\"slider round\"></span>\n                        </label>\n                        <p>Session active</p>\n        </div>\n     {/* <!-- END START / STOP TOGGLE --> */}\n\n\n     \n\n    </div>\n// ***End admin panel***\n\n{/* START TRAINING AUDIO SECTION */}\n\n<div className='practice-audio hidden' ref={training}>\n    Practice audio\n        \n                    {/* Recordings for Seconding */}\n                    <div style={{height:'30px',margin:'auto'}}>\n                    <form action = ''>\n                        <fieldset style={{border:'none'}}>\n                        <select class='practice-audio-dropdown' onChange={(e) => {setTargetRecording (e.target.value); console.log('***CHANGED TO ' + e.target.value)}}\n                        >\n                        <option value = 'monologue1'>What makes CEB different (mono)</option>    \n                        {/* ///IMPORTANT: IF DEFAULT VALUE CHANGES ABOVE, ALSO HAVE TO CHANGE IT IN setTargetRecording HOOK */}\n                        <option value = 'monologue2'>Searching for PAGA Claims (mono)</option>\n                        <option value = 'monologue3'>Audio Engineer (mono)</option>\n                        <option value = 'monologue4'>IBM Garage (mono)</option>\n                        <option value = 'dialogue1'>Ethics (dialogue)</option>\n                        <option value = 'dialogue2'>CoursePass (dialogue)</option>\n                    </select>\n                    </fieldset>\n                    </form>\n                </div> \n                  <span style={{color: 'green', fontSize: '16px', fontFamily:'Verdana, Geneva, Tahoma, sans-serif'}}>\n                      <button onClick={togglePractice} id='play-pause'>{playButtonText}</button>\n                    </span>\n    </div>\n\n    {/* END TRAINING AUDIO SECTION */}\n\n<div className='training-toggle' ref={trainingToggle} onClick={toggleTrainingMode}>Show Practice</div>\n</div>\n    \n  );\n  \n}\n"]},"metadata":{},"sourceType":"module"}