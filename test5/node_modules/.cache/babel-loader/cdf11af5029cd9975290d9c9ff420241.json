{"ast":null,"code":"import _regeneratorRuntime from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import\"../AppLibrary/AppLibrary.css\";import VideoElement from\"../VideoElement/VideoElement\";import $ from'jquery';import{IoDownloadOutline}from\"react-icons/io5\";import{IoIosShareAlt,IoIosTrash}from\"react-icons/io\";import Dialogue from\"../Dialogue/Dialogue\";import axios from'axios';export default function AppLibrary(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),videoArray=_useState2[0],setVideoArray=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showDeleteDialogue=_useState4[0],setShowDeleteDialogue=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),idToDelete=_useState6[0],setIdToDelete=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showShareDialogue=_useState8[0],setShowShareDialogue=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),idToShare=_useState10[0],setIdToShare=_useState10[1];function getVideos(){return _getVideos.apply(this,arguments);}function _getVideos(){_getVideos=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var results;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/.netlify/functions/getFromMux');case 2:results=_context2.sent;results.data.message!='Error'&&setVideoArray(results.data.message);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _getVideos.apply(this,arguments);}useEffect(function(){getVideos();//   $.ajax({\n//     url: \"https://api.mux.com/video/v1/assets\",\n//     beforeSend: function(xhr) { \n//     // xhr.setRequestHeader(\"Authorization\", \"Basic \" + btoa(\"768959a2-7b04-44c2-b584-5800ffc71297:7fB9Fa8rXoCKI3MNDloDusslbS6gwZMoHj6dZldFBNoFEhUTT/pr+c/aI+4S5kImvDtCrBkk14a\")); //testing -- change also below and in Tray.js \n//       xhr.setRequestHeader(\"Authorization\", \"Basic \" + btoa(\"4100efdb-e648-4287-ad0a-50e9875a238b:TyiPEfPzEcz/tl/0sYh5ndPpNIwaom0mQaLRiDQ4E+pX1nH1Xl9XDJWXiPYtgx5QRfi/8ukakFh\"));  //livestorm\n//     },\n//     type: 'GET',\n//     contentType: 'application/json',\n//     success: function (data) {\n//       // alert(JSON.stringify(data));\n//       window.test=data.data;\n//       setVideoArray(data.data);\n//     },\n//     error: function(){\n//       alert(\"Cannot get recordings\");\n//     }\n// });\n},[]);var promptForDelete=function promptForDelete(id){setIdToDelete(id);setShowDeleteDialogue(true);};var promptForShare=function promptForShare(id){setIdToShare(id);setShowShareDialogue(true);};var deleteVideo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post('/.netlify/functions/deleteFromMux',{assetId:idToDelete});case 2:results=_context.sent;window.location.reload();// alert(results.data.message);\n//   const results = await axios.post('/.netlify/functions/uploadToMux',\n//   {\n//     input: downloadLink,\n//   }\n// );\n// results.data.message && setVideoArray(results.data.message);\n//   $.ajax({\n//     url: \"https://api.mux.com/video/v1/assets/\" + idToDelete,\n//     beforeSend: function(xhr) { \n//       // xhr.setRequestHeader(\"Authorization\", \"Basic \" + btoa(\"768959a2-7b04-44c2-b584-5800ffc71297:7fB9Fa8rXoCKI3MNDloDusslbS6gwZMoHj6dZldFBNoFEhUTT/pr+c/aI+4S5kImvDtCrBkk14a\"));  //testing â€” change also above and in Tray.js\n//       xhr.setRequestHeader(\"Authorization\", \"Basic \" + btoa(\"4100efdb-e648-4287-ad0a-50e9875a238b:TyiPEfPzEcz/tl/0sYh5ndPpNIwaom0mQaLRiDQ4E+pX1nH1Xl9XDJWXiPYtgx5QRfi/8ukakFh\"));  //livestorm\n//     },\n//     type: 'DELETE',\n//     contentType: 'application/json',\n//     processData: false,\n//     success: function () {\n//       window.location.reload();\n//     },\n//     error: function(){\n//       alert(\"Error: could not delete file\");\n//     }\n// });\ncase 4:case\"end\":return _context.stop();}}},_callee);}));return function deleteVideo(){return _ref.apply(this,arguments);};}();var copyLink=function copyLink(link){setShowShareDialogue(false);copy(idToShare);};var cancel=function cancel(){setShowDeleteDialogue(false);setShowShareDialogue(false);};function copy(text){var cb=navigator.clipboard;cb.writeText(text);}return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Video library\"),/*#__PURE__*/React.createElement(\"div\",{className:\"gallery\"},videoArray[0]&&videoArray.map(function(item){return item.playback_ids[0].id&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(VideoElement,{src:'https://stream.mux.com/'+item.playback_ids[0].id+'.m3u8'}),/*#__PURE__*/React.createElement(\"p\",null,new Date(parseInt(item.created_at*1000)).toLocaleDateString(\"en-US\",{weekday:'short',year:'numeric',month:'short',day:'numeric'}).toString(),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(IoIosShareAlt,{size:20,title:\"Share\",onClick:function onClick(){promptForShare('https://stream.mux.com/'+item.playback_ids[0].id+'/medium.mp4');},style:{cursor:\"pointer\",marginTop:\"10px\"}}),\"\\xA0 \\xA0 \\xA0\",/*#__PURE__*/React.createElement(IoIosTrash,{size:20,title:\"Delete\",onClick:function onClick(){promptForDelete(item.id);},style:{cursor:\"pointer\"}})));}),/*#__PURE__*/React.createElement(Dialogue,{show:showDeleteDialogue,title:\"Delete video?\",description:\"Are you sure you wish to permanently delete this video?\",confirm:deleteVideo,cancel:cancel,confirmText:\"Yes, delete it\",action:\"delete\"}),/*#__PURE__*/React.createElement(Dialogue,{show:showShareDialogue,title:\"Link for sharing:\",description:idToShare,confirm:copyLink,cancel:cancel,confirmText:\"Copy to clipboard\",action:\"share\"})));}","map":null,"metadata":{},"sourceType":"module"}