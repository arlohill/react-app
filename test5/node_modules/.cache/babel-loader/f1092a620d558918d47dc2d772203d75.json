{"ast":null,"code":"import _objectSpread from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/Users/arlosb/Documents/GitHub/new react app/test5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import CallObjectContext from'../../../CallObjectContext';import{logDailyEvent}from'../../../logUtils';import'./AdminPanel.css';import audioPlayer from'../../../hooks/AudioPlayer';import RoleSelector from'../RoleSelector/RoleSelector';import SessionStateContext from'../../../SessionStateContext';import MyContext from'../../../MyContext';function useForceUpdate(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];// integer state\nreturn function(){return setValue(function(value){return value+1;});};// update the state to force render\n}/**\n * Gets [isCameraMuted, isMicMuted, isSharingScreen].\n * This function is declared outside Tray() so it's not recreated every render\n * (which would require us to declare it as a useEffect dependency).\n */function getStreamStates(callObject){var isCameraMuted,isMicMuted,isSharingScreen=false;if(callObject&&callObject.participants()&&callObject.participants().local){var localParticipant=callObject.participants().local;isCameraMuted=!localParticipant.video;isMicMuted=!localParticipant.audio;isSharingScreen=localParticipant.screen;}return[isCameraMuted,isMicMuted,isSharingScreen];}/**\n * Props:\n * - onClickLeaveCall: () => ()\n * - disabled: boolean\n */export default function AdminPanel(props){var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),sidebar=_useState4[0],setSidebar=_useState4[1];var showSidebar=function showSidebar(){return setSidebar(!sidebar);};var callObject=useContext(CallObjectContext);// const [sessionState, setSessionState ] = useContext(SessionContext);\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isCameraMuted=_useState6[0],setCameraMuted=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isMicMuted=_useState8[0],setMicMuted=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isSharingScreen=_useState10[0],setSharingScreen=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),displayChat=_useState12[0],setChatDisplay=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),highlightedChat=_useState14[0],setChatHighlight=_useState14[1];var _useContext=useContext(SessionStateContext),session=_useContext.session;var _session=_slicedToArray(session,2),sessionState=_session[0],setSessionState=_session[1];var _useContext2=useContext(MyContext),myStateArray=_useContext2.myStateArray,setName=_useContext2.setName,setRole=_useContext2.setRole,setUserList=_useContext2.setUserList,setViewMode=_useContext2.setViewMode,setCamOnAtSessionStart=_useContext2.setCamOnAtSessionStart,setMicOnAtSessionStart=_useContext2.setMicOnAtSessionStart,setAdminPresent=_useContext2.setAdminPresent,setAmAdmin=_useContext2.setAmAdmin;var _myStateArray=_slicedToArray(myStateArray,2),myState=_myStateArray[0],setMyState=_myStateArray[1];var forceUpdate=useForceUpdate();window.updateAdminPanel=forceUpdate;var _useState15=useState('Play'),_useState16=_slicedToArray(_useState15,2),playButtonText=_useState16[0],setPlayButtonText=_useState16[1];var _useState17=useState('monologue1'),_useState18=_slicedToArray(_useState17,2),targetRecording=_useState18[0],setTargetRecording=_useState18[1];///////HAVE TO CHANGE THIS IN TWO PLACES\nvar training=React.createRef();var trainingToggle=React.createRef();useEffect(function(){//listen for participants leaving or joining and update component\nif(!callObject)return;var events=['participant-joined','participant-left','joined-meeting'];for(var _i=0,_events=events;_i<_events.length;_i++){var event=_events[_i];callObject.on(event,function(){return setTimeout(function(){return forceUpdate();},100);});}return function cleanup(){var _iterator=_createForOfIteratorHelper(events),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _event=_step.value;callObject.off(_event,function(){return setTimeout(function(){return forceUpdate();},100);});}}catch(err){_iterator.e(err);}finally{_iterator.f();}};},[callObject]);///update other participants when state changes.\nuseEffect(function(){if(!sessionState.hasAnUpdate){return;}console.log('****HAS AN UPDATE');sendState();setSessionState(function(prev){return _objectSpread(_objectSpread({},prev),{},{hasAnUpdate:false});});},[sessionState.hasAnUpdate]);var sendState=function sendState(){console.log(\"Sending current state...\");callObject.sendAppMessage(sessionState,'*');};function toggleSessionActive(){setSessionState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isActive:!prevState.isActive});});setSessionState(function(prev){return _objectSpread(_objectSpread({},prev),{},{hasAnUpdate:true});});}function togglePractice(){var recipientA=sessionState.roleOf.Shadow1&&myState.userList.sessionIdFor[sessionState.roleOf.Shadow1];var recipientB=sessionState.roleOf.Shadow2&&myState.userList.sessionIdFor[sessionState.roleOf.Shadow2];if(sessionState.roleOf.Shadow1==myState.name){recipientA='me';}if(sessionState.roleOf.Shadow2==myState.name){recipientB='me';}if(!recipientA&&!recipientB){console.log('no recipients.');return;}var action=window.audioIsPlaying?'pause':'play';var instructionsA={type:'instructions',target:targetRecording,action:action,recipient:recipientA};var instructionsB={type:'instructions',target:targetRecording+'B',action:action,recipient:recipientB};if(recipientA){if(recipientA!='me'){callObject.sendAppMessage(instructionsA,recipientA);}else if(recipientA=='me'){audioPlayer(targetRecording,action);}console.log(\"Sent \".concat(action,\" request to \").concat(sessionState.roleOf.Shadow1));}if(recipientB){if(recipientB!='me'){callObject.sendAppMessage(instructionsB,recipientB);}else if(recipientB=='me'){audioPlayer(targetRecording+'B',action);}console.log(\"Sent \".concat(action,\" request to \").concat(sessionState.roleOf.Shadow2));}window.audioIsPlaying=!window.audioIsPlaying;setPlayButtonText(!window.audioIsPlaying?'Play':'Pause');}function toggleTrainingMode(){training.current.classList.toggle('hidden');trainingToggle.current.innerText=training.current.classList.contains('hidden')?'Show Practice':'X';}/**\n   * Start listening for participant changes when callObject is set (i.e. when the component mounts).\n   * This event will capture any changes to your audio/video mute state.\n   */useEffect(function(){if(!callObject)return;function handleNewParticipantsState(event){event&&logDailyEvent(event);var _getStreamStates=getStreamStates(callObject),_getStreamStates2=_slicedToArray(_getStreamStates,3),isCameraMuted=_getStreamStates2[0],isMicMuted=_getStreamStates2[1],isSharingScreen=_getStreamStates2[2];setCameraMuted(isCameraMuted);setMicMuted(isMicMuted);setSharingScreen(isSharingScreen);}// Use initial state\nhandleNewParticipantsState();// Listen for changes in state\ncallObject.on('participant-updated',handleNewParticipantsState);// Stop listening for changes in state\nreturn function cleanup(){callObject.off('participant-updated',handleNewParticipantsState);};},[callObject]);/* // Play practice audio for users */return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:myState.sidebar?\"admin-panel on\":\"admin-panel off\"},/*#__PURE__*/React.createElement(\"div\",{className:\"role-selector-section\"},/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Buyer(s)\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer1\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer2\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer3\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Buyer4\",selectedRoles:\"selectedRoles\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Seller\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Seller\",selectedRoles:\"selectedRoles\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"selector-box\"},\"Seller's shadow(s)\",/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow1\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow2\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow3\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow4\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow5\",selectedRoles:\"selectedRoles\"}),/*#__PURE__*/React.createElement(RoleSelector,{role:\"Shadow6\",selectedRoles:\"selectedRoles\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"session-toggle\"},/*#__PURE__*/React.createElement(\"label\",{class:\"switch\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",id:\"state\",checked:sessionState.isActive,onChange:toggleSessionActive}),/*#__PURE__*/React.createElement(\"span\",{class:\"slider round\"})),/*#__PURE__*/React.createElement(\"p\",null,\"Session active\")),/*#__PURE__*/React.createElement(\"div\",{className:\"practice-audio hidden\",ref:training},\"Practice audio\",/*#__PURE__*/React.createElement(\"div\",{style:{height:'30px',margin:'auto',marginTop:'5px'}},/*#__PURE__*/React.createElement(\"form\",{action:\"\"},/*#__PURE__*/React.createElement(\"fieldset\",{style:{border:'none'}},/*#__PURE__*/React.createElement(\"select\",{class:\"practice-audio-dropdown\",onChange:function onChange(e){setTargetRecording(e.target.value);console.log('***CHANGED TO '+e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"monologue1\"},\"What makes CEB different (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue2\"},\"Searching for PAGA Claims (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue3\"},\"Audio Engineer (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue4\"},\"IBM Garage (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue5\"},\"Livestorm 1 (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue6\"},\"Livestorm 2 (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue7\"},\"Sublet (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue8\"},\"Zombies (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue9\"},\"Excellence (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue10\"},\"Gertens (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"monologue11\"},\"Raymond (mono)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue1\"},\"Ethics (dia)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue2\"},\"CoursePass (dia)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue3\"},\"M&S 2 weeks (dia)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue4\"},\"M&S Doing with your life (dia)\"),/*#__PURE__*/React.createElement(\"option\",{value:\"dialogue5\"},\"L&B (dia)\"))))),/*#__PURE__*/React.createElement(\"span\",{style:{color:'green',fontSize:'16px',fontFamily:'Verdana, Geneva, Tahoma, sans-serif'}},/*#__PURE__*/React.createElement(\"button\",{onClick:togglePractice,id:\"play-pause\"},playButtonText))),/*#__PURE__*/React.createElement(\"div\",{className:\"training-toggle\",ref:trainingToggle,onClick:toggleTrainingMode},\"Show Practice\")))// ***End admin panel***\n;}","map":null,"metadata":{},"sourceType":"module"}